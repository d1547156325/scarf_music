var ting=ting||{};(function(n){var t={},e={},i=window.location.href.replace(/(http:\/\/[^\/\\]+)([\/\\].*)/g,"$1");var a=function(){var n={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};var t=navigator.userAgent,e=/(msie) ([\w.]+)/.exec(t.toLowerCase());if(e&&e[1]&&e[2]&&(!document.documentMode||document.documentMode<8)){n["for"]="htmlFor";n["class"]="className"}else{n.htmlFor="for";n.className="class"}return n}();var o=function(n){if("string"==typeof n||n instanceof String){return document.getElementById(n)}else if(n&&n.nodeName&&(n.nodeType==1||n.nodeType==9)){return n}return null};var s=function(n){return String(n).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1")};var r=function(n,t,e){n=o(n);if("style"==t){n.style.cssText=e}else{t=a[t]||t;n.setAttribute(t,e)}return n};var c=function(n,t){var e;n=o(n);for(e in t){if(t.hasOwnProperty(e)){r(n,e,t[e])}}return n};var l=function(n,t){n=o(n);var e=t.split(/\s+/),i=n.className,a=" "+i+" ",s=0,r=e.length;for(;s<r;s++){if(a.indexOf(" "+e[s]+" ")<0){i+=(i?" ":"")+e[s]}}n.className=i;return n};var u=function(n,t){var e=document.createElement(n),i=t||{};return c(e,i)};var p=function(n,t,e){var i=[],a=function(n){var t=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+$)","g");return String(n).replace(t,"")},r,c,l,u;if(!(n=a(n))){return i}if("undefined"==typeof t){t=document}else{t=o(t);if(!t){return i}}if(e){e=a(e).toUpperCase()}if(t.getElementsByClassName){l=t.getElementsByClassName(n);r=l.length;for(c=0;c<r;c++){u=l[c];if(e&&u.tagName!=e){continue}i[i.length]=u}}else{n=new RegExp("(^|\\s)"+s(n)+"(\\s|$)");l=e?t.getElementsByTagName(e):t.all||t.getElementsByTagName("*");r=l.length;for(c=0;c<r;c++){u=l[c];if(n.test(u.className)){i[i.length]=u}}}return i};var f=function(n,t,e){var i=p(n,t,e);if(i&&i[0]){return i[0]}return null};var d=function(n){return n+"px"};var h={ele:null,mask:null,boxSize:null,init:function(n,t){this.boxSize=t||{width:500,height:300};this.ele=this.getElement(n);this.mask=this.mask||this.createMask()},getElement:function(n){var t=this.boxSize;return{dom:n,show:function(){var n=h.position(t.width,t.height),e=this.dom;e.style.width=d(t.width);e.style.top=d(n.top);e.style.left=d(n.left);e.style.display="block"},hide:function(){this.dom.style.display="none"}}},createMask:function(){var n=document,t=n.body,e=n.documentElement,i=n.compatMode==="BackCompat"?t:n.documentElement,a=n.createElement("div");t.insertBefore(a,t.childNodes[0]);a.style.display="none";a.className="popup-mask";return{layer:a,show:function(){var n=Math.max(e.scrollHeight,t.scrollHeight,i.clientHeight),a=Math.max(e.scrollWidth,t.scrollWidth,i.clientWidth),o=this.layer;o.style.width=d(a);o.style.height=d(n);h.animateShow(o)},hide:function(){this.layer.style.display="none"}}},show:function(){if(this.ele){this.ele.show()}if(this.mask){this.mask.show()}},hide:function(){if(this.ele){this.ele.hide()}if(this.mask){this.mask.hide()}},position:function(n,t){var e=document,i=e.compatMode==="BackCompat"?e.body:e.documentElement,a=(i.clientWidth-n)/2,o=(i.clientHeight-t)/2;a+=window.pageXOffset||e.documentElement.scrollLeft||e.body.scrollLeft;o+=window.pageYOffset||e.documentElement.scrollTop||e.body.scrollTop;o=o<0?5:o;return{top:o,left:a}},animateShow:function A(n){var t=n.className,e=0,i;n.className=t+" account-ts0";n.style.display="block";i=setInterval(function(){e+=1;if(e===4){clearInterval(i)}n.className=t+" account-ts"+e},30)}};var g=function(n){g.prototype.init.call(this,n)};var m=g.prototype;m.init=function(n){var t;if(!n){return}for(t in n){if(n.hasOwnProperty(t)){this[t]=n[t]}}};m.render=function(){var n;if(this.base&&this.base.render){n=this.base.render()}return this.myRender(n)};m.getBoxSize=function(){if(this.boxSize){return this.boxSize}else if(this.base&&this.base.getBoxSize){return this.base.getBoxSize()}return null};m.all=function(n){var t=[],e=this;while(e){if(e[n]){t.push(e[n])}e=e.base}return t};var v=function(n){var t=this;m.init.call(this,n);this.myRender=function(){var n={onFillInUsernameSuccess:function(){var n=ting.passport.lastCallback;n.onClose();if(n.onSuccess){n.onSuccess(ting.userInfo)}},onGetErr:function(n){var t=n+"";switch(t){case"160100":case"160111":case"160110":break}},onReady:function(){var n=ting.passport.lastCallback,t;if(t=o("pass_fillinusername_submit_input")){t.value="确定"}if(n.onReady){n.onReady()}}},t=ting.passport.lastOptions,e=t&&t.container?t.container:"fillinusername_holder"}};v.prototype=new g;var y=function(n){var t=this;m.init.call(this,n);this.myRender=function(n){var t={onRealizeUserSuccess:function(){var n=ting.passport.lastCallback;n.onClose();if(n.onSuccess){n.onSuccess(ting.userInfo)}},onGetErr:function(n){var t=n+"";switch(t){case"160100":case"160111":case"160110":break}},onReady:function(){var n=ting.passport.lastCallback,t;if(t=o("pass_fillinusername_submit_input")){t.value="确定"}if(n.onReady){n.onReady()}}},e=ting.passport.lastOptions,i=e&&e.container?e.container:"fillinusername_holder"}};y.prototype=new g;var b=function(n){m.init.call(this,n);this.myRender=function(n){return n}};b.prototype=new g;var w=function(n){m.init.call(this,n);this.myRender=function(n){var t=f("account-popup-holder")||u("div",{className:"account-popup-holder"}),e;l(t,"account-popup-holder-no-user");t.innerHTML=['<div class="account-ptitle">','    <span class="account-ptitle-text"></span>','    <a class="account-pclose" href="#" title="关闭窗口"></a>',"</div>",'<div class="account-pbody"></div>'].join("");e=f("account-pclose",t);e.onclick=function(){var n=ting.passport.lastCallback;n.onClose();if(n.onAbstractCancel){n.onAbstractCancel()}return false};return t}};w.prototype=new g;var S=function(n){m.init.call(this,n);this.boxSize={width:380,height:340};this.myRender=function(n){var t=n,e=f("account-pbody",t),i=f("account-ptitle-text",t);l(e,"account-pbody-no-u");i.innerHTML="未绑定真实信息";e.innerHTML=['<div class="action-holder no-u-holder">','   <div class="action-title-holder no-u-title-holder">','        <span class="account-t2 no-u-t2"></span>','        <span class="action-title-tip no-u-title-tip">您还未绑定邮箱或手机号，为了保障您的账户安全，建议您立即进行<a class="account-link" href="http://passport.baidu.com/v2/accountsecurity?u='+encodeURIComponent("http://music.qianqian.com")+'" target="_blank" title="安全设置">安全设置</a></span>',"    </div>","</div>"].join("");ting.passport.lastCallback.onAbstractCancel=function(){var n=ting.passport.lastCallback;if(n.onRealizeUserCancel){n.onRealizeUserCancel()}if(n.onCancel){n.onCancel()}};var a=f("account-link",t);a.onclick=function(){var n=ting.passport.lastCallback;n.onClose();if(n.onAbstractCancel){n.onAbstractCancel()}};return t}};S.prototype=new g;var k=function(n){var t=this;m.init.call(this,n);this.myRender=function(n){var t={onRealizeUserSuccess:function(){var n=ting.passport.lastCallback;n.onClose();if(n.onSuccess){n.onSuccess(ting.userInfo)}},onGetErr:function(n){var t=n+"";switch(t){case"160100":case"160111":case"160110":break}},onReady:function(){var n=ting.passport.lastCallback,t;if(t=o("pass_fillinusername_submit_input")){t.value="确定"}if(n.onReady){n.onReady()}}},e=ting.passport.lastOptions,i=e&&e.container?e.container:"fillinusername_holder"}};k.prototype=new g;var C=function(n){m.init.call(this,n);this.boxSize={width:380,height:340};this.myRender=function(n){var t=n,e=f("account-pbody",t),i=f("account-ptitle-text",t);l(e,"account-pbody-no-u");i.innerHTML="补全个人信息";e.innerHTML=['<div class="action-holder no-u-holder">','   <div class="action-title-holder no-u-title-holder">','        <span class="account-t2 no-u-t2"></span>','        <span class="action-title-tip no-u-title-tip">您正在使用第三方账号登陆，为了更好的使用VIP付费服务，请先到<a class="account-link" href="http://passport.baidu.com/v2/?binding&showtype=email&u='+encodeURIComponent("http://music.qianqian.com")+'" target="_blank" title="用户中心">用户中心</a>补全个人信息吧。</span>',"    </div>","</div>"].join("");ting.passport.lastCallback.onAbstractCancel=function(){var n=ting.passport.lastCallback;if(n.onRealizeUserCancel){n.onRealizeUserCancel()}if(n.onCancel){n.onCancel()}};var a=f("account-link",t);a.onclick=function(){var n=ting.passport.lastCallback;n.onClose();if(n.onAbstractCancel){n.onAbstractCancel()}};return t}};C.prototype=new g;var R=function(n){m.init.call(this,n);this.boxSize={width:380,height:340};this.myRender=function(n){var t=n,e=f("account-pbody",t),i=f("account-ptitle-text",t);l(e,"account-pbody-no-u");i.innerHTML="补填用户名";e.innerHTML=['<div class="action-holder no-u-holder">','   <div class="action-title-holder no-u-title-holder">','        <span class="account-t2 no-u-t2"></span>','        <span class="action-title-tip no-u-title-tip">欢迎来到百度，您还没有用户名哦，快<a class="account-link" href="http://passport.baidu.com/v2/?ucenteradduname&u='+encodeURIComponent("http://music.qianqian.com")+'" target="_blank" title="补填用户名">点击这里</a>起一个吧！</span>',"    </div>","</div>"].join("");ting.passport.lastCallback.onAbstractCancel=function(){var n=ting.passport.lastCallback;if(n.onFillinUserNameCancel){n.onFillinUserNameCancel()}if(n.onCancel){n.onCancel()}};var a=f("account-link",t);a.onclick=function(){var n=ting.passport.lastCallback;n.onClose();if(n.onAbstractCancel){n.onAbstractCancel()}};return t}};R.prototype=new g;var x={fillinUserName:{normal:[R]},realizeUser:{normal:[C]},bindRealInfo:{normal:[S]}};var N=function(n,t){var e=n.pop();while(e){e.apply(null,t);e=n.pop()}};e.escapeReg=function(n){return String(n).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1")};e.isString=function(n){return typeof n==="object"&&n&&n.constructor===String||typeof n==="string"};e.parseQuery=function(n,t){if(t){var i=new RegExp("(^|&|\\?|#)"+e.escapeReg(t)+"=([^&]*)(&|$)",""),a=n.match(i);if(a){return a[2]}}else{if(n){n=n.substr(n.indexOf("?")+1,n.length);var o=n.split("&");var s={},r=[],c,l,u,p;for(p=0;p<o.length;p++){c=o[p].split("=");l=c[0];u=c[1];if(l===""){continue}if(typeof s[l]==="undefined"){s[l]=u}else{if(e.isString(s[l])){continue}else{s[l].push(u)}}}return s}}return null};e.sioGet=function(n,t){var i,a,o,s,r;if(!n||!e.isString(n)){return null}i=e.parseQuery(n,"callback");a=document.createElement("SCRIPT");if(!i){o=false;a.onreadystatechange=a.onload=function(){if(o){return false}if(typeof a.readyState==="undefined"||a.readyState==="loaded"||a.readyState==="complete"){o=true;try{t()}finally{if(a&&a.parentNode){a.parentNode.removeChild(a)}a.onreadystatechange=null;a.onload=null;a=null}}}}else{s="CB"+Math.floor(Math.random()*2147483648).toString(36);n=n.replace(/(&|\?)callback=([^&]*)/,"$1callback="+s);window[s]=function(){try{var n=t||window[i];n.apply(null,arguments)}finally{if(a&&a.parentNode){a.parentNode.removeChild(a)}a=null;window[s]=null}}}a.src=n;a.type="text/javascript";a.charset="gb2312";r=document.getElementsByTagName("HEAD")[0];r.insertBefore(a,r.firstChild)};e.refreshUserBar=function(){if(ting.refreshUserBar){ting.refreshUserBar()}};e.setLoginedCookie=function(){try{if(window.jQuery){jQuery.cookie("u_lo","1",{path:"/",expires:30});jQuery.cookie("u_id",ting.userInfo.userId,{path:"/",expires:30});jQuery.cookie("u_t",ting.userInfo.userType,{path:"/",expires:30})}}catch(n){}};t.render=function(n,t,e,i,a){var o={fillinUserName:v,realizeUser:y,bindRealInfo:k},s=o[n],r=new s({base:a||new b});r.render()};t.popupLogin=function(n,t,e){var a=this,o;o=function(n){var t=ting.passport.lastCallback;ting.userInfo=n;if(t.onSuccess){t.onSuccess(n)}};if(!this.loginInstance){$.getScript("http://passport.baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+(new Date).getTime(),function(){a.loginInstance=passport.pop.init({tangram:true,cache:true,apiOpt:{product:"music",staticPage:i+"/static/html/pass_jump_v3.html",memberPass:true,u:window.location.href},forgetLink:"https://passport.baidu.com/?getpass_index",registerLink:"https://passport.baidu.com/v2/?reg&regType=1",authsite:["tsina","qzone","renren","weixin"],img:"../../../../static2.qianqian.com/web/static/i/7mqo8tiZ.jpg"/*tpa=http://static2.qianqian.com/web/static/i/7mqo8tiZ.jpg*/,onLoginSuccess:function(n){n.returnValue=false;$(document).trigger("logined");if(e.pos==="userbar"){$(document).trigger("userbarlogined")}a.loginInstance.hide();o();a.loginInstance.destroy()},onShow:function(){},onHide:function(){var n=ting.passport.lastCallback;if(n&&n.onCancel){n.onCancel.call()}}});a.loginInstance.show()})}else{a.loginInstance.show()}};t.popup=function(n,t,e){t=t||{};t.onClose=function(){h.hide()};ting.passport.lastCallback=t;ting.passport.lastOptions=e;if(n=="login"){this.popupLogin(n,t,e);return}var i=this,a=new w,o=x[n],s=o.normal,r=ting.passport.lastDom||null,c,l,u,p,f,d;for(p=0;p<s.length;p++){a=new s[p]({base:a})}if(r){document.body.removeChild(r)}c=a.render();u=a.getBoxSize();stack=a.all("onReady");l=function(n){m.init.call(this,n);this.myRender=function(){return c};this.onReady=function(n){var t=[],e,i;for(e=0,i=stack.length;e<i;e+=1){t[e]=stack[e]}N(t,arguments)}};l.prototype=new g;d=function(){document.body.insertBefore(c,document.body.childNodes[0]);ting.passport.lastDom=c;h.init(c,u);h.show();ting.passport.render(n,null,t,e,new l)};d()};t.checkLogin=function(n,t){var i=ting.userInfo,a,o,s;if(arguments.length<=2){o=n;s=t||{}}else{o={onSuccess:arguments[0],onFailure:arguments[1],onCancel:arguments[2],onPassportSuccess:arguments[3]};s=arguments[4]||{}}a=o.onSuccess;o.onSuccess=function(n){n=n||{};n.login=true;n.active=true;ting.userInfo=n;e.refreshUserBar();e.setLoginedCookie();if(!!s&&s.needBdName&&(!ting.userInfo||!ting.userInfo.bdName)){o.onSuccess=a;ting.passport.checkBdName(o,s)}else{if(a){a(n)}}};if(i===null||i===undefined){$.ajax({url:"/data/user/info",dataType:"jsonp",success:function(n){if(n.errorCode==22452){ting.passport.login()}else{ting.userInfo=n.data;if(o.onSuccess){o.onSuccess(ting.userInfo)}}}})}else{if(o.onSuccess){o.onSuccess(i)}}};var I=window.location.href.replace(/(http:\/\/[^\/\\]+)([\/\\].*)/g,"$1")+"/static/html/tpassjump.html";var T={tpl:"baidu_music",staticPage:window.location.protocol+"//"+window.location.host+"/static/html/tpassjump.html"};var U=location.protocol+"//static0.qianqian.com/pc-tpass/prd/scripts/jsdk/tpass-3.0.0.js?cdnversion="+ +new Date;t.login=function(n){if(!this.tpass&&TPASS){TPASS.config(T)}var t;t=this;if(t._popup){return t._popup.show()}else{TPASS.login({tpl:"baidu_music",target:"pop",u:location.protocol+"//"+window.location.host},function(t){var e;if(n&&n.onSuccess){t.returnValue=false;if(typeof(e=n.onSuccess).call==="function"){e.call(null)}ting.updateUserbar()}else{window.location.reload()}})}};t.regist=function(){if(!this.tpass&&TPASS){TPASS.config(T)}var n=window.location.href;var t={tpl:"baidu_music",u:n,target:"_blank"};TPASS.regist(t)},t.logout=function(n){n=n||{};if(!this.tpass&&TPASS){TPASS.config(T)}TPASS.logout();(function(){var t=0;window.checkUserLogout=function(e){if(e&&!e.loginStatus){if(ting&&ting.userInfo){ting.userInfo=null}window.location.reload();window.checkUserLogout=null}else{setTimeout(function(){if(t++>50){if(_.isFunction(n.error)){n.error()}}else{$.getScript("/passport/check?tpl=music&callback=checkUserLogoutr="+Math.random())}},50)}};window.checkUserLogout()})()};t.checkBdName=function(n,t){$.ajax({url:"/data/user/info",dataType:"jsonp",success:function(i){var a=i.data,o=n,s=t,r;r=o.onSuccess;o.onSuccess=function(n){if(n){n=n||{};ting.userInfo=n}e.refreshUserBar();if(r){r(n)}};if(a&&a.bdName&&a.bdName.length>0){o.onSuccess(a)}else{ting.passport.popup("fillinUserName",o,s)}}})};n.passport=t})(ting);

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/