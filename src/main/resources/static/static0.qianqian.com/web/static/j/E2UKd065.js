define(["core/utils","tmpl/songlist/collectToTmpl"],function(t,e){var i=$(".songlist-info-desc-text"),n=$(".song-list-hook");newSongList=false;loadSonglistTmpl=function(i,s,o){ting.passport.checkLogin(function(){t.tingApi("baidu.ting.ugcdiy.userList",{size:200,source:0,type:10,offset:0}).done(function(t){closeSonglist();if(o){o.append(e(t.result))}else{$(".fun-icon").eq(i).append(e(t.result))}$(".songlist-collect-to").attr({"data-songIndex":i,songid:s});n.on("click",".cerate-songlist-btn",function(){var t=$(this);if(!ting.userInfo){ting.passport.checkLogin(function(t){window.location.reload()})}else{t.hide();$(".create-newList-btn").show();$(".create-newList-name").show().focus();if(ting&&ting.logger){ting.logger.log("click",{page:"home",pos:"createsonglist"})}return false}})}).fail(function(){})})};$("body").click(function(t){var e=t.target.className;if(e.indexOf("songlist-title-tip")>-1||e.indexOf("icon-collects")>-1||e.indexOf("create-newList-btn")>-1||e.indexOf("cerate-songlist-btn")>-1||e.indexOf("create-newList-name")>-1){return false}closeSonglist()});closeSonglist=function(){$(".songlist-collect-to").remove()};createNewSonglist=function(){var e=$(".songlist-collect-to").attr("data-songindex"),i=$(".song-list-hook li").eq(e),n=i.find(".icon-collects"),s=$(".create-newList-name").val(),o=$(".songlist-collect-to").attr("songid");if(!s||$.trim(s)==""){$(".songlist-title-tip").show().html("歌单名不能为空");$(".create-newList-name").addClass("red-border");return false}if(s.length>30){$(".songlist-title-tip").show().html("歌单名长度需在30以内");$(".create-newList-name").addClass("red-border");return false}if(!o){$(".songlist-title-tip").show().html("添加的歌曲存在");$(".create-newList-name").addClass("red-border");return false}$(".create-newList-name").removeClass("red-border");var l={title:s||"",song_ids:o||""};t.tingApi("baidu.ting.ugcdiy.addSongListOnce",l).done(function(t){if(t.error_code==22e3){opt={msg:"新建歌单已保存",iconClass:"tip-success"};n.tip().tip("tipup",opt);closeSonglist()}}).fail(function(t){if(t.error_code==22231){$(".songlist-title-tip").show().html("歌单名含有 '"+t.filter_word+"' 等不合法，请重新输入")}else{opt={msg:"新建歌单保存失败",iconClass:"tip-error"};n.tip().tip("tipup",opt);closeSonglist()}})};n.on("click",".create-newList-btn",createNewSonglist);n.on("keyup",".create-newList-name",function(t){var e=$(".create-newList-name").val();if(t.keyCode==13){createNewSonglist();return false}if(e.length>30){$(".songlist-title-tip").show().html("歌单名长度需在30以内");$(".create-newList-name").addClass("red-border");return false}$(".create-newList-name").removeClass("red-border");$(".songlist-title-tip").hide()});n.on("click",".mylist-mysonglist",function(){var e=$(this);var i=$(".songlist-collect-to").attr("data-songindex");var n=$(".song-list-hook li").eq(i);var s=n.find(".icon-collects");var o=n.find(".music-icon-hook").data("musicicon");var l=e.data("listid");var a={list_id:l,song_ids:o.id};t.tingApi("baidu.ting.ugcdiy.addSongToDiy",a).done(function(t){s.tip().tip("tipup",{msg:"成功添加到歌单",iconClass:"tip-success"})}).fail(function(t){var e="";switch(Number(t.error_code)){case 22001:case 22005:e="操作失败,请重试！";break;case 22452:e="请先登录";break;case 22682:e="歌单歌曲数量超出限制";break;default:e="操作失败,请重试！";break}s.tip().tip("tipup",{msg:e,iconClass:"tip-error"})})});return{createSonglists:function(t,e,i){loadSonglistTmpl(t,e,i)}}});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/