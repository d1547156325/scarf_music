(function(e,t){if(typeof e._mu==="undefined"){e._mu={}}if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/cfg",t)}else{return e._mu.cfg=t()}})(this,function(){var e;e=this;return $.extend({namespace:e._mu,version:"1.0.0",timerResolution:25,engine:{TYPES:{FLASH_MP3:"FlashMP3Core",FLASH_MP4:"FlashMP4Core",AUDIO:"AudioCore"},EVENTS:{STATECHANGE:"engine:statechange",POSITIONCHANGE:"engine:postionchange",PROGRESS:"engine:progress",ERROR:"engine:error",INIT:"engine:init",INIT_FAIL:"engine:init_fail",WAITING_TIMEOUT:"engine:waiting_timeout"},STATES:{CANPLAYTHROUGH:"canplaythrough",PREBUFFER:"waiting",BUFFERING:"loadeddata",PLAYING:"playing",PAUSE:"pause",STOP:"suspend",END:"ended"},ERRCODE:{MEDIA_ERR_ABORTED:"1",MEDIA_ERR_NETWORK:"2",MEDIA_ERR_DECODE:"3",MEDIA_ERR_SRC_NOT_SUPPORTED:"4"}}},typeof e._mu==="undefined"?{}:e._mu.cfg)});(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/bmCfg",["muplayer/core/cfg"],t)}else{return e._mu.bmCfg=t(_mu.cfg)}})(this,function(e){return $.extend(e,{apiHost:"//musicapi.taihe.com/v1/restserver/ting?method={{method}}&format=jsonp&callback=?",apiCode:{SUCCESS:22e3,FAILED:22001},ad:{listenType:{artist:1,album:2,playlist:3,toplist:4,topic:5,scene:6,fm:7,templist:8,first:9},STATES:{ENABLE:"enable",DISABLE:"disable"},EVENTS:{CHECK:"ad:check",MATERIAL:"ad:material",EFFECTIVE_PLAY:"ad:effective-play"}}})});(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/utils",["muplayer/core/cfg"],t)}else{return e._mu.utils=t(e._mu.cfg)}})(this,function(e){var t,r,n,i,o,s,u,a,f,l,p,c,h,y,g,d,m;m={};i=String.prototype;r=Number.prototype;n=Object.prototype;t=Array.prototype;h=t.push;g=t.slice;d=n.toString;a=n.hasOwnProperty;c=Object.create;u=/\.(\w+)(\?.*)?$/;y=["Arguments","Function","String","Number","Date","RegExp"];for(f=0,l=y.length;f<l;f++){p=y[f];m["is"+p]=function(e){return function(t){return d.call(t)==="[object "+e+"]"}}(p)}if(!$.isFunction(i.startsWith)){i.startsWith=function(e){return this.slice(0,e.length)===e}}if(!$.isFunction(i.endsWith)){i.endsWith=function(e){return this.slice(-e.length)===e}}r.toFixed=function(e){var t,r,n;n=Math.pow(10,e);t=(Math.round(this*n)/n).toString();if(e===0){return t}if(t.indexOf(".")<0){t+="."}r=e+1-(t.length-t.indexOf("."));while(r--){t+="0"}return t};o=function(e){var t;if(!$.isPlainObject(e)){return{}}if(c){return c(e)}Ctor.prototype=e;t=new Ctor;Ctor.prototype=null;return t};s=function(e,t,r,n,i){var s,u;if(!(n instanceof t)){return e.apply(r,i)}u=o(e.prototype);s=e.apply(u,i);if($.isPlainObject(s)){return s}return u};$.extend(m,{isBoolean:function(e){return e===true||e===false||d.call(e)==="[object Boolean]"},has:function(e,t){return a.call(e,t)},random:function(e,t){if(!t){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))},shuffle:function(e){var t,r,n,i,o,s;t=0;s=[];for(n=0,i=e.length;n<i;n++){r=e[n];o=this.random(t++);s[t-1]=s[o];s[o]=r}return s},time2str:function(e){var t,r,n,i,o,s;o=[];t=Math.floor;e=Math.round(e);r=t(e/3600);n=t((e-3600*r)/60);s=e%60;i=function(e,t){var r,n,i;n="";r="";if(e<0){r="-"}i=String(Math.abs(e));if(i.length<t){n=new Array(t-i.length+1).join("0")}return r+n+i};if(r){o.push(r)}o.push(i(n,2));o.push(i(s,2));return o.join(":")},namespace:function(){var t,r,n,i,o,s,u,a,f,l;t=arguments;f=".";for(o=0,u=t.length;o<u;o++){r=t[o];a=e.namespace;if(r.indexOf(f)>-1){n=r.split(f);l=[0,n.length],i=l[0],s=l[1];while(i<s){a[n[i]]=a[n[i]]||{};a=a[n[i]];i++}}else{a[r]=a[r]||{};a=a[r]}}return a},partial:function(e){var t,r;r=g.call(arguments,1);t=function(){var n,i,o,u;u=0;o=r.length;n=Array(o);i=0;while(i<o){n[i]=r[i]===m?arguments[u++]:r[i];i++}while(u<arguments.length){n.push(arguments[u++])}return s(e,t,this,this,n)};return t},wrap:function(e,t){return m.partial(t,e)},toAbsoluteUrl:function(e){var t;t=document.createElement("div");t.innerHTML="<a></a>";t.firstChild.href=e;t.innerHTML=t.innerHTML;return t.firstChild.href},getExt:function(e){var t;t="";if(u.test(decodeURIComponent(e))){t=RegExp.$1.toLocaleLowerCase()}return t}});return m});(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/bmUtils",["muplayer/core/utils","muplayer/core/bmCfg"],t)}else{return e._mu.bmUtils=t(_mu.utils,_mu.bmCfg)}})(this,function(e,t){var r;r=t.apiCode;return $.extend(e,{api:function(e,n,i){var o,s,u,a,f;o=$.Deferred();s={type:"GET",dataType:"json",handleError:function(){}};if($.isPlainObject(e)){i=n;n=e.data;e=e.url}a=$.extend(s,i);if(n==null){n={}}u=function(e){return(a.apiHost||t.apiHost).replace("{{method}}",e)};e=u(e);f=e+"?"+$.param(n);$.ajax({url:e,data:n,dataType:a.dataType,type:a.type,success:function(e,t,n){var i,s;i=e.error_code;if(i===r.SUCCESS){return o.resolve(e)}else{s={xhr:n,requestUrl:f,code:i};o.reject(s);return a.handleError(s)}},error:function(e){var t;t={xhr:e,requestUrl:f};o.reject(t);return a.handleError(t)}});return o.promise()},clone:function(e){if(!$.isPlainObject(e)){e}if($.isArray(e)){return e.slice()}else{return $.extend({},e)}},object:function(e,t){var r,n,i,o,s;if(!e){return{}}s={};for(r=i=0,o=e.length;i<o;r=++i){n=e[r];if(t){s[n]=t[r]}else{s[n[0]]=n[1]}}return s},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},getQueryParams:function(e){var t,r,n,i;if(e==null){e=location.search||""}r={};t=decodeURIComponent;e=e.split("+").join(" ");n=/[?&]?([^=]+)=([^&]*)/g;while(i=n.exec(e)){r[t(i[1])]=t(i[2])}return r},getCookie:function(e){var t;t="(?:; )?"+encodeURIComponent(e)+"=([^;]*);?";t=new RegExp(t);if(t.test(document.cookie)){return decodeURIComponent(RegExp.$1)}return""}})});(function(e,t){if(typeof exports==="object"){module.exports=t()}else if(typeof define==="function"&&define.amd){define("muplayer/lib/Timer",t)}else{e._mu.Timer=t()}})(this,function(){function e(e){if(typeof e==="string"){if(isNaN(parseInt(e,10))){e="1"+e}var t=e.replace(/[^a-z0-9\.]/g,"").match(/(?:(\d+(?:\.\d+)?)(?:days?|d))?(?:(\d+(?:\.\d+)?)(?:hours?|hrs?|h))?(?:(\d+(?:\.\d+)?)(?:minutes?|mins?|m\b))?(?:(\d+(?:\.\d+)?)(?:seconds?|secs?|s))?(?:(\d+(?:\.\d+)?)(?:milliseconds?|ms))?/);if(t[0]){return parseFloat(t[1]||0)*864e5+parseFloat(t[2]||0)*36e5+parseFloat(t[3]||0)*6e4+parseFloat(t[4]||0)*1e3+parseInt(t[5]||0,10)}if(!isNaN(parseInt(e,10))){return parseInt(e,10)}}if(typeof e==="number"){return e}return 0}function t(e,t){return parseInt(e/t,10)||1}function r(t){if(this instanceof r===false){return new r(t)}this._notifications=[];this._resolution=e(t)||1e3;this._running=false;this._ticks=0;this._timer=null;this._drift=0}r.prototype={start:function(){var e=this;if(!this._running){this._running=!this._running;setTimeout(function t(){e._ticks++;for(var r=0,n=e._notifications.length;r<n;r++){if(e._notifications[r]&&e._ticks%e._notifications[r].ticks===0){e._notifications[r].callback.call(e._notifications[r],{ticks:e._ticks,resolution:e._resolution})}}if(e._running){clearTimeout(e._timer);e._timer=setTimeout(t,e._resolution+e._drift);e._drift=0}},this._resolution)}return this},stop:function(){if(this._running){this._running=!this._running;clearTimeout(this._timer)}return this},reset:function(){this.stop();this._ticks=0;return this},clear:function(){this.reset();this._notifications=[];return this},ticks:function(){return this._ticks},resolution:function(){return this._resolution},running:function(){return this._running},bind:function(r,n){if(r&&n){var i=t(e(r),this._resolution);this._notifications.push({ticks:i,callback:n})}return this},unbind:function(e){if(!e){this._notifications=[]}else{for(var t=0,r=this._notifications.length;t<r;t++){if(this._notifications[t]&&this._notifications[t].callback===e){this._notifications.splice(t,1)}}}return this},drift:function(e){this._drift=e;return this}};r.prototype.every=r.prototype.bind;r.prototype.after=function(e,t){var n=this;r.prototype.bind.call(n,e,function i(){r.prototype.unbind.call(n,i);t.apply(this,arguments)});return this};return r});(function(e,t){if(typeof exports==="object"){module.exports=t()}else if(typeof define==="function"&&define.amd){define("muplayer/lib/events",t)}else{e._mu.Events=t()}})(this,function(){var e=/\s+/;function t(){}t.prototype.on=function(t,r,n){var i,o,s;if(!r)return this;i=this.__events||(this.__events={});t=t.split(e);while(o=t.shift()){s=i[o]||(i[o]=[]);s.push(r,n)}return this};t.prototype.once=function(e,t,r){var n=this;var i=function(){n.off(e,i);t.apply(this,arguments)};this.on(e,i,r)};t.prototype.off=function(t,n,i){var o,s,u,a;if(!(o=this.__events))return this;if(!(t||n||i)){delete this.__events;return this}t=t?t.split(e):r(o);while(s=t.shift()){u=o[s];if(!u)continue;if(!(n||i)){delete o[s];continue}for(a=u.length-2;a>=0;a-=2){if(!(n&&""+u[a]!==""+n||i&&u[a+1]!==i)){u.splice(a,2)}}}return this};t.prototype.trigger=function(t){var r,i,o,s,u,a,f=[],l,p=true;if(!(r=this.__events))return this;t=t.split(e);for(u=1,a=arguments.length;u<a;u++){f[u-1]=arguments[u]}while(i=t.shift()){if(o=r.all)o=o.slice();if(s=r[i])s=s.slice();p=n(s,f,this)&&p;p=n(o,[i].concat(f),this)&&p}return p};t.prototype.emit=t.prototype.trigger;t.mixTo=function(e){e=i(e)?e.prototype:e;var r=t.prototype;for(var n in r){if(r.hasOwnProperty(n)){e[n]=r[n]}}};var r=Object.keys;if(!r){r=function(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r)}}return t}}function n(e,t,r){if(e){var n=0,i=e.length,o=t[0],s=t[1],u=t[2],a=true;switch(t.length){case 0:for(;n<i;n+=2){a=e[n].call(e[n+1]||r)!==false&&a}break;case 1:for(;n<i;n+=2){a=e[n].call(e[n+1]||r,o)!==false&&a}break;case 2:for(;n<i;n+=2){a=e[n].call(e[n+1]||r,o,s)!==false&&a}break;case 3:for(;n<i;n+=2){a=e[n].call(e[n+1]||r,o,s,u)!==false&&a}break;default:for(;n<i;n+=2){a=e[n].apply(e[n+1]||r,t)!==false&&a}break}}return a}function i(e){return Object.prototype.toString.call(e)==="[object Function]"}return t});var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++){if(t in this&&this[t]===e)return t}return-1};(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/playlist",["muplayer/core/utils","muplayer/lib/events"],t)}else{return e._mu.Playlist=t(_mu.utils,_mu.Events)}})(this,function(e,t){var r;r=function(){function t(e){this.opts=$.extend({},this.defaults,e);this.reset()}t.prototype.reset=function(){this.cur="";if($.isArray(this.list)){this.list.length=0}else{this.list=[]}return this};t.prototype.destroy=function(){return this.reset().off()};t.prototype._resetListRandom=function(t){var r,n,i;if(this.mode==="list-random"){t=t||0;this._listRandomIndex=t;this._listRandom=e.shuffle(function(){i=[];for(var e=0,t=this.list.length;0<=t?e<t:e>t;0<=t?e++:e--){i.push(e)}return i}.apply(this));this.cur=this.list[this._listRandom[t]];return this.trigger("playlist:resetListRandom")}};t.prototype._formatSid=function(t){var r,n,i;r=this.opts.absoluteUrl;n=function(t){return r&&e.toAbsoluteUrl(t)||""+t};return $.isArray(t)&&function(){var e,r,o;o=[];for(e=0,r=t.length;e<r;e++){i=t[e];if(i){o.push(n(i))}}return o}()||n(t)};t.prototype.setMode=function(e){if(e==="single"||e==="random"||e==="list-random"||e==="list"||e==="loop"){this.mode=e}return this._resetListRandom()};t.prototype.add=function(e,t){if(t==null){t=true}e=this._formatSid(e);this.remove(e);if($.isArray(e)){if(e.length){this.list=t&&e.concat(this.list)||this.list.concat(e)}}else if(e){this.list[t&&"unshift"||"push"](e)}this.trigger("playlist:add",e);return this._resetListRandom()};t.prototype.remove=function(e){var t,r,n,i;i=function(e){return function(t){var r;r=$.inArray(t,e.list);if(r!==-1){return e.list.splice(r,1)}}}(this);e=this._formatSid(e);if($.isArray(e)){for(r=0,n=e.length;r<n;r++){t=e[r];i(t)}}else{i(e)}this.trigger("playlist:remove",e);return this._resetListRandom()};t.prototype.prev=function(){var t,r,n,i;n=this.list;t=$.inArray(this.cur,n);if(t===-1){t=0}r=n.length;i=t-1;switch(this.mode){case"single":i=t;break;case"random":i=e.random(0,r-1);break;case"list":if(t=0){this.cur="";return false}break;case"list-random":t=this._listRandomIndex--;i=t-1;if(t===0){i=r-1;this._resetListRandom(i)}return this.cur=n[this._listRandom[i]];case"loop":if(t===0){i=r-1}}return this.cur=n[i]};t.prototype.next=function(){var t,r,n,i;n=this.list;t=$.inArray(this.cur,n);if(t===-1){t=0}r=n.length;i=t+1;switch(this.mode){case"single":i=t;break;case"random":i=e.random(0,r-1);break;case"list":if(t===r-1){this.cur="";return false}break;case"list-random":t=this._listRandomIndex++;i=t+1;if(t===r-1){i=0;this._resetListRandom(i)}return this.cur=n[this._listRandom[i]];case"loop":if(t===r-1){i=0}}return this.cur=n[i]};t.prototype.setCur=function(e){e=this._formatSid(e);if(indexOf.call(this.list,e)<0){this.add(e)}return this.cur=e};return t}();t.mixTo(r);return r});var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++){if(t in this&&this[t]===e)return t}return-1};(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/engineCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/events"],t)}else{return e._mu.EngineCore=t(_mu.cfg,_mu.utils,_mu.Events)}})(this,function(e,t,r){var n,i,o,s,u,a,f;a=e.engine,n=a.EVENTS,o=a.STATES;s=function(){var e;e=[];for(u in o){f=o[u];e.push(f)}return e}();i=function(){function e(){}e.prototype._supportedTypes=[];e.prototype.getSupportedTypes=function(){return this._supportedTypes};e.prototype.canPlayType=function(e){if(e==="mp4a"){e="m4a"}return $.inArray(e,this.getSupportedTypes())!==-1};e.prototype.reset=function(){this.stop();this._url="";this._canPlayThrough=false;this.trigger(n.PROGRESS,0);this.trigger(n.POSITIONCHANGE,0);return this};e.prototype.destroy=function(){return this.reset().off()};e.prototype.play=function(){return this};e.prototype.pause=function(){return this};e.prototype.stop=function(){return this};e.prototype.setUrl=function(e){if(e){this._url=e}return this};e.prototype.getUrl=function(){return this._url};e.prototype.setState=function(e){var t;if(!this.getUrl()){e=o.STOP}if(indexOf.call(s,e)<0||e===this._state){return}if(this._canPlayThrough&&(e===o.PREBUFFER||e===o.BUFFERING)){return}t=this._state;this._state=e;return this.trigger(n.STATECHANGE,{oldState:t,newState:e})};e.prototype.getState=function(){return this._state};e.prototype.setVolume=function(e){this._volume=e;return this};e.prototype.getVolume=function(){return this._volume};e.prototype.setMute=function(e){this._mute=e;return this};e.prototype.getMute=function(){return this._mute};e.prototype.setCurrentPosition=function(e){return this};e.prototype.getCurrentPosition=function(){return 0};e.prototype.getLoadedPercent=function(){return 0};e.prototype.getTotalTime=function(){return 0};return e}();r.mixTo(i);return i});(function(e,t){if(typeof exports==="object"){module.exports=t()}else if(typeof define==="function"&&define.amd){define("muplayer/lib/modernizr.audio",t)}else{e._mu.Modernizr=t()}})(this,function(){return function(e,t,r){var n="2.7.1",i={},o=t.documentElement,s="modernizr",u=t.createElement(s),a=u.style,f,l={}.toString,p={},c={},h={},y=[],g=y.slice,d,m={}.hasOwnProperty,_;if(!v(m,"undefined")&&!v(m.call,"undefined")){_=function(e,t){return m.call(e,t)}}else{_=function(e,t){return t in e&&v(e.constructor.prototype[t],"undefined")}}if(!Function.prototype.bind){Function.prototype.bind=function C(e){var t=this;if(typeof t!="function"){throw new TypeError}var r=g.call(arguments,1),n=function(){if(this instanceof n){var i=function(){};i.prototype=t.prototype;var o=new i;var s=t.apply(o,r.concat(g.call(arguments)));if(Object(s)===s){return s}return o}else{return t.apply(e,r.concat(g.call(arguments)))}};return n}}function E(e){a.cssText=e}function T(e,t){return E(prefixes.join(e+";")+(t||""))}function v(e,t){return typeof e===t}function P(e,t){return!!~(""+e).indexOf(t)}function S(e,t,n){for(var i in e){var o=t[e[i]];if(o!==r){if(n===false)return e[i];if(v(o,"function")){return o.bind(n||t)}return o}}return false}p["audio"]=function(){var e=t.createElement("audio"),r=false;try{if(r=!!e.canPlayType){r=new Boolean(r);r.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");r.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,"");r.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");r.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}}catch(n){}return r};for(var b in p){if(_(p,b)){d=b.toLowerCase();i[d]=p[b]();y.push((i[d]?"":"no-")+d)}}i.addTest=function(e,t){if(typeof e=="object"){for(var n in e){if(_(e,n)){i.addTest(n,e[n])}}}else{e=e.toLowerCase();if(i[e]!==r){return i}t=typeof t=="function"?t():t;if(typeof enableClasses!=="undefined"&&enableClasses){o.className+=" "+(t?"":"no-")+e}i[e]=t}return i};E("");u=f=null;i._version=n;return i}(this,this.document)});var bind=function(e,t){return function(){return e.apply(t,arguments)}},extend=function(e,t){for(var r in t){if(hasProp.call(t,r))e[r]=t[r]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},hasProp={}.hasOwnProperty,slice=[].slice;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/audioCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/core/engines/engineCore","muplayer/lib/modernizr.audio"],t)}else{return e._mu.AudioCore=t(_mu.cfg,_mu.utils,_mu.EngineCore,_mu.Modernizr)}})(this,function(e,t,r,n){var i,o,s,u,a,f,l,p;p=window;l=navigator.userAgent;f=e.engine,a=f.TYPES,s=f.EVENTS,u=f.STATES,o=f.ERRCODE;i=function(e){extend(r,e);r.defaults={confidence:"maybe",preload:false,autoplay:false,needPlayEmpty:true,emptyMP3:"http://static1.qianqian.com/web/static/j/empty.mp3"};r.prototype._supportedTypes=[];r.prototype.engineType=a.AUDIO;function r(e){this._playEmpty=bind(this._playEmpty,this);var t,i,o,s,a,f,l;this.opts=$.extend({},r.defaults,e);this.opts.emptyMP3=this.opts.baseDir+this.opts.emptyMP3;f=this.opts;a={"":0,maybe:1,probably:2};s=a[f.confidence];i=n.audio;if(!i){return this}for(o in i){l=i[o];if(a[l]>=s){this._supportedTypes.push(o)}}t={};i=new Audio;i.preload=f.preload;i.autoplay=f.autoplay;i.loop=false;i.on=function(e,r){var n;i.addEventListener(e,r,false);n=t[e];if(!n){n=[]}n.push(r);return i};i.off=function(e,r){var n,o,s;if(!e&&!r){for(e in t){s=t[e];for(n=0,o=s.length;n<o;n++){r=s[n];i.removeEventListener(e,r,false)}}}else{i.removeEventListener(e,r,false)}return i};this.audio=i;this._needCanPlay(["play","setCurrentPosition"]);this.setState(u.STOP)._initEvents();if(f.needPlayEmpty){p.addEventListener("touchstart",this._playEmpty,false)}}r.prototype._test=function(){if(!n.audio||!this._supportedTypes.length){return false}return true};r.prototype._playEmpty=function(){if(!this.getUrl()){this.setUrl(this.opts.emptyMP3).play()}return p.removeEventListener("touchstart",this._playEmpty,false)};r.prototype._isEmpty=function(){return this.getUrl()===this.opts.emptyMP3};r.prototype._initEvents=function(){var e,t,r,n,i,o,a;o=this;e=this.audio,a=this.trigger;i=[null,null],t=i[0],n=i[1];this.trigger=function(e,t){if(o._isEmpty()){return o}return a.call(o,e,t)};r=function(e){e=e||o.getLoadedPercent();o.trigger(s.PROGRESS,e);if(e===1){clearInterval(n);o._canPlayThrough=true;return o.setState(u.CANPLAYTHROUGH)}};return e.on("loadstart",function(){clearInterval(n);n=setInterval(function(){return r()},50);return o.setState(u.PREBUFFER)}).on("playing",function(){clearTimeout(t);return o.setState(u.PLAYING)}).on("pause",function(){clearTimeout(t);return o.setState(u.PAUSE)}).on("ended",function(){return o.setState(u.END)}).on("error",function(e){clearTimeout(t);return t=setTimeout(function(){return o.trigger(s.ERROR,e)},2e3)}).on("waiting",function(){return o.setState(u.PREBUFFER)}).on("loadeddata",function(){return o.setState(u.BUFFERING)}).on("timeupdate",function(){return o.trigger(s.POSITIONCHANGE,o.getCurrentPosition())}).on("progress",function(e){var t,i;clearInterval(n);if(!o._canPlayThrough){t=e.loaded||0;i=e.total||1;return r(t&&(t/i).toFixed(2)*1)}})};r.prototype._needCanPlay=function(e){var r,n,i,o,s,u;u=this;r=this.audio;s=[];for(n=0,i=e.length;n<i;n++){o=e[n];s.push(this[o]=t.wrap(this[o],function(){var e,t,n,i;t=arguments[0],e=2<=arguments.length?slice.call(arguments,1):[];i=null;n=function(){clearTimeout(i);t.apply(u,e);return r.off("canplay",n)};if(/webkit/.test(l.toLowerCase())){if(r.readyState<3){r.on("canplay",n)}else{t.apply(u,e)}}else{i=setTimeout(function(){var i;try{return t.apply(u,e)}catch(o){i=o;return typeof console!=="undefined"&&console!==null?typeof console.error==="function"?console.error("error: ",i):void 0:void 0}finally{r.off("canplay",n)}},1e3);r.on("canplay",n)}return u}))}return s};r.prototype.destroy=function(){r.__super__.destroy.call(this);this.audio.off();return this};r.prototype.play=function(){this.audio.play();return this};r.prototype.pause=function(){return this.audio.pause()};r.prototype.stop=function(){try{return this.audio.currentTime=0}catch(e){}finally{this.audio.pause()}};r.prototype.setUrl=function(e){if(e){this.audio.src=e;this.audio.load()}return r.__super__.setUrl.call(this,e)};r.prototype.setVolume=function(e){this.audio.volume=e/100;return r.__super__.setVolume.call(this,e)};r.prototype.setMute=function(e){this.audio.muted=e;return r.__super__.setMute.call(this,e)};r.prototype.setState=function(e){if(this._isEmpty()){return this}return r.__super__.setState.call(this,e)};r.prototype.setCurrentPosition=function(e){try{this.audio.currentTime=e/1e3}catch(t){return}finally{this.play()}return this};r.prototype.getCurrentPosition=function(){return~~(this.audio.currentTime*1e3)};r.prototype.getLoadedPercent=function(){var e,t,r,n,i,o;e=this.audio;t=e.currentTime;n=e.buffered;if(n){r=n.length;while(r--){if(n.start(r)<=(o=e.currentTime)&&o<=n.end(r)){t=n.end(r);break}}}i=this.getTotalTime()/1e3;t=t>i?i:t;return i&&(t/i).toFixed(2)*1||0};r.prototype.getTotalTime=function(){var e,t,r,n,i;i=this.audio,n=i.duration,t=i.buffered,r=i.currentTime;n=~~n;if(n===0&&t){e=t.length;if(e>0){n=t.end(--e)}else{n=r}}return n&&n*1e3||0};return r}(r);return i});(function(e,t){if(typeof exports==="object"){module.exports=t()}else if(typeof define==="function"&&define.amd){define("muplayer/lib/jquery.swfobject",t)}else{t()}})(this,function(){(function(e,t,r){var n="object",i=true;function o(e,t){var r=(e[0]||0)-(t[0]||0);return r>0||!r&&e.length>0&&o(e.slice(1),t.slice(1))}function s(e){if(typeof e!=n){return e}var t=[],r="";for(var o in e){if(typeof e[o]==n){r=s(e[o])}else{r=[o,i?encodeURI(e[o]):e[o]].join("=")}t.push(r)}return t.join("&")}function u(e){var t=[];for(var r in e){if(e[r]){t.push([r,'="',e[r],'"'].join(""))}}return t.join(" ")}function a(e){var t=[];for(var r in e){t.push(['<param name="',r,'" value="',s(e[r]),'" />'].join(""))}return t.join("")}try{var f=r.description||function(){return new r("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}()}catch(l){f="Unavailable"}var p=f.match(/\d+/g)||[0];e[t]={available:p[0]>0,activeX:r&&!r.name,version:{original:f,array:p,string:p.join("."),major:parseInt(p[0],10)||0,minor:parseInt(p[1],10)||0,release:parseInt(p[2],10)||0},hasVersion:function(e){var t=/string|number/.test(typeof e)?e.toString().split("."):/object/.test(typeof e)?[e.major,e.minor]:e||[0,0];return o(p,t)},encodeParams:true,expressInstall:"expressInstall.swf"/*tpa=http://static1.qianqian.com/web/static/j/expressInstall.swf*/,expressInstallIsActive:false,create:function(e){var t=this;if(!e.swf||t.expressInstallIsActive||!t.available&&!e.hasVersionFail){return false}if(!t.hasVersion(e.hasVersion||1)){t.expressInstallIsActive=true;if(typeof e.hasVersionFail=="function"){if(!e.hasVersionFail.apply(e)){return false}}e={swf:e.expressInstall||t.expressInstall,height:137,width:214,flashvars:{MMredirectURL:location.href,MMplayerType:t.activeX?"ActiveX":"PlugIn",MMdoctitle:document.title.slice(0,47)+" - Flash Player Installation"}}}attrs={data:e.swf,type:"application/x-shockwave-flash",id:e.id||"flash_"+Math.floor(Math.random()*999999999),width:e.width||320,height:e.height||180,style:e.style||""};i=typeof e.useEncode!=="undefined"?e.useEncode:t.encodeParams;e.movie=e.swf;e.wmode=e.wmode||"opaque";delete e.fallback;delete e.hasVersion;delete e.hasVersionFail;delete e.height;delete e.id;delete e.swf;delete e.useEncode;delete e.width;var r=document.createElement("div");r.innerHTML=["<object ",u(attrs),">",a(e),"</object>"].join("");return r.firstChild}};e.fn[t]=function(r){var i=this.find(n).andSelf().filter(n);if(/string|object/.test(typeof r)){this.each(function(){var i=e(this),o;r=typeof r==n?r:{swf:r};r.fallback=this;o=e[t].create(r);if(o){i.children().remove();i.html(o)}})}if(typeof r=="function"){i.each(function(){var n=this,i="jsInteractionTimeoutMs";n[i]=n[i]||0;if(n[i]<660){if(n.clientWidth||n.clientHeight){r.call(n)}else{setTimeout(function(){e(n)[t](r)},n[i]+66)}}})}return i}})(jQuery,"flash",navigator.plugins["Shockwave Flash"]||window.ActiveXObject)});var extend=function(e,t){for(var r in t){if(hasProp.call(t,r))e[r]=t[r]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},hasProp={}.hasOwnProperty,slice=[].slice;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/flashCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/Timer","muplayer/core/engines/engineCore","muplayer/lib/jquery.swfobject"],t)}else{return e._mu.FlashCore=t(_mu.cfg,_mu.utils,_mu.Timer,_mu.EngineCore)}})(this,function(e,t,r,n){var i,o,s,u,a,f,l;f=e.engine,o=f.EVENTS,u=f.STATES,i=f.ERRCODE;l=e.timerResolution;a={1:u.CANPLAYTHROUGH,2:u.PREBUFFER,3:u.BUFFERING,4:u.PLAYING,5:u.PAUSE,6:u.STOP,7:u.END};s=function(e){extend(n,e);n.defaults={expressInstaller:"expressInstall.swf"/*tpa=http://static1.qianqian.com/web/static/j/expressInstall.swf*/};function n(e){var r,i,o,s;this.opts=s=$.extend({},n.defaults,this.defaults,e);this._state=u.STOP;this._loaded=false;this._queue=[];this._needFlashReady(["play","pause","stop","setCurrentPosition","_setUrl","_setVolume","_setMute"]);this._unexceptionGet(["getCurrentPosition","getLoadedPercent","getTotalTime"]);r=s.baseDir;i="muplayer_"+setTimeout(function(){},0);o=s.instanceName+"_"+i;t.namespace("engines")[o]=this;o="_mu.engines."+o;this.flash=$.flash.create({swf:r+s.swf+"?t="+ +new Date,id:i,height:1,width:1,allowscriptaccess:"always",wmode:"transparent",expressInstaller:r+s.expressInstaller,flashvars:{_instanceName:o,_buffertime:5e3}});this.flash.tabIndex=-1;s.$el.append(this.flash);this._initEvents()}n.prototype._test=function(){if(!this.flash||!$.flash.hasVersion(this.opts.flashVer)){return false}return true};n.prototype._initEvents=function(){var e,t,n;e=this;this.progressTimer=new r(l);this.positionTimer=new r(l);n=function(){var t;t=e.getLoadedPercent();if(e._lastPer!==t){e._lastPer=t;e.trigger(o.PROGRESS,t)}if(t===1){return e.progressTimer.stop()}};t=function(){var t;t=e.getCurrentPosition();if(e._lastPos!==t){e._lastPos=t;return e.trigger(o.POSITIONCHANGE,t)}};this.progressTimer.every("100 ms",n);this.positionTimer.every("100 ms",t);return this.on(o.STATECHANGE,function(r){var n;n=r.newState;switch(n){case u.PREBUFFER:case u.PLAYING:e.progressTimer.start();break;case u.PAUSE:case u.STOP:e.progressTimer.stop();break;case u.END:e.progressTimer.reset()}switch(n){case u.PLAYING:return e.positionTimer.start();case u.PAUSE:case u.STOP:e.positionTimer.stop();return t();case u.END:e.positionTimer.reset();return delete e._lastPos}})};n.prototype._needFlashReady=function(e){var r,n,i,o;o=[];for(r=0,n=e.length;r<n;r++){i=e[r];o.push(this[i]=t.wrap(this[i],function(e){return function(){var t,r;r=arguments[0],t=2<=arguments.length?slice.call(arguments,1):[];if(e._loaded){r.apply(e,t)}else{e._pushQueue(r,t)}return e}}(this)))}return o};n.prototype._unexceptionGet=function(e){var r,n,i,o;o=[];for(r=0,n=e.length;r<n;r++){i=e[r];o.push(this[i]=t.wrap(this[i],function(e){return function(){var t,r;r=arguments[0],t=2<=arguments.length?slice.call(arguments,1):[];try{return r.apply(e,t)}catch(n){return 0}}}(this)))}return o};n.prototype._pushQueue=function(e,t){return this._queue.push([e,t])};n.prototype._fireQueue=function(){var e,t,r,n;n=[];while(this._queue.length){r=this._queue.shift(),t=r[0],e=r[1];n.push(t.apply(this,e))}return n};n.prototype.reset=function(){n.__super__.reset.call(this);this.progressTimer.reset();this.positionTimer.reset();return this};n.prototype.destroy=function(){n.__super__.destroy.call(this);this.flash.off().remove();this.progressTimer.clear();this.progressTimer=null;this.positionTimer.clear();this.positionTimer=null;return this};n.prototype.play=function(){var e;if(this.getUrl()){try{this.flash.f_play()}catch(t){e=t;this.trigger(o.ERROR,e)}}return this};n.prototype.pause=function(){this.flash.f_pause();return this};n.prototype.stop=function(){this.flash.f_stop();return this};n.prototype._setUrl=function(e){return this.flash.f_load(e)};n.prototype.setUrl=function(e){if(e){this._setUrl(e)}return n.__super__.setUrl.call(this,e)};n.prototype.getState=function(){return this._state};n.prototype._setVolume=function(e){return this.flash.setData("volume",e)};n.prototype.setVolume=function(e){this._setVolume(e);return n.__super__.setVolume.call(this,e)};n.prototype._setMute=function(e){return this.flash.setData("mute",e)};n.prototype.setMute=function(e){this._setMute(e);return n.__super__.setMute.call(this,e)};n.prototype.setCurrentPosition=function(e){this.flash.f_play(e);return this};n.prototype.getCurrentPosition=function(){return this.flash.getData("position")};n.prototype.getLoadedPercent=function(){return this.flash.getData("loadedPct")};n.prototype.getTotalTime=function(){return this.flash.getData("length")};n.prototype._swfOnLoad=function(){this._loaded=true;return setTimeout(function(e){return function(){return e._fireQueue()}}(this),0)};n.prototype._swfOnStateChange=function(e){var t;t=a[e];if(t){return this.setState(t)}};n.prototype._swfOnErr=function(e){return this.trigger(o.ERROR,e)};return n}(n);return s});var extend=function(e,t){for(var r in t){if(hasProp.call(t,r))e[r]=t[r]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},hasProp={}.hasOwnProperty;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/flashMP3Core",["muplayer/core/cfg","muplayer/core/engines/flashCore"],t)}else{return e._mu.FlashMP3Core=t(_mu.cfg,_mu.FlashCore)}})(this,function(e,t){var r,n;n=e.engine.TYPES;r=function(e){extend(t,e);function t(){return t.__super__.constructor.apply(this,arguments)}t.prototype.defaults={swf:"muplayer_mp3.swf"/*tpa=http://static1.qianqian.com/web/static/j/muplayer_mp3.swf*/,instanceName:"MP3Core",flashVer:"9.0.0"};t.prototype._supportedTypes=["mp3"];t.prototype.engineType=n.FLASH_MP3;return t}(t);return r});var extend=function(e,t){for(var r in t){if(hasProp.call(t,r))e[r]=t[r]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},hasProp={}.hasOwnProperty;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/flashMP4Core",["muplayer/core/cfg","muplayer/core/engines/flashCore"],t)}else{return e._mu.FlashMP4Core=t(_mu.cfg,_mu.FlashCore)}})(this,function(e,t){var r,n;n=e.engine.TYPES;r=function(e){extend(t,e);function t(){return t.__super__.constructor.apply(this,arguments)}t.prototype.defaults={swf:"muplayer_mp4.swf"/*tpa=http://static1.qianqian.com/web/static/j/muplayer_mp4.swf*/,instanceName:"MP4Core",flashVer:"http://static1.qianqian.com/web/static/j/9.0.115"};t.prototype._supportedTypes=["m4a"];t.prototype.engineType=n.FLASH_MP4;return t}(t);return r});(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/engines/engine",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/events","muplayer/core/engines/engineCore","muplayer/core/engines/audioCore","muplayer/core/engines/flashMP3Core","muplayer/core/engines/flashMP4Core"],t);
}else{return e._mu.Engine=t(_mu.cfg,_mu.utils,_mu.Events,_mu.EngineCore,_mu.AudioCore,_mu.FlashMP3Core,_mu.FlashMP4Core)}})(this,function(cfg,utils,Events,EngineCore,AudioCore,FlashMP3Core,FlashMP4Core){var EVENTS,Engine,STATES,ref,timerResolution;ref=cfg.engine,EVENTS=ref.EVENTS,STATES=ref.STATES;timerResolution=cfg.timerResolution;Engine=function(){Engine.el='<div id="muplayer_container_{{DATETIME}}" style="width: 1px; height: 1px; background: transparent; position: absolute; left: 0; top: 0;"></div>';Engine.prototype.defaults={engines:[{type:FlashMP3Core},{type:FlashMP4Core},{type:AudioCore}]};function Engine(e){this.opts=$.extend({},this.defaults,e);this._initEngines()}Engine.prototype._initEngines=function(){var $el,args,engine,i,j,len,opts,ref1,type;this.engines=[];opts=this.opts;this.$el=$el=$(Engine.el.replace(/{{DATETIME}}/g,+new Date)).appendTo("body");ref1=opts.engines;for(i=j=0,len=ref1.length;j<len;i=++j){engine=ref1[i];type=engine.type,args=engine.args;args=args||{};args.baseDir=opts.baseDir;args.$el=$el;try{if(!$.isFunction(type)){type=eval(type)}engine=new type(args)}catch(_error){throw new Error("Missing engine type: "+String(engine.type))}if(engine._test&&engine._test()){this.engines.push(engine)}}if(this.engines.length){return this.setEngine(this.engines[0])}else{return this.setEngine(new EngineCore)}};Engine.prototype.setEngine=function(e){var t,r,n,i,o,s,u,a;s=this;u=function(e){var t,r;t=e.newState,r=e.oldState;s.trigger(EVENTS.STATECHANGE,e);if(t===STATES.CANPLAYTHROUGH&&(r===STATES.PLAYING||r===STATES.PAUSE||r===STATES.STOP)){return s.setState(r)}};i=function(e){return s.trigger(EVENTS.POSITIONCHANGE,e)};o=function(e){return s.trigger(EVENTS.PROGRESS,e)};r=function(e){return s.trigger(EVENTS.ERROR,e)};t=function(e){return e.on(EVENTS.STATECHANGE,u).on(EVENTS.POSITIONCHANGE,i).on(EVENTS.PROGRESS,o).on(EVENTS.ERROR,r)};a=function(e){return e.off(EVENTS.STATECHANGE,u).off(EVENTS.POSITIONCHANGE,i).off(EVENTS.PROGRESS,o).off(EVENTS.ERROR,r)};if(!this.curEngine){return this.curEngine=t(e)}else if(this.curEngine!==e){n=this.curEngine;a(n).reset();this.curEngine=t(e);return this.curEngine.setVolume(n.getVolume()).setMute(n.getMute())}};Engine.prototype.canPlayType=function(e){if(e==="mp4a"){e="m4a"}return $.inArray(e,this.getSupportedTypes())!==-1};Engine.prototype.getSupportedTypes=function(){var e,t,r,n,i;i=[];n=this.engines;for(t=0,r=n.length;t<r;t++){e=n[t];i=i.concat(e.getSupportedTypes())}return i};Engine.prototype.switchEngineByType=function(e){var t,r,n,i,o;i=false;o=this.engines;for(r=0,n=o.length;r<n;r++){t=o[r];if(t.canPlayType(e)){this.setEngine(t);i=true;break}}if(!i){return this.setEngine(this.engines[0])}};Engine.prototype.reset=function(){this.curEngine.reset();return this};Engine.prototype.destroy=function(){var e,t,r,n;this.reset().off();n=this.engines;for(t=0,r=n.length;t<r;t++){e=n[t];e.destroy()}this.engines.length=0;this.$el.off().remove();delete this.curEngine;return this};Engine.prototype.setUrl=function(e){var t;if(!e){return this}t=utils.getExt(e);if(this.canPlayType(t)){if(!this.curEngine.canPlayType(t)){this.switchEngineByType(t)}}else{throw new Error("Can not play with: "+t)}this.curEngine.reset().setUrl(e);return this};Engine.prototype.getUrl=function(){return this.curEngine.getUrl()};Engine.prototype.play=function(){this.curEngine.play();return this};Engine.prototype.pause=function(){this.curEngine.pause();this.trigger(EVENTS.POSITIONCHANGE,this.getCurrentPosition());return this.setState(STATES.PAUSE)};Engine.prototype.stop=function(){this.curEngine.stop();this.trigger(EVENTS.POSITIONCHANGE,0);return this.setState(STATES.STOP)};Engine.prototype.setState=function(e){this.curEngine.setState(e);return this};Engine.prototype.getState=function(){return this.curEngine.getState()};Engine.prototype.setMute=function(e){this.curEngine.setMute(!!e);return this};Engine.prototype.getMute=function(){return this.curEngine.getMute()};Engine.prototype.setVolume=function(e){if($.isNumeric(e)&&e>=0&&e<=100){this.curEngine.setVolume(e)}return this};Engine.prototype.getVolume=function(){return this.curEngine.getVolume()};Engine.prototype.setCurrentPosition=function(e){e=~~e;this.curEngine.setCurrentPosition(e);return this};Engine.prototype.getCurrentPosition=function(){if(this.getState()===STATES.STOP){this.setCurrentPosition(0)}return this.curEngine.getCurrentPosition()};Engine.prototype.getLoadedPercent=function(){return this.curEngine.getLoadedPercent()};Engine.prototype.getTotalTime=function(){return this.curEngine.getTotalTime()};Engine.prototype.getEngineType=function(){return this.curEngine.engineType};return Engine}();Events.mixTo(Engine);return Engine});var slice=[].slice;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/player",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/Timer","muplayer/lib/events","muplayer/core/playlist","muplayer/core/engines/engine"],t)}else{return e._mu.Player=t(_mu.cfg,_mu.utils,_mu.Timer,_mu.Events,_mu.Playlist,_mu.Engine)}})(this,function(e,t,r,n,i,o){var s,u,a,f,l,p;l=e.engine,s=l.EVENTS,a=l.STATES;p=t.time2str;f=function(e,t){var r,n;if(e!=="prev"&&e!=="next"){return this}n=function(r){return function(){var n;n={cur:r.getCur()};if(t){n.auto=t}r.trigger("player:"+e,n);return r.stop(false).play()}}(this);if(this.getSongsNum()){r=this.playlist;if(!r.cur){n()}else if(r[e].call(r,t)){n()}else{this.trigger("player:"+e+":fail",t)}}return this};u=function(){var e;e=null;n.defaults={baseDir:"https://static0.qianqian.com/web/cms/muplayer/1-0-2/",mode:"loop",mute:false,volume:80,singleton:true,absoluteUrl:true,maxRetryTimes:1,maxWaitingTime:4,recoverMethod:"retry",fetch:function(){var e,t;t=$.Deferred();e=this.getCur();setTimeout(function(r){return function(){r.setUrl(e);return t.resolve()}}(this),0);return t.promise()}};function n(t){var s,u,a;this.opts=u=$.extend({},n.defaults,t);this.waitingTimer=new r(100);this._checkFrozen(["play","pause","stop","next","prev","retry","replay","setVolume","setMute","setUrl","setCurrentPosition","_startWaitingTimer"]);s=u.baseDir,a=u.singleton;if(!s.endsWith("/")){s=s+"/"}if(a){if(e){return e}e=this}this.playlist=new i({absoluteUrl:u.absoluteUrl});this.playlist.setMode(u.mode);this._initEngine(new o({baseDir:s,engines:u.engines}));this.setMute(u.mute);this.setVolume(u.volume);this.reset()}n.prototype._initEngine=function(e){var t,r;r=this;t=this.opts.recoverMethod;this.engine=e;return this.engine.on(s.STATECHANGE,function(e){var t;t=e.newState;r.trigger("player:statechange",e);r.trigger(t);if(t===a.END){return r._clearWaitingTimer().next(true)}}).on(s.POSITIONCHANGE,function(e){var t;e=~~e;if(!e){return}t=r.getState();if(r.getUrl()&&(t===a.PLAYING||t===a.PREBUFFER||t===a.BUFFERING||t===a.CANPLAYTHROUGH)){r.trigger("timeupdate",e);return r._startWaitingTimer()}}).on(s.PROGRESS,function(e){return r.trigger("progress",e)}).on(s.ERROR,function(e){if(r.getUrl()){if(typeof console!=="undefined"&&console!==null){if(typeof console.error==="function"){console.error("error: ",e)}}return r.trigger("error",e)}}).on(s.WAITING_TIMEOUT,function(){if(r.getEngineType()==="AudioCore"&&r.engine.curEngine._isEmpty()){return}if(!r.getUrl()){return}if(t==="retry"||t==="next"){r[t]()}return r.trigger("player:waiting_timeout")})};n.prototype.retry=function(){var e,t,r;if(this._retryTimes++<this.opts.maxRetryTimes){this._startWaitingTimer().trigger("player:retry",this._retryTimes);e=this.engine;r=this.getUrl();t=e.getCurrentPosition();this.pause().once("timeupdate",function(){return e.setCurrentPosition(t)});e.setUrl(r).play()}else{this._retryTimes=0;this.trigger("player:retry:max")}return this};n.prototype.play=function(e){var t,r,n,i,o;i=this;r=this.engine;t=$.Deferred();n=function(){if(!i._frozen){i._startWaitingTimer();if(i.getUrl()){r.play();if($.isNumeric(e)){r.setCurrentPosition(e)}}}return t.resolve()};o=this.getState();if(o===a.STOP||o===a.END){this.trigger("player:fetch:start");this.opts.fetch.call(this).done(function(){n();return i.trigger("player:fetch:done")}).fail(function(e){return i.trigger("player:fetch:fail",e)})}else{n()}i.trigger("player:play",e);return t.promise()};n.prototype.pause=function(e){if(e==null){e=true}this.engine.pause();this._clearWaitingTimer();if(e){this.trigger("player:pause")}return this};n.prototype.stop=function(e){if(e==null){e=true}this.engine.stop();this._clearWaitingTimer();if(e){this.trigger("player:stop")}return this};n.prototype.replay=function(){this.pause(false).play(0);return this};n.prototype.prev=function(){return f.apply(this,["prev"])};n.prototype.next=function(e){return f.apply(this,["next",e])};n.prototype.getCur=function(){var e,t;t=this.playlist;e=t.cur;if(!e&&this.getSongsNum()){t.cur=e=t.list[0]}return this._sid=""+e};n.prototype.setCur=function(e){var t;e=""+e;t=this.playlist;if(!e&&this.getSongsNum()){e=t.list[0]}if(e&&this._sid!==e){t.setCur(e);this._sid=e;this.stop(false)}this.trigger("player:setCur",e);return this};n.prototype.curPos=function(e){var t;t=this.engine.getCurrentPosition()/1e3;if(e){return p(t)}else{return t}};n.prototype.duration=function(e){var t;t=this.engine.getTotalTime()/1e3;if(e){return p(t)}else{return t}};n.prototype.add=function(e,t){if(t==null){t=true}if(e){this.playlist.add(e,t)}this.trigger("player:add",e);return this};n.prototype.remove=function(e){if(e){this.playlist.remove(e)}if(!this.getSongsNum()){this.reset()}this.trigger("player:remove",e);return this};n.prototype.reset=function(){delete this._sid;this._retryTimes=0;this.playlist.reset();this.engine.reset();this.trigger("player:reset");return this.stop(false)};n.prototype.destroy=function(){this.reset().off();this.engine.destroy();this.playlist.destroy();e=null;return this};n.prototype.getState=function(){return this.engine.getState()};n.prototype.setUrl=function(e){if(!e){return this}this.stop(false).engine.setUrl(e);this.trigger("player:setUrl",e);return this};n.prototype.getUrl=function(){return this.engine.getUrl()};n.prototype.getExt=function(){return t.getExt(this.getUrl())};n.prototype.setVolume=function(e){this.engine.setVolume(e);this.trigger("player:setVolume",e);return this};n.prototype.getVolume=function(){return this.engine.getVolume()};n.prototype.setMute=function(e){this.engine.setMute(e);this.trigger("player:setMute",e);return this};n.prototype.getMute=function(){return this.engine.getMute()};n.prototype.canPlayType=function(e){return this.engine.canPlayType(e)};n.prototype.getSongsNum=function(){return this.playlist.list.length};n.prototype.setMode=function(e){this.playlist.setMode(e);this.trigger("player:setMode",e);return this};n.prototype.getMode=function(){return this.playlist.mode};n.prototype.getEngineType=function(){return this.engine.curEngine.engineType};n.prototype.setFrozen=function(e){this._frozen=!!e;return this};n.prototype.cheatPlayer=function(){if(this.getEngineType()==="AudioCore"){this.engine.curEngine._playEmpty()}return this};n.prototype._checkFrozen=function(e){var r,n,i,o,s;s=this;o=[];for(r=0,n=e.length;r<n;r++){i=e[r];o.push(s[i]=t.wrap(s[i],function(){var e,t;t=arguments[0],e=2<=arguments.length?slice.call(arguments,1):[];if(!s._frozen){t.apply(s,e)}return s}))}return o};n.prototype._startWaitingTimer=function(){var e;e=this.opts.maxWaitingTime;if(e>0){this.waitingTimer.clear().after(e+" seconds",function(e){return function(){return e.engine.trigger(s.WAITING_TIMEOUT)}}(this)).start()}return this};n.prototype._clearWaitingTimer=function(){this.waitingTimer.clear();return this};return n}();n.mixTo(u);return u});var bind=function(e,t){return function(){return e.apply(t,arguments)}};(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/core/bmLogger",["muplayer/core/bmCfg","muplayer/core/bmUtils","muplayer/lib/Timer","muplayer/lib/events"],t)}else{return e._mu.BmLogger=t(_mu.bmCfg,_mu.bmUtils,_mu.Timer,_mu.Events)}})(this,function(e,t,r,n){var i,o,s,u,a;a=e.timerResolution,u=e.engine,s=u.STATES;r.prototype.time=function(){return this.ticks()*this.resolution()};i=$(window);o=function(){e.defaults={debug:false};function e(t,n){this.sendPlayEnd=bind(this.sendPlayEnd,this);this.send60s=bind(this.send60s,this);this.send100ms=bind(this.send100ms,this);this.sendPlayStart=bind(this.sendPlayStart,this);var i,o;this.opts=i=$.extend({},e.defaults,n);this.player=t;this._data=$.extend({UA:encodeURIComponent(navigator.userAgent)},i.data);o=$.os;if(o){this._data.os=o.iphone?"iphone":o.android?"android":"other"}this.timer=new r(a);this.bufferTimer=new r(a);this._initListeners()}e.prototype.reset=function(){this._hasSendPlayEnd=false;this._data=$.extend(this._data,{timestamp:"13_"+Math.random().toString().substr(2),flag:1,buffct:0,from:location.href});this.timer.clear();this.bufferTimer.clear();this.player.once("timeupdate",function(e){return function(){return e.send100ms()}}(this));return this};e.prototype._initListeners=function(){var e;e=this;i.on("beforeunload",function(){e.sendPlayEnd({endflag:2});return void 0});return this.player.on("player:fetchstart",function(){e.reset();return e.timer.after("59 seconds",e.send60s).start()}).on("player:fetchend",function(){e._data.s2l=e.timer.time();e._data=$.extend(e._data,e.player.resource());return e.sendPlayStart()}).on("player:fetcherr",function(t){return e.sendPlayEnd({flag:0,lerr:t.error_code})}).on("player:next",function(t){if(!t.auto){return e.sendPlayEnd({endflag:0})}}).on("player:setCur",function(){return e.sendPlayEnd({endflag:0})}).on("player:retry:max error",function(){return e.sendPlayEnd({flag:2})}).on(s.PLAYING,function(){e.timer.start();return e.bufferTimer.stop()}).on(s.PAUSE,function(){return e.timer.stop()}).on(s.END,function(){return e.sendPlayEnd()}).on(s.PREBUFFER,function(){if(e.player.curPos()){e._data.buffct++}return e.bufferTimer.start()})};e.prototype._send=function(e,r){var n,i,o,s;s=$.extend({src:"../../../../click.qianqian.com/v.gif"/*tpa=http://click.qianqian.com/v.gif*/,key:"_data"},r);e=$.extend(t.clone(this[s.key]),e);if(this.opts.debug){if(typeof console!=="undefined"&&console!==null){if(typeof console.debug==="function"){console.debug(e.type,e,this.player.getCur())}}}try{o=new Image;o.src=s.src+"?"+$.param(e)}catch(u){i=u;if(typeof console!=="undefined"&&console!==null){if(typeof console.error==="function"){console.error(i)}}}n=this["_cb_"+e.type];if(n){n.call(this,e)}return this};e.prototype.sendPlayStart=function(){var e,r,n;r=this.player;n=r.getCur();e=t.getExt(r.getUrl());$.extend(this._data,{sid:n,songfrom:$.isNumeric(+n)?"owner":"thirdParty",fileid:r._curSong.bitrate.song_file_id,source_type:e});return this._send({type:"playstart"})};e.prototype.send100ms=function(){$.extend(this._data,{l2p:this.bufferTimer.time(),s2p:this.timer.time()});this.bufferTimer.clear();return this._send({type:"playsong100ms"})};e.prototype.send60s=function(){var e,t,r,n;e={type:"60play"};n=this.player;r=~~n._curSong.bitrate.file_duration;t=n.duration();if(r){if(Math.abs(t-r)>10){e.duration=t}}return this._send(e)};e.prototype.sendPlayEnd=function(e){var t;if(!this._hasSendPlayEnd){this._hasSendPlayEnd=true;t=this.timer.time();return this._send($.extend({type:"playend",endflag:1,s2e:t,pt:t,pos:this.player.curPos(),duration:this.player.duration()},e))}};return e}();n.mixTo(o);return o});var extend=function(e,t){for(var r in t){if(hasProp.call(t,r))e[r]=t[r]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},hasProp={}.hasOwnProperty;(function(e,t){if(typeof exports==="object"){return module.exports=t()}else if(typeof define==="function"&&define.amd){return define("muplayer/bmPlayer",["muplayer/core/bmCfg","muplayer/core/bmUtils","muplayer/player","muplayer/core/bmLogger"],t)}else{return e._mu.BmPlayer=t(_mu.bmCfg,_mu.bmUtils,_mu.Player,_mu.BmLogger)}})(this,function(e,t,r,n,i){var o,s;s=t.time2str;o=function(e){extend(r,e);r.defaults={absoluteUrl:false,initLogger:true,loggerArgs:{api:"bmplayer",data:{}},initAd:false,adArgs:{},engines:[{type:"FlashMP3Core"},{type:"FlashMP4Core"},{type:"AudioCore"}],fetch:function(){var e,r,n,i,o;n=this;r=$.Deferred();i=function(){var e;e=n._cache[n.getCur()];n._curSong=e;n.engine.reset();n.setUrl(e.bitrate.file_link);n.trigger("player:fetchend",e);return r.resolve(e)};o=this.getCur();if(!o){r.reject();return r.promise()}this.trigger("player:fetchstart");if(t.has(this._cache,o)){i()}else{e=this.canPlayType("m4a")?"baidu.ting.song.playAAC":"http://static1.qianqian.com/web/static/j/baidu.ting.song.play";t.api(e,{songid:o,from:n.opts.loggerArgs.api},{handleError:function(e){n.trigger("player:fetcherr",e);return n.opts.handleFetchError.call(n,e,o)}}).done(function(e){n._cache[o]=e;return i()})}return r.promise()},handleFetchError:function(e,t){if(typeof console!=="undefined"&&console!==null){if(typeof console.error==="function"){console.error("player fetch error: ",t,e.error_code)}}return this.trigger("error",e)}};function r(e){var t;r.__super__.constructor.call(this,$.extend({},r.defaults,e));t=this.opts;if(t.initLogger){this.logger=new n(this,t.loggerArgs)}}r.prototype._cache={};r.prototype.duration=function(e){var t,r,n;t=function(e,t){return t&&s(e)||e};if(!this._curSong){r=this.engine.getTotalTime()/1e3;return t(r,e)}n=this._curSong;r=n.bitrate&&n.bitrate.file_duration||0;r=r||this.engine.getTotalTime()/1e3;return t(r,e)};r.prototype.resource=function(){var e;if(!this._curSong){return{}}e=this._curSong;return{rate:e.bitrate&&e.bitrate.file_bitrate||0,resource_type_ext:e.songinfo&&e.songinfo.resource_type_ext||"",bitrate_fee:e.songinfo&&e.songinfo.bitrate_fee||""}};return r}(r);return o});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/