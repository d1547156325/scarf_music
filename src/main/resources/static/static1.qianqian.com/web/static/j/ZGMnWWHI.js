require(["core/utils","page/dynamic/dynamic_tpl","page/dynamic/publish","page/dynamic/add_friend","widget/pop_window/pop_window"],function(i,o,e,t,n){var a=$(".dynamic-list"),c=$(".dynamic"),l=$(".loading-dynamic"),s=$(".add-friend-close"),r=$(".add-friend-done"),d=0,g=190,m=765,p=$(".new-topic");$recommentTopic=$(".recomment-topic");windowScroll=function(){};var f={dataUrl:"baidu.ting.ugcfriend.getList",$dynamicBox:$(".dynamic-list"),dyData:{},_reload:false,insertTop:false,getDyListParam:{size:20}};init=function(){if($recommentTopic[0]&&$recommentTopic[0].offsetTop){m=$recommentTopic[0].offsetTop}if(p.offsetTop){g=p.offsetTop}if(ting&&ting.logger){ting.logger.log("exposure",{page:"dynamicmainpage",pos:"home"})}},getDyData=function(){f.$dynamicBox.append(l.show());f.insertTop=false;i.tingApi(f.dataUrl,f.getDyListParam).done(function(i){if(i.msg&&i.msg.length>=1){f.getDyListParam.msgid=i.last_msg_id||i.msg[i.msg.length-1].msgid||0;f.getDyListParam.timestamp=i.last_timestamp||i.msg[i.msg.length-1].rtime||0}if(i.is_guide){$(".isguide").show()}f.dyData=i.msg;o.showDynamic(f);$(window).bind("scroll",windowScroll)})},_scrollTop=0,windowScroll=function(){f._reload=false;var i=parseFloat($(window).scrollTop());if(i>m){$recommentTopic.addClass("recomment-topic-fixed")}else{$recommentTopic.removeClass("recomment-topic-fixed")}if(i>g){p.addClass("new-topic-fixed")}else{p.removeClass("new-topic-fixed")}totalheight=parseFloat($(window).height())+i;if(parseFloat($(window).scrollTop())<=_scrollTop){_scrollTop=parseFloat($(window).scrollTop());return false}_scrollTop=parseFloat($(window).scrollTop());if($(document).height()-150<=totalheight){$(window).unbind("scroll");f.showDomCallBack=function(){};getDyData()}},e.init({baseEl:$(".music-body"),callback:function(i){if(i){var e=[i];f.dyData=e;f.insertTop=true;o.showDynamic(f)}}});$(".dy-msg a").click(function(){f={dataUrl:"baidu.ting.ugcfriend.getList",$dynamicBox:$(".dynamic-list"),dyData:{},insertTop:false,_reload:true,getDyListParam:{size:20}};f.showDomCallBack=function(){$(window).scrollTop(0,0,0)};getDyData();$(".dy-msg").hide()});$("#editDynamic").on("click",function(){ting.passport.checkLogin(function(){e.show()})});$(".isguide-pic, .recomment-user-more").click(function(){var i=$(this);ting.passport.checkLogin(function(){t.getDaren(0);$(".isguide").hide();if(i.hasClass("isguide-pic")){$(".add-friend-box").attr("data-addfriendtype","fromclickfollow");if(ting&&ting.logger){ting.logger.log("click",{page:"jumppannel",pos:"fromqgzhy"})}}else{$(".add-friend-box").attr("data-addfriendtype","frommore");if(ting&&ting.logger){ting.logger.log("click",{page:"dynamicmainpage",pos:"fromrightmore"})}}})});s.click(function(){window.location.reload()});r.click(function(){window.location.reload()});$(".recomment-user-change").click(function(){var i=$(".recomment-user ul");var o=$(".recomment-user ul").length;if(d<o-1){d++}else{d=0}i.hide();i.eq(d).show();if($recommentTopic[0]){m=$recommentTopic[0].offsetTop}});getDyData();init();$(".dynamic-list").on("click",".dynamic-topic-link",function(){if(ting&&ting.logger){ting.logger.log("click",{page:"top_click",pos:"total"})}});$(".recomment-topic").on("click",".hot-discuss-link",function(){var i=$(this).data("index")||0;if(ting&&ting.logger){ting.logger.log("click",{page:"top_topthree",pos:"top_"+i})}});var u=setInterval(function(){if(ting&&ting.userInfo){clearInterval(u);i.getWebChat({setUnreadD:function(i){if(i.serverid==10004&&i.message_type==2){$(".dy-msg").show()}}})}},2e3)});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/