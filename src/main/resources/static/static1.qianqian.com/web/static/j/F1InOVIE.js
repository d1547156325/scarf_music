void function(t){t.widget("ting.photoview",{options:{photos:null,photosIndex:null,id:null,showHistory:true},_create:function(){var t=this,i=t.options,e=t.element;t.widgetEventPrefix="photoview.";t.currentId=i.id;t.currentInfo=null;t.cache=null;t.dir=0;t.p_index=i.ajaxParam.start;t.bindEvent()},_init:function(){},ajaxdata:function(t){var i=this,e=i.options,o=e.ajaxParam,n=5;o.start=t*1-n;if(o.start<0){i.index=n+o.start;o.start=0}else{i.index=n}i.p_index=t*1;ting.connect.getArtistPhotosData(o,null,function(t){e.photos=t.data.photosInfo;e.photosIndex=t.data.photoList;i.currentId=e.photosIndex[i.index];i.currentInfo=e.photos[i.currentId];i.load();i.initCur(i.cache)})},load:function(){var i=this,e=i.options,o=i.element,n=window.location.href,r=0;imgHeight=0;ratio=1;_photo=i.currentInfo;if(!_photo){return false}t("img",o).css({visibility:"hidden"});if(_photo.photo_width>600){if(_photo.photo_width&&_photo.photo_height){ratio=_photo.photo_width/_photo.photo_height}r=600;imgHeight=600/ratio}else{r=_photo.photo_width;imgHeight=_photo.photo_height}t("img",o).attr("src",_photo.photo_big_url);t("img",o).animate({width:r,height:imgHeight},{duration:"normal",complete:function(){t(this).css({display:"block",visibility:"visible"})}});i._trigger("loadinfo",null,i)},getNext:function(t){var i=this,e=window.location.href,o=i.options;if(t){i.dir=t}i.p_index=i.p_index*1+i.dir;i.index=i.index*1+i.dir*1;i.currentId=o.photosIndex[i.index];i.currentInfo=o.photos[i.currentId];this.options.showHistory&&(window.location.href=e.split("#")[0]+"#"+i.currentId+"-"+i.p_index);if(i.index==1||i.index==o.photosIndex.length-2){o.ajaxParam.start=i.p_index;i.ajaxdata(i.p_index)}else{i.load()}},initCur:function(t){var i=this,e=i.options;if(!e.photos[i.currentId]){return false}i.element.removeClass("cur-right cur-right-d cur-left cur-left-d");if(e.photos[i.currentId].index==e.photosIndex.length-1&&t=="cur-right"){i.element.addClass("cur-right-d");return}else if(i.p_index==0&&t=="cur-left"){i.element.addClass("cur-left-d");return}i.element.addClass(t)},bindEvent:function(){var t=this,i=t.options,e=t.element;e.bind("click",function(i){var o=i.clientX-e.offset().left;if(e.hasClass("cur-left-d")||e.hasClass("cur-right-d")){return false}if(e.hasClass("cur-left")){t.dir=-1}else if(e.hasClass("cur-right")){t.dir=1}if(t.dir){t.getNext()}if(o<e.width()/2){t.initCur("cur-left")}else{t.initCur("cur-right")}return false}).bind("mousemove",function(i){var o=i.clientX-e.offset().left;if(o<e.width()/2){if(t.cache!="cur-left"){t.initCur("cur-left");t.cache="cur-left"}}else{if(t.cache!="cur-right"){t.initCur("cur-right");t.cache="cur-right"}}})},destroy:function(){}})}(jQuery);

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/