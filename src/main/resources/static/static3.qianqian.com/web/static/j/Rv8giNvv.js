(function(a){a.widget("ting.songlistExpand",{options:{songlistDiv:".songlist-expand",actionHook:".action-hook",type:"",id:"",url:"/data/music/songlist",hotBar:false,moduleName:null,noAlbum:false},_create:function(){var a=this,t=a.element,i=a.options;a.widgetEventPrefix="songlistexpand.";a.$albumItem=t.parents("li");a.$action=t.find(i.actionHook);a.$songlistDiv=a.$albumItem.find(i.songlistDiv);a.type=t.data("songlistexpand").type||i.type;a.id=t.data("songlistexpand").id||i.id;a.name=t.data("songlistexpand").name||i.name;a.loaded=false},_init:function(){var t=this,i=t.element,e=t.options;i.bind("click",function(){if(i.hasClass("fold")){if(!t.loaded){t.expandSongs(t.type,t.id,t.name);t.loaded=true}else{t.display(t.$songlistDiv,"show")}i.removeClass("fold").addClass("unfold");t.$action.text("收起");if(ting&&ting.logger&&ting.logger.plogClick){ting.logger.plogClick("unfold")}}else{t.display(t.$songlistDiv,"hide");i.removeClass("unfold").addClass("fold");t.$action.text("展开");if(ting&&ting.logger&&ting.logger.plogClick){ting.logger.plogClick("fold")}}return false});t.$albumItem.find("http://static3.qianqian.com/web/static/j/div.info").bind("mouseenter",function(t){a(this).addClass("bgc-gray")}).bind("mouseleave",function(t){a(this).removeClass("bgc-gray")}).bind("click",function(t){var e=t.target;var s=a(e).parents(".btn");var o=a(e).parents(".album-face, .artist-face");var n=e.className;var l=e.tagName.toLowerCase();if(l!=="a"&&l!=="em"&&n!=="frame"&&!s.length&&!o.length){i.click()}})},expandSongs:function(t,i,e){var s=this;opt=s.options;s.$songlistDiv.addClass("loading-data");s.display(s.$songlistDiv,"show");var o=opt.hotBar?"hotbar=1":"",n=opt.moduleName?"&moduleName="+opt.moduleName:"",l=opt.noAlbum?"&noAlbum=1":"",d=opt.url+"?"+o+n+l;a.ajax({type:"POST",url:d,data:{id:i,type:t},dataType:"json",success:function(t){var i=t;var o=i.errorCode;var n=i.data.html;if(o=="22000"&&n){s.$songlistDiv.append(a(n)).removeClass("loading-data");s.$songlistDiv.find(".song-list-hook").songList({type:"album",data:{albumname:e}});s.$songlistDiv.find(".music-icon-hook").musicIcon()}else if(o="22001"){s.$songlistDiv.append("<p style='text-align:center;' class='no-data c9'>该专辑暂无歌曲</p>").removeClass("loading-data")}s._trigger("expanded")}})},display:function(a,t){a.animate({height:t,opacity:t},"fast");if(t=="show"){this.$albumItem.removeClass("bb").addClass("bbs")}else{this.$albumItem.removeClass("bbs").addClass("bb")}}})})(jQuery);

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/