define(["core/utils","tmpl/rank/urank/ranksearchTmpl","sug/autoComplete","plugin/_"],function(e,n){var a=$("#search_form"),r=$(".s_ipt_wr input"),t=$(".s_ipt_wr"),i=$(".ranksearch"),s=$("#loading-pic"),l=false,u={},o=null,c=null,h=0,d="";setAddInputEventListener=function(){r.bind("blur",function(){if(!l){if(t&&t.hasClass("s_ipt_wr_active_border")){t.removeClass("s_ipt_wr_active_border")}$(".ranksearch").fadeOut(300)}});r.bind("focus input propertychange",function(e){var n=$(".sug-result");n.html();n.remove();if(o===null){t.addClass("s_ipt_wr_active_border");var a=$(".ranksearch");a.show();o=setTimeout(function(){textChangeHandler(e)},50)}else{}});i.bind("mouseenter",function(e){l=true});i.bind("mouseleave",function(e){c=null;l=false});r.bind("keydown",function(e){if(e.keyCode!=13)return true;getRankSugBtn(d);return false});$(".ui-placeholder-label").html("请输入歌名、歌手或专辑")},textChangeHandler=function(e){o=null;var n=r.val();if(d==$.trim(n)&&d!=n){return}d=$.trim(n);h=(new Date).valueOf();getRankSug(d);$(".ranksearch").show()},mouseOverHandler=function(){$("li",i).bind("mouseenter",function(e){console.log("enter");$("a",i).removeClass("over");c=$(this);$(this).children("a").addClass("over")})},mouseOutHandler=function(){var e=this;$("li",i).bind("mouseleave",function(e){$(this).children("a").removeClass("over");c=null})},getRankSug=function(r){var t=r||"";e.tingApi("baidu.ting.active.searchUBill",{search_word:t}).always(function(e){var r=n({item:e,album:e.result.album,artist:e.result.artist});if(e.search_result){if($(".ranksearch").length){$(".ranksearch").eq(0).replaceWith(r)}else{a.append(r)}}else{}$(".ranksearch").show()})};getRankSugBtn=function(r){var t=r||"";e.tingApi("baidu.ting.active.searchUBill",{search_word:t}).always(function(e){var r=n({item:e,album:e.result.album,artist:e.result.artist});if($(".ranksearch").length){$(".ranksearch").eq(0).replaceWith(r)}else{a.append(r)}$(".ranksearch").show();$(".ranksearch:last").addClass("yt")})};setAddInputEventListener();$(".nav-wrapper").on("click",".s_btn_wr",function(){getRankSugBtn(d)})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/