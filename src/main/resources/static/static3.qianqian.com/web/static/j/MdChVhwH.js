void function(e,t){var i=null;e.widget("ting.refreshTrigger",{options:{eventName:"click",attrName:"href",stopEvent:true,urlFilter:"default",target:"",url:"",args:null,repeat:true,stamp:"_t"},_create:function(){var t=this,i=t.element,a=t.options;t.widgetEventPrefix="refreshTrigger.";t.url=a.url||(typeof a.urlFilter=="function"?a.urlFilter(i.attr(a.attrName)):e.ting.refreshTrigger.filters[a.urlFilter]&&e.ting.refreshTrigger.filters[a.urlFilter](i.attr(a.attrName)))},_init:function(){var e=this,t=e.element,i=e.options;e.init=false;i.eventName&&t.bind(i.eventName,function(t){return e.refresh()});t.bind("refreshtrigger.beforerefresh",function(){if(!i.repeat){return!e.init}}).bind("refreshtrigger.afterrefresh",function(){e.init=true})},refresh:function(){var t=this,i=t.options;if(!i.disabled&&false!==t._trigger("beforeRefresh",null,{url:t.url})){e.ting.refreshTrigger.refresh(i.target,t.url,i.args,function(){t._trigger("afterRefresh",null,{url:t.url,element:this})},i.stamp)}return!i.stopEvent}});function a(e){if(document.createStyleSheet){i=i||document.createStyleSheet();i.cssText+=e}else{i||(i=document.createElement("style"),i.type="text/css",document.getElementsByTagName("head")[0].appendChild(i));i.appendChild(document.createTextNode(e))}}e.extend(e.ting.refreshTrigger,{refresh:function(t,i,n,l,o){var s={};o&&(s[o]=+new Date);e.get(i,e.extend(s,typeof n=="function"?n.call(t):n),function(t,i){return function(n){a(n.data.css);var l=e(t).html(n.data.html);new Function(n.data.js).call(l);i&&i.call(l)}}(t,l),"json")},filters:{"default":function(e){return String(e).replace(/^.*?#~/,"")}}})}(jQuery);require(["core/utils"],function(e){var t=$(".playlist-add");var i=$(".collectText");var a=$(".collectNum");var n=t.data("playlist");$(".btn-collect").live("click",function(){var l=$(this);if(!n.listid){t.tip().tip("tipup",{msg:"该专辑不存在！",iconClass:"tip-error"})}ting.passport.checkLogin(function(){e.tingApi("baidu.ting.ugcdiy.addFavoriteDiy",{list_id:n.listid||"",source:1}).done(function(e){if(e.error_code==22e3){t.data("collected",true);l.tip().tip("tipup",{msg:"收藏成功",iconClass:"tip-success"});l.addClass("btn-collected").removeClass("btn-collect");i.html("已收藏");a.html(Number(a.html())+1)}}).fail(function(e){var a="tip-error";var n="";switch(Number(e.error_code)){case 22713:a="tip-warning";n="专辑已收藏过";i.html("已收藏");break;case 22001:n="操作失败，请稍候再试 ";break;case 22706:n="收藏数量已满，去个人中心管理收藏吧";break;default:n="操作失败，请稍候再试 "}t.tip().tip("tipup",{msg:n,iconClass:a})})})});$(".btn-collected").live("click",function(){var t=$(this);var l={list_id:n.listid||"",source:1};e.tingApi("baidu.ting.ugcdiy.deleteFavoriteDiy",l).done(function(e){if(e.error_code==22e3){t.data("collected",false);t.tip().tip("tipup",{msg:"取消收藏成功！",iconClass:"tip-success"});t.addClass("btn-collect").removeClass("btn-collected");i.html("收藏");var n=Number(a.html());n=n==0?0:n-1;a.html(n)}}).fail(function(e){var t="tip-error";var i="操作失败，请稍候再试 ";$collectArtist.tip().tip("tipup",{msg:i,iconClass:t})})})});$(function(){var e=$(".album-down"),e=$(".album-down");var t=function(){if(!ting.userInfo){$.getJSON("/data/user/info?callback=?",function(t){if(t.data.batchDown==1){e.show()}})}else{if(ting.userInfo.batchDown==1){e.show()}}};var i=function(e,t){ting.showTip({$tar:e,type:"needgoldvip",cancelEvent:"blur",reason:t})};var a="";var n=$(".album-cover");var e=$(".album-down");var l=n.data("albumdata");var o=e.data("downdata");var s=l.id||"";var r=l.playFeeIDs.length||"";var c=o.downFeeIDs.length||"";var d=$(".album-cover-hook");d.albumCover();var u=d.data("albumdata");var m=u.ids;var g=u.playIDs;var p=u.playFeeIDs;var f=g.length;var v=$(".album-down").data("downdata").downIDs.length;var b=p.length;ting.checkSellResourse("",s,function(e,t){a=t;if(a==1){$(".album-buy-hook .btn-text").html('<i class="btn-icon btn-buy-icon"></i>再次购买')}else{$(".album-buy-hook .btn-text").html('<i class="btn-icon btn-buy-icon"></i>购买专辑')}$(".album-buy-hook").removeClass("opt0")});$(".album-add").click(function(e){var t=$(this);var n=$(this).data("adddata");var l=n.ids;var o=n.playIDs;var s=n.playFeeIDs;var r=o.length;var c=s.length;var d={moduleName:n.moduleName,ids:n.ids||"",mediaType:2,albumId:n.albumId||"",_aiPresaleFlag:n._aiPresaleFlag||"",resourceTypeExt:n.resourceTypeExt||"",albumPic:n.albumPic||"",albumTitle:n.albumTitle||"",albumPublishTime:n.albumPublishTime||""};var u={page:ting.logger.getPage(),pos:"add_album"};t.tip();if(d.resourceTypeExt&&(d.resourceTypeExt==3||d.resourceTypeExt==4)){ting.checkSellResourse(d.id,d.albumId,function(e,i){d.isPay=i;ting.media.addSong(l,d);if(d.isPay!=1||d.siPresaleFlag==1||d._aiPresaleFlag==1){}else{t.tip("tipup",{msg:"添加成功！",iconClass:"tip-success"})}});u.album_title=d.albumTitle;u.album_id=d.albumId;u.isPay=3}else if(BDUS&&BDUS.vipState!="gold"&&a!=1){if(r){ting.media.addSong(o,d);if(c){t.tip("tipup",{msg:"已自动过滤付费歌曲",iconClass:"tip-success"})}else{t.tip("tipup",{msg:"添加成功！",iconClass:"tip-success"})}}else{if(c){i(t,"pay_listen")}else{t.tip("tipup",{msg:"添加成功！",iconClass:"tip-success"});ting.media.addSong(l,d)}}}else{t.tip("tipup",{msg:"添加成功！",iconClass:"tip-success"});ting.media.addSong(l,d)}if(ting&&ting.logger&&ting.logger.plogClick){ting.logger.plogClick("add_album");ting.logger.log("add_album",u)}return false});$(".song-list-hook").songList({type:"album",data:{albumname:albumName}});e.bind("click",function(){var e=$(this);var t=$(this).data("downdata");var n=t.ids;var l=t.downIDs;var o=t.downFeeIDs;var s=l.length;var r=o.length;var c=t.albumname;var d=t.author;var u={clientUrlPos:"web_piliang",moduleName:t.moduleName,ids:t.ids||"",mediaType:2,albumId:t.albumId||"",_aiPresaleFlag:t._aiPresaleFlag||"",resourceTypeExt:t.resourceTypeExt||"",albumPic:t.albumPic||"",albumTitle:t.albumTitle||"",albumPublishTime:t.albumPublishTime||""};if(u.ids.length==0){u.ids=t.downIDs}var m={page:ting.logger.getPage(),pos:"down_album",album_id:u.albumId};e.tip();if(u.resourceTypeExt&&(u.resourceTypeExt==3||u.resourceTypeExt==4)){ting.checkSellResourse(u.id,u.albumId,function(e,t){u.isPay=u._isPay=t;ting.media.downloadAll(u.ids,{type:"album",title:c,author:d},u);if(u.isPay!=1||u.siPresaleFlag==1||u._aiPresaleFlag==1){}else{}});m.album_title=u.albumTitle;m.album_id=u.albumId;m.isPay=3}else if(BDUS&&BDUS.vipState!="gold"&&a!=1){if(s){ting.media.downloadAll(l,{type:"album",title:c,author:d},u);if(r){e.tip("tipup",{msg:"已自动过滤付费歌曲",iconClass:"tip-success"})}}else{if(r){i(e,"down")}else{ting.media.downloadAll(n,{type:"album",title:c,author:d},u)}}}else{ting.media.downloadAll(n,{type:"album",title:c,author:d},u)}var g=$(this).data("downdata").ids.length;m.song_num=g;ting.logger.log("down_album",m);return false});$(".des-more-hook").toggle(function(){$(".album-info .description").hide();$(".album-info .description-all").show();$(".mod-song-list").addClass("info-expand");$(".album-recommend").addClass("info-expand");$(this).text("收起");return false},function(){$(".album-info .description-all ").hide();$(".album-info .description").show();$(".mod-song-list").removeClass("info-expand");$(".album-recommend").removeClass("info-expand");$(this).text("展开");return false});$(".page-navigator-hook a").refreshTrigger({target:".album-recommend-list"});ting.logger.exposureAndAnchorClickLog("m_album",[{root:$(".mod-other-list"),logName:"otheralbum",returnFalseSelector:[".play-icon"]}]);var h=0,y=false;$("#updateArtist").bind("click",function(){var e=$(".related-list"),t=$(".related-list:visible");t.hide();++h;if(h>=e.length){h=0;y=true}if(!y){$(".cover img",$(e[h])).each(function(){var e=$(this).attr("org_src"),t=$(this).attr("src");if(e!=t){$(this).attr("src",e)}})}$(e[h]).show();return false});var _=false,w=false;$(":ting-comment").on("comment.beforsubmit",function(){var e=$("a.user-voice-submit",this);var t=e.data("btndata");ting.logger.log("click",{page:"music",pos:"comment",sub:"album",singer_id:t.log_singer_id,albumid:t.log_albumid})})});$(function(){function e(e){var t=/^[\u4E00-\u9FA5]+$/;if(!t.test(e)){return false}return true}var t=$(".cover > img")[0],i="",a=[],n="",l="",o="",s="";l=t.getAttribute("alt");o=t.getAttribute("title");s=$(".cover")[0].getAttribute("title");a=l.split(" ");n=a.join("");if(!e(n)){i=o+"专辑《"+l+"》"}else{if(/电视原声带|电影原声带/.test(l)||/电视原声|电影原声|影视原声|动漫原声/.test(o)||/影视原声/.test(s)){i=a[0]+"插曲"}else{i=o+"专辑《"+a[0]+"》"}}$(".cover")[0].removeAttribute("title");$(".cover > img").attr("alt",i);$(".cover > img").attr("title",i)});(function(e){var t=e(".product-dialog");e(".clients-android").on("click",function(){t.dialog({width:618,stick:true}).dialog("show")});$clientsPc=e(".clients-pc");if(/mac/i.test(navigator.userAgent)){$clientsPc.show().attr("href","//download.qianqian.com/channel/2/web_xiangqingad").attr("data-log",'{ "pos":"mac_down" }').html('<span class="icon css-icon-mac"></span>Mac版本')}else{$clientsPc.show();e(".clients-wrapper-pc .send-vip").show();var i;$clientsPc.on("mouseenter",function(){var t=e(".pc-tips");ting.loadChildImages(t,arguments.callee);t.show();ting.logger.log("exposure",{page:ting.logger.getPage(),expoitem:"pannel_dl_qianqian"})}).on("mouseleave",function(){i=setTimeout(function(){e(".pc-tips").hide()},100)});e(".pc-tips").on("mouseenter",function(){clearTimeout(i)}).on("mouseleave",function(){e(this).hide()}).on("click",function(){ting.logger.log("click",{pos:"dl_qianqian",page:"panel",sub:ting.logger.getPage()})})}e(".clients-iphone").click(function(){var t=295;var i=e(".ios-tips");ting.loadChildImages(i,arguments.callee);i.css("display")==="none"?i.css("left",t).fadeIn():i.fadeOut();return false});e(".ios-tips .close").click(function(){e(".ios-tips").fadeOut();return false});e(".clients-iphone,.clients-pc,.clients-android,.clients-ipad",e("#download-clients")).bind("click",function(){ting.logger.plogClick(e(this).data("log").pos)})})(jQuery);require(["tmpl/common/pop_window/pop_cantPlay","tmpl/common/pop_window/pop_cantNoMv"],function(e,t){$(".music-main").append('<div id="pop-hui" class="pop-hui-dis"></div>');var i=$("#pop-hui"),a=null,n=null,l=null;init_mv=function(t){i.html(e({datamv:t}))};init_nomv=function(e){i.html(t())};romance=function(){i.removeClass("pop-hui-dis");if(a){init_mv(a)}else{init_nomv()}};$("body").on("click",".close-window-hook",function(){i.addClass("pop-hui-dis")});$("body").on("click",".song-message-gray .icon-play-disabled",function(){a=$(this).parent().parent().parent().find(".mv-icon").data("mv");romance()});$("body").on("click",".song-message-gray .icon-add-disabled",function(){a=$(this).parent().parent().parent().find(".mv-icon").data("mv");romance()});$("body").on("click",".song-message-gray .icon-download-disabled",function(){a=$(this).parent().parent().parent().find(".mv-icon").data("mv");romance()});$("body").on("click",".song-message-gray .icon-collects-disabled",function(){a=$(this).parent().parent().parent().find(".mv-icon").data("mv");romance()});$("body").on("click",".song-message-gray .icon-send-disabled",function(){a=$(this).parent().parent().parent().find(".mv-icon").data("mv");romance()});init_song_mv=function(t){i.html(e({datamv:t}))};init_song_nomv=function(e){i.html(t())};romance_song=function(){i.removeClass("pop-hui-dis");if(n){init_song_mv(l)}else{init_song_nomv()}};if($(".play-all-disabled").length){$("body").on("click",".song-opera .tool-btn-disabled",function(){n=$(this).parent().parent().parent().find(".mv-item-unic").data("mv");l=n;romance_song()});$("body").on("click",".song-opera .song-collect-disable",function(){n=$(this).parent().parent().parent().find(".mv-item-unic").data("mv");l=n;romance_song()});$("body").on("click",".song-opera .play-all-disabled",function(){n=$(this).parent().parent().parent().find(".mv-item-unic").data("mv");l=n;romance_song()})}$("body").on("click",".songn-info-box .gray",function(){var e=window.location.href.split("/");n=$(".song-img").data("mvid");l=e[0]+"//"+e[2]+"/playmv/"+n;romance_song();return});$("body").on("click",".songpage-fixed .gray",function(){var e=window.location.href.split("/");n=$(".song-img").data("mvid");l=e[0]+"//"+e[2]+"/playmv/"+n;romance_song()});$("body").on("click",".list-menu .gray",function(){var e=window.location.href.split("/");if($(this).data("hasmv")){n=$(this).data("songid")}else{n=null}l=e[0]+"//"+e[2]+"/mv/"+n;romance_song()})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/