define(["core/config","tmpl/common/face"],function(e,n){var t={baseEl:$("body"),btnEl:null,editEl:null,innerSelect:".face-tmpl",plugin:{faceList:".common-face-list",facePage:".face-"}};var i=function(e,n){e.options=$.extend(t,n);e.$base=e.options.baseEl;e.$btnEl=$(e.options.btnEl,e.$base);e.$faceEdit=$(e.options.editEl,e.$base);e.$faceInner=$(e.options.innerSelect,e.$base);if(!e.$faceInner||e.$faceInner.length==0){e.$faceInner=$('<div class="face-tmpl"></div>').appendTo(e.$base)}e.timeout=null;e.P=1,e.NP=1;c(e);f(e);s(e)},o=function(e){e.$faceInner.show()},a=function(e){e.$faceInner.hide()},c=function(e){clearTimeout(e.timeout)},f=function(e){var n=function(n){$(e.options.plugin.faceList,e.$faceInner).hide();e.NP=n;$(e.options.plugin.facePage+n,e.$faceInner).show();$(".npage-hook",e.$faceInner).html(n)};$(document).on("mousedown",function(){e.timeout=setTimeout(function(){a(e)},200)});e.$faceInner.on("click",".common-face-page .left",function(){var t=e.NP-1;if(t>0){n(t)}}).on("click",".common-face-page .right",function(){var t=e.NP+1;if(t<=e.P){n(t)}}).on("click",".common-face-list a",function(){var n=$(this).data("face");e.$faceEdit.iAddField(n);e.$faceEdit.trigger("select:face",n);a(e);return false}).on("mousedown",function(){c(e);return false})},s=function(t){var i=32,o=e.cfg.emoji;list=o.index.slice(1,o.index.length),$el=t.$btnEl,t.P=Math.ceil(list.length/i),t.NP=1;var a={reverseConf:o.reverse,imageConf:o.image,pageList:[],page:t.P,npage:t.NP};for(var c=0;c<t.P;c++){var f=c*i,s=(c+1)*i;a.pageList[c]={list:list.slice(f,s)}}t.$faceInner.html(n(a));var l=71,r=0;if(t.$base.css("position")=="absolute"||t.$base.css("position")=="fixed"){r=r+t.$base.offset().top;l=l+t.$base.offset().left}t.$faceInner.addClass("common-face").css({top:$el.offset().top+$el.innerHeight()-r+"px",left:$el.offset().left+$el.innerWidth()-l+"px"})};return{init:function(e){var n={};i(n,e);return n},show:function(e,n){if(n&&(!e||!e.$base)){e=this.init(n)}o(e);return e},clear:function(e){if(e){c(e)}}}});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/