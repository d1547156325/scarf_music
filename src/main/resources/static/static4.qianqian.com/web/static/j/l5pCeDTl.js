require(["core/utils","muplayer/bmPlayer","tmpl/huodong/dfrc/sign","page/huodong/dfrc/uploadFile","widget/toast/toast","domain_config"],function(e,a,t,i,n,s){var l=$("#signTmpl");var o=window.player=new a({baseDir:"/static/js/plugin/muplayer",loggerArgs:{data:{pid:"304",ref:"musicweb",from:"web"},api:"web"}});var r=function(){i.multiImg({baseEl:$(".img-upload"),hookEl:$(".img-upload-hook")});i.onlyMp3({baseEl:$("#songShow"),hookEl:$(".song-upload-hook")})};var c=function(e,a,t){e=$.extend({name:"",str:"字段"},e);var i=$("#"+e.name).val(),n=$("."+e.name+"-error"),s=true;for(var l=0;l<a.length;l++){var o=a[l];switch(o){case"empty":if($.trim(i)===""){n.html(e.str+"不能为空").show();s=false}break;case"size":if(i.lengh>t.size){n.html(e.str+"超过长度").show();s=false}break;case"phone":var r=new RegExp(/^1[34578]\d{9}$/);if(!i.match(r)){n.html(e.str+"不合法").show();s=false}break;case"code":var c=new RegExp(/^[0-9]{6}$/);if(!i.match(c)){n.html(e.str+"不合法").show();s=false}break;case"rule":var d=$("#"+e.name);if(!d.is(":checked")){n.html("请阅读"+e.str);s=false}break}if(!s){break}}if(s){n.hide()}return{value:i,flag:s}};var d=function(){l.html(t({data:{pic_list:[]},update:false}));r()},u=function(e){l.html(t({data:e||{},update:true}));r()};var f=nickName===""?false:true;if(f){var m={activity_id:activityId};var v=e.getQueryString();if(v.wensha){m=$.extend(m,{activity_id:v.activity_id,item_id:v.item_id})}e.tingApi("baidu.ting.active.getAGCUserInfo",m).done(function(e){e=e.result;var a=e.status;switch(a){case 0:u(e);break;case 1:window.location="http://static4.qianqian.com/hd/dfrc/person/"+e.item_id;break;case 2:u(e);break}}).fail(function(e){d()});bdShare({bdText:"我是"+nickName+"，快来助力我成为X-VOICE 次元偶像！不来打洗你哦",bdDesc:"大胆超越、天马行空！东风日产携手千千音乐共同举办突破次元·理想音乐第三季，X-VOICE 次元IDOL挑战赛火热报名中！",bdUrl:s.host+"/cms/webview/song_vote/dfrc/vote.html",bdPic:"../i/HkAtR26J.jpg"/*tpa=http://static4.qianqian.com/web/static/i/HkAtR26J.jpg*/})}else{ting.passport.login()}l.on("click",".vcode-hook",function(a){var t=c({name:"telPhone",str:"手机号"},["empty","phone"]);if(!t.flag){return}var i=$(this);e.tingApi("baidu.ting.sms.sendVerifyCode",{product:"music",tid:"smsTpl:4e76bf91-fa2f-4f34-a670-5e3a387fe122",receiver:e.base64Encode(t.value),num:6}).always(function(){var e=null,a=60;i.hide();i.after('<span class="code-btn code-wait">重发 '+a+"s</span>");var t=i.next(".code-wait");e=setInterval(function(){a--;if(a<=0){clearInterval(e);i.show();t.remove()}else{t.html("重发 "+a+"s")}},1e3)})}).on("click",".play-hook",function(e){var a=$(this);if(a.hasClass("pause-btn")){o.pause()}else{var t=a.data("songid");if(o.getCur()==t){o.play()}else{o.setCur(t).play()}}o.off().on("playing",function(){a.addClass("pause-btn")}).on("pause",function(){a.removeClass("pause-btn")})}).on("click",".add-hook, .update-hook",function(a){var t=$(this),i=t.hasClass("update-hook");var s=c({name:"itemId",str:"编号"},i?["empty"]:[]),l=c({name:"realName",str:"姓名"},["empty"]),o=c({name:"telPhone",str:"手机号"},["empty","phone"]),r=c({name:"yCode",str:"验证码"},i?[]:["empty","code"]),d=c({name:"schoolName",str:"学校"},[]),u=c({name:"title",str:"作品名称"},["empty"]),f=c({name:"songId",str:"作品"},["empty"]),m=c({name:"songLink",str:"作品"},f.flag?[]:["empty"]),v=c({name:"desc",str:"个人介绍"},[]),h=c({name:"rule",str:"协议"},["rule"]);var p=[];$(".img-upload ul li").each(function(){var e=$(this).data("file");if(e){p.push(e)}});if(p.length===0){$(".picList-error").html("*请上传照片");return}if(!s.flag||!l.flag||!o.flag||!r.flag||!d.flag||!u.flag||!m.flag||!v.flag||!h.flag){return}var g={dbid:s.value,real_name:l.value,tel_phone:o.value,school_name:d.value,pic_list:p.join(","),title:u.value,desc:v.value,code:r.value,activity_id:activityId};if(i&&f.flag){g=$.extend(g,{song_id:f.value})}else{g=$.extend(g,{song_link:m.value,song_md5:$("#songMD5").val(),file_size:$("#fileSize").val()})}var b=e.getQueryString();if(b.wensha){g=$.extend(g,{activity_id:b.activity_id,baidu_id:b.baidu_id,area_id:b.area_id})}e.tingApi(i?"baidu.ting.active.updateActivity":"baidu.ting.active.joinActivity",g,{type:"POST",dataType:"json"}).done(function(e){n.show({data:{cls:"succ",text:"报名成功"},callback:function(){window.location.reload()}})}).fail(function(e){n.show({data:{cls:"fail",text:"报名失败"+(e.result?","+e.result:"")}})})}).on("click",".rule-hook",function(e){var a=$(".index-rule");a.find(".rule-text").show();a.off().on("click",".close",function(e){a.find(".rule-text").hide()})})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/