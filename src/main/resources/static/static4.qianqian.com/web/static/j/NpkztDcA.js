define(["core/utils","page/dynamic/dynamic_tpl","page/dynamic/publish"],function(i,t,s){var o=$(".discuss"),a=$(".loading-dynamic"),n=$(".discuss-info"),l=$(".topic-dynamic-title"),c=0,e=0,d=function(){},r=0,u="";var m={dataUrl:"baidu.ting.ugctopic.getDetail",$dynamicBox:$(".discuss-list-new"),dyData:{},insertTop:false,page:"discussDetail",showDomCallBack:function(){},loadHotDynamic:false,getDyListParam:{topicid:n.data("topicid")||0,offset:0,size:10}};getDyData=function(){$(window).unbind("scroll");a.show();$(".discuss-list-nodata").hide().html("");i.tingApi(m.dataUrl,m.getDyListParam).done(function(i){m.showDomCallBack=function(){$(".dynamic-topic-name-btn").attr("target","").click(function(){window.location.reload()});$(".dynamic").removeClass("dynamic-border-none");$(".discuss-list-new .dynamic:last, .discuss-list-hot .dynamic:last").addClass("dynamic-border-none")};m.moudleName="";if(i.topic_list_new&&i.topic_list_new.length>=1){$(".discuss-list-new, .discuss-list-new-title").show();m.$dynamicBox=$(".discuss-list-new");m.getDyListParam.offset=i.topic_list_new[i.topic_list_new.length-1].score;m.dyData=i.topic_list_new;m.moudleName="new";t.showDynamic(m)}else{$(".discuss-list-nodata").show().html("没有更多动态了")}if(i.topic_list_hot&&i.topic_list_hot.length>=1&&!m.loadHotDynamic){$(".discuss-list-hot, .discuss-list-hot-title").show();m.loadHotDynamic=true;m.dyData=i.topic_list_hot;m.$dynamicBox=$(".discuss-list-hot");m.moudleName="hot";t.showDynamic(m)}a.hide();$(window).bind("scroll",d)}).fail(function(){$(".discuss-list-nodata").show().html("没有动态信息！");a.addClass("loading-hide")})},_scrollTop=0,d=function(){totalheight=parseFloat($(window).height())+parseFloat($(window).scrollTop());if(parseFloat($(window).scrollTop())<=_scrollTop){_scrollTop=parseFloat($(window).scrollTop());return false}_scrollTop=parseFloat($(window).scrollTop());if($(document).height()-150<=totalheight){getDyData()}};s.init({baseEl:$(".music-body"),apiParam:{source_id:m.getDyListParam.topicid,source_type:6},callback:function(i){if(i){var s=[i];m.dyData=s;m.insertTop=true;m.$dynamicBox=$(".discuss-list-new");t.showDynamic(m);m.insertTop=false}}});$("#editDynamic").on("click",function(){ting.passport.checkLogin(function(){s.show()})});getDyData()});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/