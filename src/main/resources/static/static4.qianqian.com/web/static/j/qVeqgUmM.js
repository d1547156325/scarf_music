require(["core/utils","tmpl/huodong/dfrc/progress","tmpl/huodong/dfrc/bang","tmpl/huodong/dfrc/listItem","page/huodong/dfrc/list","widget/toast/toast","domain_config"],function(i,t,e,a,n,o,c){var s=$(".index-rule");s.on("click",".rule-hook",function(i){s.find(".rule-text").show()}).on("click",".close",function(i){s.find(".rule-text").hide()});var l=$(".index-introd");l.on("click",".introd-hook",function(i){var t=$(this);if(t.hasClass("close-btn")){$(".content-wrap",l).removeClass("open-wrap");t.removeClass("close-btn")}else{$(".content-wrap",l).addClass("open-wrap");t.addClass("close-btn")}});var d=$("#progressTmpl");i.tingApi(["baidu.ting.active.getActTime"],{activity_id:activityId}).done(function(i){d.html(t({data:i.result}))});var r=$("#bangTmpl"),f=["new","week","all"],u={type:f[0],page:0,size:10,have_more:0,plugin:{week_id:0}};var v=function(t){t=t||0;i.tingApi("baidu.ting.active.getNewAGCList",{activity_id:activityId,offset:t,limit:u.size}).always(function(i){u=$.extend(u,{type:f[0],page:t>0?++u.page:1,have_more:i.have_more||0});if(t>0){b(i,t)}else{r.html(e({tab1:f[0],tab2:null,aid:activityId,list:i.result||[],offset:t,vote:i.has_vote||0}));n.init()}})},g=null,h=function(t,e){e=e||0;if(t){p(t,e)}else{i.tingApi("baidu.ting.active.getWeekAreaList",{activity_id:activityId}).done(function(i){g=i.result;h(g[0].sid,e)})}},p=function(t,a){a=a||0;i.tingApi("baidu.ting.active.getWeekBillList",{activity_id:activityId,week_id:t,offset:a,limit:u.size}).always(function(i){u=$.extend(u,{type:f[1],page:a>0?++u.page:1,have_more:i.have_more||0,plugin:{week_id:t}});if(a>0){b(i,a)}else{r.html(e({tab1:f[1],tab2:g,tab2_key:t,aid:activityId,list:i.result||[],offset:a,vote:i.has_vote||0}));n.init()}})},m=function(t){t=t||0;i.tingApi("baidu.ting.active.getTotalList",{activity_id:activityId,offset:t,limit:u.size}).always(function(i){u=$.extend(u,{type:f[2],page:t>0?++u.page:1,have_more:i.have_more||0});if(t>0){b(i,t)}else{r.html(e({tab1:f[2],tab2:null,aid:activityId,list:i.result||[],offset:t,vote:i.has_vote||0}));n.init()}})},b=function(i,t){t=t||0;$(".ws-list table",r).append(a({aid:activityId,list:i.result||[],offset:t}))};r.on("search",function(t){var e=r.find("#search").val();if($.trim(e)!==""&&e!=="搜索选手编号"){i.tingApi("baidu.ting.active.searchAGC",{activity_id:activityId,item_id:e}).done(function(i){i=i.result;window.location="http://static4.qianqian.com/hd/dfrc/person/"+i.item_id}).fail(function(){o.show({data:{cls:"fail",text:"未搜索到该选手"}})})}}).on("click",".search-hook",function(i){r.trigger("search")});r.on("click",".new-hook",function(i){v()}).on("click",".week-hook",function(i){h()}).on("click",".all-hook",function(i){m()}).on("click",".area-hook",function(i){var t=$(this).data("sid");h(t)});if(r.length>0){var k=null;$(window).on("scroll",function(){var i=$(this);clearTimeout(k);if(!u.have_more){return}k=setTimeout(function(){if($("body").scrollTop()+i.height()>=$("body").height()){switch(u.type){case f[0]:v(u.page*u.size);break;case f[1]:p(u.plugin.week_id,u.page*u.size);break;case f[2]:m(u.page*u.size);break}}},500)});v(0)}bdShare({bdText:"新鲜出炉的次元偶像都在这儿，等你来承包，宅着也能投。",bdDesc:"大胆超越、天马行空！东风日产携手千千音乐共同举办突破次元·理想音乐第三季，X-VOICE 次元IDOL挑战赛火热报名中！",bdUrl:c.host+"/cms/webview/song_vote/dfrc/index.html",bdPic:"../i/HkAtR26J.jpg"/*tpa=http://static4.qianqian.com/web/static/i/HkAtR26J.jpg*/})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/