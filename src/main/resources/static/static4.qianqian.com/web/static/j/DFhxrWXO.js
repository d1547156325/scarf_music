!function i(t,s,n){function e(l,o){if(!s[l]){if(!t[l]){var r="function"==typeof require&&require;if(!o&&r)return r(l,!0);if(a)return a(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var d=s[l]={exports:{}};t[l][0].call(d.exports,function(i){var s=t[l][1][i];return e(s?s:i)},d,d.exports,i,t,s,n)}return s[l].exports}for(var a="function"==typeof require&&require,l=0;l<n.length;l++)e(n[l]);return e}({1:[function(i,t,s){var n,e,a=function(i,t){function s(){this.constructor=i}for(var n in t)l.call(t,n)&&(i[n]=t[n]);return s.prototype=t.prototype,i.prototype=new s,i.__super__=t.prototype,i},l={}.hasOwnProperty;e=function(i,t){return i.replace(/<%-\s*([\s\S]+?)\s*%>/g,function(i,s){var n;return null!=(n=dom.util.getValue(t,s))?n.replace(/<[^>]+?>/g,""):void 0})},n=function(i){var t,s,n,e,a;$(".editor-music-modal").remove(),t=$('<div class="editor-music-modal '+(i.className||"")+'">\n    <div class="btn-close"></div>\n    <div class="header"><span>'+i.title+"</span></div>\n    "+i.content+'\n    <div class="footer"></div>\n</div>'),t.on("click",".btn-close",function(){return t.remove()}),e=i.events;for(s in e)a=e[s],n=s.split(" "),t.on(n[0],n[1],a);return t},BME.tool.ToolMusic=function(i){function t(i){var t,s;$.extend(this,i),s=this,t=this.owner_editor,this.className="tool-"+this.name,t.once("ready:"+this.owner_toolbar.id,function(i){return function(){return i.$el=$("#"+i.owner_toolbar.id+" ."+i.className),i.bindEvent()}}(this))}return a(t,i),t.prototype.template=function(i){return"<"+i+' class="tool '+this.className+'">\n    <i class="music-icon music-icon-'+this.icon+'"></i><span>'+this.content+"</span>\n</"+i+">"},t.prototype.bindEvent=function(){var i,t;return t=this,i=t.owner_editor,this.$el.on("click",function(){var i,s,a,l,o,r,c,d,v,u;switch(t.type){case"search":c=1,r=1,l="",o="",u={},d=function(i,t){var n;if(t)return n='<i class="prev-page"></i>\n<span>第'+i+'页</span><span class="sep">/</span><span>共'+t+'页</span>\n<i class="next-page"></i>',s.html(n)},v=function(s,n,a){var o;return null==a&&(a=6),(o=i.find(".page-"+n)).length?(i.find(".page.show").removeClass("show"),o.addClass("show"),d(n,r)):$.ajax({url:""+t.url+s+"&page_no="+n+"&page_size="+a,dataType:"jsonp"}).then(function(o){var c,v,p,m,g,_,f,h;if(s===l){for(i.find(".page.show").removeClass("show"),_=dom.util.getValue(o,t.list_key)||[],u[n]=_,h='<ul class="page page-'+n+'">',f=dom.util.getValue(o,t.total_key),r=Math.ceil(f/a),v=c=0,g=_.length;c<g;v=++c)p=_[v],m=e(t.list_tmpl,p),h+='<li class="list-item'+(v===a-1?" last-child":"")+'">'+m+"</li>";return h+="</ul>",i.append(h),i.find(".page-"+n).addClass("show"),d(n,r)}})},a=n({className:"modal-search",title:"插入"+t.content,content:'<div class="search"><div class="input"><input type="text" placeholder="搜索'+(t.content||"")+'"></div></div>\n<div class="content"></div>',events:{"keyup input":function(){return(l=$(this).val())?l!==o&&(c=1,i.html(""),s.html(""),u={},v(l,c)):(i.html(""),s.html("")),o=l},"click .prev-page":function(){return--c<1&&(c=1),v(l,c)},"click .next-page":function(){return++c>r&&(c=r),v(l,c)},"click .list-item":function(){var i,s,n,e,l;return s=$(this),i=s.closest(".page"),l=i[0].className.match(/page-(\d+)/)[1],e=dom.util.getIndex(s[0]),n=u[l][e],t.insert(n),a.remove()}}})}return i=a.find(".content"),s=a.find(".footer"),$(document.body).append(a)})},t.prototype.insert=function(i){var t,s;return t=e(this.insertTmpl,i),s=editor.execCommand("insertUneditableBlock",t),$(s).find("a").on("click",function(i){return!1}),"function"==typeof this.afterInsert?this.afterInsert(s):void 0},t}(BME.ui.UIBase)},{}],2:[function(i,t,s){BME.tool.song={type:"search",icon:"song",content:"单曲",title:"插入单曲",placeholder:"搜索单曲",url:location.protocol+"//musicapi.qianqian.com/v1/restserver/ting?method=baidu.ting.search.merge&type=0&query=",total_key:"result.song_info.total",list_key:"result.song_info.song_list",list_tmpl:'<div class="song" data-song_id="<%- song_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- pic_small %>)"></div></div>\n    <div class="info">\n        <div class="title"><%- title %></div>\n        <div class="author"><%- author %></div>\n    </div>\n</div>',insertTmpl:'<div class="music-item song" data-song_id="<%- song_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- pic_small %>)"></div></div>\n    <div class="info">\n         <div class="title"><%- title %></div>\n        <div class="author"><%- author %></div>\n    </div>\n    <div class="btn-play"></div>\n</div>'},BME.tool.album={type:"search",icon:"album",content:"专辑",url:location.protocol+"//musicapi.qianqian.com/v1/restserver/ting?method=baidu.ting.search.merge&type=2&query=",total_key:"result.album_info.total",list_key:"result.album_info.album_list",list_tmpl:'<div class="album" data-album_id="<%- album_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- pic_small %>)"></div></div>\n    <div class="info">\n        <div class="title"><%- title %></div>\n        <div class="author"><%- author %></div>\n    </div>\n</div>',insertTmpl:'<div class="music-item album" data-album_id="<%- album_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- pic_small %>)"></div></div>\n    <div class="info">\n         <div class="title"><%- title %></div>\n        <div class="author"><%- author %></div>\n    </div>\n    <div class="btn-play"></div>\n</div>'},BME.tool.songlist={type:"search",icon:"songlist",content:"歌单",url:location.protocol+"//musicapi.qianqian.com/v1/restserver/ting?method=baidu.ting.search.merge&isNew=1&type=10&query=",total_key:"result.playlist_info.total",list_key:"result.playlist_info.play_list",list_tmpl:'<div class="songlist" data-songlist_id="<%- diy_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- diy_pic %>)"></div></div>\n    <div class="info">\n        <div class="title"><%- diy_title %></div>\n        <div class="author"><%- userinfo.username %></div>\n    </div>\n</div>',insertTmpl:'<div class="music-item songlist" data-songlist_id="<%- diy_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- diy_pic %>)"></div></div>\n    <div class="info">\n         <div class="title">歌单 | <%- diy_title %></div>\n        <div class="author"><%- userinfo.username %></div>\n    </div>\n    <div class="btn-play"></div>\n</div>'},BME.tool.artist={type:"search",icon:"artist",content:"歌手",url:location.protocol+"//musicapi.qianqian.com/v1/restserver/ting?method=baidu.ting.search.merge&type=1&query=",total_key:"result.artist_info.total",list_key:"result.artist_info.artist_list",list_tmpl:'<div class="artist" data-artist_id="<%- artist_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- avatar_middle %>)"></div></div>\n    <div class="info">\n        <div class="title"><%- author %></div>\n    </div>\n</div>',insertTmpl:'<div class="music-item artist" data-artist_id="<%- artist_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- avatar_middle %>)"></div></div>\n    <div class="info">\n         <div class="title"><%- author %></div>\n    </div>\n</div>'},BME.tool.topic={type:"search",icon:"topic",content:"话题",url:location.protocol+"//musicapi.qianqian.com/v1/restserver/ting?method=baidu.ting.search.merge&type=12&isNew=1&query=",total_key:"result.topic_info.total",list_key:"result.topic_info.topic_list",list_tmpl:'<div class="topic" data-topic_id="<%- topic_id %>">\n    <div class="cover"><div class=\'img\' style="background-image: url(<%- min_pic %>)"></div></div>\n    <div class="info">\n        <div class="title">#&nbsp;<%- topic_title %></div>\n    </div>\n</div>',insertTmpl:'<div class="music-item topic" data-topic_id="<%- topic_id %>" style="background-image: url(<%- min_pic %>)">\n    <div class="title"><%- topic_title %></div>\n    <div class="nums"><%- nums %>人参加</div>\n    <a href="/discuss/detail/<%- topic_id %>">立即参与</a>\n</div>'}},{}],3:[function(i,t,s){i("./ToolMusic"),i("./music")},{"./ToolMusic":1,"./music":2}]},{},[3]);

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/