require(["core/utils","tmpl/rank/redrank/loadmoreZjList","tmpl/rank/redrank/zjfanschange","tmpl/rank/redrank/zhuanjifanschangeleft","tmpl/rank/redrank/zjfansbangdetail","tmpl/rank/redrank/zjfansbang","tmpl/rank/redrank/dayweektotal","tmpl/rank/redrank/zjlist","widget/toast/toast","page/rank/redrank/common"],function(i,s,a,n,e,t,l,o,r){var g=$(".zjlistTmpl");var d=$("#fensibang");var v=0;g.on("click",".icon-img",function(i){F=$(this).data("id");c.albumid=F;M(v,F);d.find(".fensibang").show()});d.click(".fensibang-hid",function(i){if($(i.target).hasClass("fensibang-hid")){d.find(".fensibang").hide();O=0}});var h=$("#zjlistTmpl"),u=$("#bang-wrapper"),f=["today","week","month"],b=["today"],m=["ubang","zhuanjibang","fuhaobang"],c={type:f[0],page:0,size:20,have_more:0,albumid:F,plugin:{week_id:0}};var p,C,w,q,k,_,y,z,A,j,x,F,S,T,B,U;if($(".ubang").hasClass("bang-visit")){nowbang=m[0]}if($(".zhuanjibang").hasClass("bang-visit")){nowbang=m[1]}if($(".fuhaobang").hasClass("bang-visit")){nowbang=m[2]}var u=$("#bang-wrapper");u.on("click",".icon-date",function(i){$(".qishu-content").removeClass("qishu-visit");U=u.find(".date-content").data("id");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit");u.find(".qishu").show()}).on("click",".qishu-btn",function(i){u.find(".qishu").hide()});u.on("click",".qishu",function(i){$(".qishu-content").removeClass("qishu-visit");$(i.target).addClass("qishu-visit");$(".qishu-btn").removeClass("qishu-visit")});var u=$("#bang-wrapper");var P=$(".zhuanjibang");var D=$(".fuhaobang");var I=$(".ubang");if(P.hasClass("bang-visit")){f[2]="month"}u.html(l({bill:c.type,bang:nowbang}));u.on("click",".d-bang",function(i){var s=0;$(".bang").removeClass("visit");$(this).addClass("visit");u.find(".date").show();b=f[0];J(s,w);if(P.hasClass("bang-visit")){ting.logger.log("illclick",{page:"专辑榜",sub:"日排行榜",pos:""})}}).on("click",".wk-bang",function(i){var s=0;$(".bang").removeClass("visit");$(this).addClass("visit");u.find(".date").show();b=f[1];H(s,p);if(P.hasClass("bang-visit")){ting.logger.log("illclick",{page:"专辑榜",sub:"周排行榜",pos:""})}}).on("click",".m-bang",function(i){var s=0;$(".bang").removeClass("visit");$(this).addClass("visit");b=f[2];K(s,k);if(P.hasClass("bang-visit")){ting.logger.log("illclick",{page:"专辑榜",sub:"月排行榜",pos:""})}});u.on("click",".icon-left",function(i){if($(".d-bang").hasClass("visit")){if(w>1){w=w-1;if(b==f[0]){A=w;J(y,w)}}}if($(".wk-bang").hasClass("visit")){if(p>1){p=p-1;if(b==f[1]){j=p;H(y,p)}}}if($(".m-bang").hasClass("visit")){if(k>1){k=k-1;if(b==f[2]){x=k;K(y,k)}}}});u.on("click",".icon-right",function(i){if($(".d-bang").hasClass("visit")){if(w<q){w=w+1;if(b==f[0]){z=w;A=w;J(y,w)}}}if($(".wk-bang").hasClass("visit")){if(p<C){p=p+1;if(b==f[1]){z=p;j=p;H(y,p)}}}if($(".m-bang").hasClass("visit")){if(k<_){k=k+1;if(b==f[2]){x=k;K(y,k)}}}});var u=$("#bang-wrapper");u.on("click",".icon-date",function(i){u.find(".qishu").show()}).on("click",".qishu-btn",function(i){u.find(".qishu").hide();if(u.find(".d-bang").hasClass("visit")){A=U}if(u.find(".wk-bang").hasClass("visit")){j=U}if(u.find(".m-bang").hasClass("visit")){x=U}});u.on("click",".qishu",function(i){if($(i.target).hasClass("qishu-wrapper")||$(i.target).hasClass("qishu")||$(i.target).hasClass("qishu-btn")){U=u.find(".date-content").data("id");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit");$(".qishu-wrapper").removeClass("qishu-visit");$(".qishu-btn").removeClass("qishu-visit")}else{$(".qishu-content").removeClass("qishu-visit");$(i.target).addClass("qishu-visit");$(".qishu-btn").removeClass("qishu-visit");$(".qishu-wrapper").removeClass("qishu-visit");U=$(".qishu-wrapper").find(".qishu-visit").data("id");if(u.find(".d-bang").hasClass("visit")){A=U;w=U;J(y,U)}if(u.find(".wk-bang").hasClass("visit")){j=U;p=U;H(y,U)}if(u.find(".m-bang").hasClass("visit")){x=U;k=U;K(y,U)}u.find(".qishu").hide()}});var L=function(s,a){i.tingApi("baidu.ting.active.getPeriod",a).done(function(i){A=i.result.today_nums||0;j=i.result.week_nums||0;x=i.result.total_month||0;S=i.result.today_nums||0;T=i.result.week_nums||0;B=i.result.total_month||0})};L();var Z=function(s,a){i.tingApi("baidu.ting.active.getPeriod",a).done(function(i){S=i.result.today_nums||0;T=i.result.week_nums||0;B=i.result.total_month||0})};var E;var G=function(s,a){Z();if(P.hasClass("bang-visit")){ting.logger.log("illclick",{page:"专辑榜",sub:"日排行榜",pos:""})}y=s||0;z=a||0;var a={bill_type:f[0],offset:y,limit:c.size,period:z};i.tingApi("baidu.ting.active.getAlbumBill",a).done(function(i){c=$.extend(c,{type:f[0],page:y>0?++c.page:1,have_more:i.have_more||0});h.html(o({zjlist:i.result||[],type:f,loadmore:c.have_more,r:i}));u.html(l({bill:f,nums:A||0,allnums:S,bang:nowbang}));$(window).bind("scroll",windowScroll);$(".bang").removeClass("visit");$(".d-bang").addClass("visit");$(".qishu-content:last").addClass("qishu-visit");p=j;C=T;w=A;q=S;k=x;_=B;E=i.result||[]}).fail(function(i){if(i.error_code==22001){Z();h.html(o({r:i}));u.html(l({bill:f[0],nums:A,allnums:S,bang:nowbang}));$(".qishu-content").removeClass("qishu-visit");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit")}})};G();var H=function(s,a){Z();y=s||0;z=a||0;var a={bill_type:f[1],offset:y,limit:c.size,period:z};i.tingApi("baidu.ting.active.getAlbumBill",a).done(function(i){c=$.extend(c,{type:f,page:y>0?++c.page:1,have_more:i.have_more||0});h.html(o({zjlist:i.result||[],type:f,loadmore:c.have_more,r:i}));u.html(l({bill:c.type,nums:j||0,allnums:T,bang:nowbang}));$(window).bind("scroll",windowScroll);$(".qishu-content:eq("+(j-1)+")").addClass("qishu-visit");if(b==f[0]){$(".bang").removeClass("visit");$(".d-bang").addClass("visit")}if(b==f[1]){$(".bang").removeClass("visit");$(".wk-bang").addClass("visit")}if(b==f[2]){$(".bang").removeClass("visit");$(".m-bang").addClass("visit")}if(b==f[2]){$(".bang").removeClass("visit");$(".all-bang").addClass("visit")}p=j;C=T;w=A;q=S;k=x;_=B}).fail(function(i){Z();if(i.error_code==22001){h.html(o({r:i}));u.html(l({bill:f[1],nums:j,allnums:T,bang:nowbang}));$(".qishu-content").removeClass("qishu-visit");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit");$(".bang").removeClass("visit");$(".wk-bang").addClass("visit")}})};var J=function(s,a){Z();y=s||0;z=a||0;var a={bill_type:f[0],offset:y,limit:c.size,period:z};i.tingApi("baidu.ting.active.getAlbumBill",a).done(function(i){c=$.extend(c,{type:f,page:y>0?++c.page:1,have_more:i.have_more||0});h.html(o({zjlist:i.result||[],type:f,loadmore:c.have_more,r:i}));u.html(l({bill:c.type,nums:A||0,allnums:S,bang:nowbang}));$(window).bind("scroll",windowScroll);$(".qishu-content:eq("+(A-1)+")").addClass("qishu-visit");if(b==f[0]){$(".bang").removeClass("visit");$(".d-bang").addClass("visit")}if(b==f[1]){$(".bang").removeClass("visit");$(".wk-bang").addClass("visit")}if(b==f[2]){$(".bang").removeClass("visit");$(".m-bang").addClass("visit")}if(b==f[2]){$(".bang").removeClass("visit");$(".all-bang").addClass("visit")}}).fail(function(i){Z();if(i.error_code==22001){h.html(o({r:i}));u.html(l({bill:f[0],nums:A,allnums:S,bang:nowbang}));$(".qishu-content").removeClass("qishu-visit");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit")}})};var K=function(s,a){Z();y=s||0;z=a||0;var a={bill_type:f[2],offset:y,limit:c.size,period:z};i.tingApi("baidu.ting.active.getAlbumBill",a).done(function(i){c=$.extend(c,{type:f,page:y>0?++c.page:1,have_more:i.have_more||0});h.html(o({zjlist:i.result||[],type:f,loadmore:c.have_more,r:i}));u.html(l({bill:c.type,nums:x||0,allnums:B,bang:nowbang}));$(window).bind("scroll",windowScroll);$(".qishu-content:eq("+(x-1)+")").addClass("qishu-visit");$(".bang").removeClass("visit");$(".m-bang").addClass("visit")}).fail(function(i){Z();if(i.error_code==22001){h.html(o({r:i}));u.html(l({bill:f[0],nums:A,allnums:B,bang:nowbang}));$(".qishu-content").removeClass("qishu-visit");$(".qishu-content:eq("+(U-1)+")").addClass("qishu-visit")}})};var M=function(s,a){s=s||0;var n=$(".date-content").data("id")||0;var e,l;if(u.find(".d-bang").hasClass("visit")){e=f[0];i:w}else if(u.find(".wk-bang").hasClass("visit")){e=f[1];i:p}else{e=f[2];i:k}var o={album_id:a,offset:s,period:n,bill_type:e,limit:c.size};i.tingApi("baidu.ting.active.getAlbumFans",o).done(function(i){c=$.extend(c,{type:f[0],page:s>0?++c.page:1,have_more:i.have_more||0});d.html(t({fens:i.result||[]}));N()})};var N=function(s){var a=$("#fensi-details");s=s||0;var n=$(".date-content").data("id")||0;var t,l;if(u.find(".d-bang").hasClass("visit")){t=f[0];i:w}else if(u.find(".wk-bang").hasClass("visit")){t=f[1];i:p}else{t=f[2];i:k}var o={album_id:F,offset:s,period:n,bill_type:t,limit:12};i.tingApi("baidu.ting.active.getAlbumFans",o).done(function(i){c=$.extend(c,{type:f[0],page:s>0?++c.page:1,have_more:i.have_more||0});a.html(e({fens:i.result||[]}))})};var O=0;var Q=function(s){var n=$("#fensi-details");s=s||0;var e=$(".date-content").data("id")||0;var t,l;if(u.find(".d-bang").hasClass("visit")){t=f[0];i:w}else if(u.find(".wk-bang").hasClass("visit")){t=f[1];i:p}else{t=f[2];i:k}var o={album_id:F,offset:s,period:e,bill_type:t,limit:9};i.tingApi("baidu.ting.active.getAlbumFans",o).done(function(i){c=$.extend(c,{type:f[0],page:s>0?++c.page:1,have_more:i.have_more||0});n.html(a({fens:i.result||[],offset:O}))})};var R=function(s){var a=$("#fensi-details");s=s||0;var e=$(".date-content").data("id")||0;var t,l;if(u.find(".d-bang").hasClass("visit")){t=f[0];i:w}else if(u.find(".wk-bang").hasClass("visit")){t=f[1];i:p}else{t=f[2];i:k}var o={album_id:F,offset:s,period:e,bill_type:t,limit:12};i.tingApi("baidu.ting.active.getAlbumFans",o).done(function(i){c=$.extend(c,{type:f[0],page:s>0?++c.page:1,have_more:i.have_more||0});a.html(n({fens:i.result||[],offset:O}))})};$(".fensi-left").live("click",function(i){if(O>0){O=O-9;Q(O)}if(O==0){R(O)}});$(".fensi-right").live("click",function(i){if(c.have_more!==0){O=O+9;Q(O)}});var V=0;windowScroll=function(){var i=parseFloat($(window).scrollTop());var s=parseFloat($(window).height())+i;if(parseFloat($(window).scrollTop())<=V){V=parseFloat($(window).scrollTop());return false}V=parseFloat($(window).scrollTop());if($(document).height()-150<=s){$(window).unbind("scroll");if(c.have_more){tabDataInit=false;y=y+20;W()}else{}}};$(window).bind("scroll",windowScroll);var W=function(){var a,n;if(u.find(".d-bang").hasClass("visit")){a=f[0];i:w}else if(u.find(".wk-bang").hasClass("visit")){a=f[1];i:p}else{a=f[2];i:k}var e=$(".date");var t=e.find(".date-content").data("id");var l={bill_type:a,offset:y,limit:c.size,period:t};i.tingApi("baidu.ting.active.getAlbumBill",l).done(function(i){c=$.extend(c,{page:y>0?++c.page:1,have_more:i.have_more||0});var a=$(".zj-bang");a.append(s({zjlist:i.result||[],type:f,offset:y,loadmore:c.have_more}))})};bdShare({bdText:"千千音乐u榜，寻找属于你的专辑！",bdDesc:"千千音乐u榜，寻找属于你的专辑！",bdUrl:"http://music.taihe.com/cms/webview/celebrity_list/v1/#/zj",bdPic:"../../../../music.taihe.com/static/images/page/rank/redrank/wh_share.jpg"/*tpa=http://music.taihe.com/static/images/page/rank/redrank/wh_share.jpg*/});$(".share-list").on("click",function(){if(I.hasClass("bang-visit")){if($(".d-bang").hasClass("visit")){ting.logger.log("share",{page:"U榜",sub:"日排行榜",pos:""})}if($(".wk-bang").hasClass("visit")){ting.logger.log("share",{page:"U榜",sub:"周排行榜",pos:""})}if($(".m-bang").hasClass("visit")){ting.logger.log("share",{page:"U榜",sub:"月排行榜",pos:""})}}if(P.hasClass("bang-visit")){if($(".d-bang").hasClass("visit")){ting.logger.log("share",{page:"专辑榜",sub:"日排行榜",pos:""})}if($(".wk-bang").hasClass("visit")){ting.logger.log("share",{page:"专辑榜",sub:"周排行榜",pos:""})}if($(".m-bang").hasClass("visit")){ting.logger.log("share",{page:"专辑榜",sub:"月排行榜",pos:""})}}if(D.hasClass("bang-visit")){if($(".d-bang").hasClass("visit")){ting.logger.log("share",{page:"富豪榜",sub:"日排行榜",pos:""})}if($(".wk-bang").hasClass("visit")){ting.logger.log("share",{page:"富豪榜",sub:"周排行榜",pos:""})}if($(".m-bang").hasClass("visit")){ting.logger.log("share",{page:"富豪榜",sub:"月排行榜",pos:""})}}})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/