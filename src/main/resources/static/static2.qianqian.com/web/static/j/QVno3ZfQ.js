require(["core/config","core/utils","widget/toast/toast","http://static2.qianqian.com/web/static/j/plugin/jquery.form","plugin/jquery.serializejson"],function(e,r,a){var i=$(".form-select"),n=i.find(".select-a"),t=i.find(".select-o");$version=i.find("#version");$(document).on("mousedown",function(e){t.hide()});n.on("mousedown",function(e){e.stopPropagation();var r=$version.val(),a=t.find(".opt_"+r);t.trigger("a:change",a);t.show()});$(".open_select_a").on("mousedown",function(e){e.stopPropagation();n.trigger("mousedown")});t.on("a:change",function(e,r){t.find("a.visited").removeClass("visited");r&&$(r).addClass("visited")}).on("mouseenter","a",function(e){t.trigger("a:change",this)}).on("mousedown","a",function(e){var r=$(this);var a=r.html(),i=r.data("opt");n.find("span").html(a);$version.val(i)});$(".form-input").on("input propertychange",function(e){var r=$(this),a=r.next(".form-placeholder");if(a&&a.length>0){var i=r.val(),n=i.length;if(n==0&&a.is(":hidden")){a.show()}else if(n>0&&!a.is(":hidden")){a.hide()}}});var o=$("#content"),s=o.siblings(".form-tip").eq(0);var l=500;o.on("input propertychange",function(e){var r=$(this);var a=r.val(),i=a.length,n=l-i;if(n<0){r.addClass("error");s.addClass("error")}else if(r.hasClass("error")){r.removeClass("error");s.removeClass("error")}s.html(n)});var f=$("#email");var u=50;f.on("input propertychange",function(e){var r=$(this);var a=r.val(),i=a.length,n=u-i;if(n<0){r.addClass("error")}else if(r.hasClass("error")){r.removeClass("error")}});var c=function(){if(o.hasClass("error")||f.hasClass("error")){return false}return true},d=function(){if($.trim(o.val())==""){o.addClass("error")}if($.trim(f.val())==""){f.addClass("error")}return true};var e=e.cfg.upImgApi,v="jpg|jpeg|png|gif",p=1*1048576;var h=function(e){var r=true,i=v.replace(/\W+/g,"|").replace(/^\W|\W$/g,""),n=new RegExp("\\.("+(i?i:"")+")$","gi");$.each(e,function(e,i){var t=i.name||i;if(!t.match(n)){r=false;a.show({data:{cls:"fail",text:"请选择图片文件"}});return}});return r},g=function(e){var r=true;$.each(e,function(e,i){var n=i.size;if(n>p){r=false;a.show({data:{cls:"fail",text:"图片大小超过1M"}});return}});return r};var m=$(".form-img .up-btn"),w=$(".form-img .img-preview");$fileurl=$("#fileurl");m.append('<form method="POST" enctype="multipart/form-data"> 						<input name="filePath[]" class="img-upload-hook" type="file" /> 					</form>');$(".img-upload-hook").change(function(r){var i=this,n=i.files||new Array(i.value);if(h(n)&&g(n)){$(i).closest("form").ajaxSubmit({url:e.url+"?restype=png&appid=feedback",type:"POST",dataType:"json",success:function(r){if(r&&r.code==e.code.SUCCESS){m.hide();w.find("img").attr("src",r.url);w.show();$fileurl.val(r.url)}$(i).val("").attr("value","")[0].value=""},error:function(e,r,n){a.show({data:{cls:"fail",text:"上传失败，请重试"}});$(i).val("").attr("value","")[0].value=""}})}});$(".img-preview").on("click",".del-btn",function(e){m.show();w.hide();$fileurl.val("")});$("#feedbackSubmit").on("click",function(e){if(d()&&c()){var i=$("#feedbackForm").serializeJSON();r.tingApi("http://static2.qianqian.com/web/static/j/baidu.ting.feedback.info",i,{type:"POST",dataType:"json"}).done(function(e){a.show({data:{cls:"succ",text:"提交成功，感谢您对千千音乐的支持"},callback:function(){window.location.reload()}})}).fail(function(){a.show({data:{cls:"fail",text:"提交失败，请稍后重试"}})})}})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/