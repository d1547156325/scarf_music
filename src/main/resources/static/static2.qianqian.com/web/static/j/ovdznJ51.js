require(["core/utils","muplayer/bmPlayer","tmpl/huodong/rl/sign","page/huodong/rl/uploadFile","widget/toast/toast","domain_config"],function(e,a,t,i,n,l){var s=$("#signTmpl");var o=window.player=new a({baseDir:"/static/js/plugin/muplayer",loggerArgs:{data:{pid:"304",ref:"musicweb",from:"web"},api:"web"}});var r=function(){i.multiImg({baseEl:$(".img-upload"),hookEl:$(".img-upload-hook")});i.onlyMp3({baseEl:$("#songShow"),hookEl:$(".song-upload-hook")})};var u=function(e,a,t){e=$.extend({name:"",str:"字段"},e);var i=$("#"+e.name).val(),n=$("."+e.name+"-error"),l=true;for(var s=0;s<a.length;s++){var o=a[s];switch(o){case"empty":if($.trim(i)===""){n.html(e.str+"不能为空").show();l=false}break;case"size":if(i.lengh>t.size){n.html(e.str+"超过长度").show();l=false}break;case"phone":var r=new RegExp(/^1[34578]\d{9}$/);if(!i.match(r)){n.html(e.str+"不合法").show();l=false}break;case"code":var u=new RegExp(/^[0-9]{6}$/);if(!i.match(u)){n.html(e.str+"不合法").show();l=false}break;case"rule":var c=$("#"+e.name);if(!c.is(":checked")){n.html("请阅读"+e.str);l=false}break}if(!l){break}}if(l){n.hide()}return{value:i,flag:l}};var c=function(){s.html(t({data:{sanwei:[],pic_list:[]},update:false}));r()},d=function(e){s.html(t({data:e||{},update:true}));r()};midPage=function(e){s.html(t({data:e||{},update:true}));r()};var f=nickName===""?false:true;if(f){var m={activity_id:activityId};var g=e.getQueryString();if(g.rl){m=$.extend(m,{activity_id:g.activity_id,item_id:g.item_id})}e.tingApi("baidu.ting.active.getAGCUserInfo",m).done(function(e){e=e.result;var a=e.status;switch(a){case 0:midPage(e);break;case 1:window.location="http://static2.qianqian.com/hd/rayligirls/person/"+e.item_id;break;case 2:d(e);break}}).fail(function(e){c()});bdShare({bdText:"我是"+nickName+"，我参加了“第十三届瑞丽模特大赛”，求助攻！",bdDesc:"瑞丽模特大赛千千音乐分赛区”重磅开启~让美丽的天使微笑在美好的年纪绽放！",bdUrl:l.host+"/cms/webview/rayligirls/index.html",bdPic:l.getStaticUrl({isProtocol:true})+"/web/static/i/bNQCXkyv.png"})}else{ting.passport.login()}s.on("click",".vcode-hook",function(a){var t=u({name:"telPhone",str:"手机号"},["empty","phone"]);if(!t.flag){return}var i=$(this);e.tingApi("baidu.ting.sms.sendVerifyCode",{product:"music",tid:"smsTpl:4e76bf91-fa2f-4f34-a670-5e3a387fe122",receiver:e.base64Encode(t.value),num:6}).always(function(){var e=null,a=60;i.hide();i.after('<span class="code-btn code-wait">重发 '+a+"s</span>");var t=i.next(".code-wait");e=setInterval(function(){a--;if(a<=0){clearInterval(e);i.show();t.remove()}else{t.html("重发 "+a+"s")}},1e3)})}).on("click",".play-hook",function(e){var a=$(this);if(a.hasClass("pause-btn")){o.pause()}else{var t=a.data("songid");if(o.getCur()==t){o.play()}else{o.setCur(t).play()}}o.off().on("playing",function(){a.addClass("pause-btn")}).on("pause",function(){a.removeClass("pause-btn")})}).on("click",".add-hook, .update-hook",function(a){var t=$(this),i=t.hasClass("update-hook");var l=u({name:"itemId",str:"编号"},i?["empty"]:[]),s=u({name:"realName",str:"姓名"},["empty"]),o=u({name:"realAge",str:"年龄"},["empty"]),r=u({name:"telPhone",str:"手机号"},["empty","phone"]),c=u({name:"yCode",str:"验证码"},i?[]:["empty","code"]),d=u({name:"schoolName",str:"学校"},[]),f=u({name:"shengao",str:"身高"},["empty"]),m=u({name:"tizhong",str:"体重"},["empty"]),g=u({name:"xiong",str:"胸"},["empty"]),v=u({name:"yao",str:"腰"},["empty"]),h=u({name:"tun",str:"臀"},["empty"]),p=u({name:"title",str:"作品名称"},["empty"]),y=u({name:"songId",str:"作品"},["empty"]),b=u({name:"songLink",str:"作品"},y.flag?[]:["empty"]),w=u({name:"desc",str:"个人介绍"},[]),k=u({name:"rule",str:"协议"},["rule"]);var _=[];$(".img-upload ul li").each(function(){var e=$(this).data("file");if(e){_.push(e)}});if(_.length===0){$(".picList-error").html("*请上传照片");return}if(!l.flag||!s.flag||!r.flag||!c.flag||!d.flag||!k.flag||!w.flag||!f.flag||!m.flag||!g.flag){return}var x={dbid:l.value,real_name:s.value,tel_phone:r.value,school_name:d.value||null,pic_list:_.join(","),title:p.value,desc:w.value,code:c.value,activity_id:activityId,shengao:f.value,tizhong:m.value,xiongwei:g.value,yaowei:v.value,tunwei:h.value,age:o.value,song_link:b.value};if(i&&y.flag){x=$.extend(x,{song_id:y.value})}else{x=$.extend(x,{song_link:b.value,song_md5:$("#songMD5").val(),file_size:$("#fileSize").val()})}var C=e.getQueryString();if(C.rl){x=$.extend(x,{activity_id:C.activity_id,baidu_id:C.baidu_id,area_id:C.area_id})}e.tingApi(i?"baidu.ting.active.updateActivity":"baidu.ting.active.joinActivity",x,{}).done(function(e){n.show({data:{cls:"succ",text:"报名成功"},callback:function(){window.location.reload()}})}).fail(function(e){n.show({data:{cls:"fail",text:"报名失败"+(e.result?","+e.result:"")}})})}).on("click",".rule-hook",function(e){var a=$(".index-rule");a.find(".rule-text").show();a.off().on("click",".close",function(e){a.find(".rule-text").hide()})})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/