var lib=lib||{};lib.swf=lib.swf||{};(function(i){var e=null;i.widget("http://static2.qianqian.com/web/static/j/ui.mv",{options:{width:"100%",height:"100%",chainDataElem:null,data:[]},eventsMap:{dataready:"loadstart",ready:"load",startplay:"playstart",loadcomplete:"loaded",stoped:"playend"},index:-1,_create:function(){if(this.options.data&&this.options.data.length>0){this.log={};this.player=null;this.statsRecorder();this.setLogInfo();this.bindEvent();this.bindLogEvent();this.autoPlayNextMv();this.createFlash();this.addVideoList();this.playerEvent()}},createFlash:function(e){e=e||this.options.data[0];if(i.swf.version){var t=Math.random()*1e17;i.swf.create({id:"mvFlash",width:this.options.width,height:this.options.height,url:"http://dispatcher.video.qiyi.com/disp/shareplayer.swf?randomNum="+t,allowscriptaccess:"always",wmode:"opaque",allowfullscreen:true,bgcolor:"#000000",vars:{vid:e.vid,tvid:e.tvid,autoPlay:"1",autoChainPlay:"1",showSearch:"0",showSearchBox:"0",autoHideControl:"1",showFocus:"0",showShare:"0",showLogo:"0",coop:"coop_baidump3",cid:"qc_100001_300089",bd:"1",showDock:0}},this.element.get(0));i(".feed-mv-top").show()}else{var a='<h5 style="color:#fff"> 为了更好的试听体验，请开启Adobe flash。<br/><a href="http://get.adobe.com/cn/flashplayer/" style="display:block;padding: 10px 0 20px;font-size:16px;color:#e13228;text-decoration: underline;">点击即可启用</a></h5>';var o='<div class="common-pop" style="margin-left: -158px; box-shadow:none; background:none; margin-top: -49px; position: absolute;"><div class="common-pop-text">'+a+"</div> </div>";i(".feed-mv-top").append(o);i(".common-pop .cancel, .common-pop .commit, .common-pop .close").click(function(){i(".common-pop").remove()})}this.player=i.swf.getMovie("mvFlash");this._trigger("createflashsuccess")},playerEvent:function(){var e=this,t=false,a=false,o=false,s=null;if(lib.swf.notice){return}lib.swf.notice=function(n){if(i.type(n)==="string"){n=i.parseJSON(n)}if(n.type==="playerStateChange"){clearTimeout(s);var l=n.data.state;if(l==="DataReady"){t=false;a=false;o=false}e._trigger(e.getStandardEventType(l));if(l!=="Stoped"&&o){e._trigger("speedslow")}o=false;if(l==="Seeking"){a=true}else{if(l==="StartPlay"){t=true}else if(l==="Playing"&&t){t=false;e._trigger("play100ms")}else if(l==="Waiting"&&!a&&!t){o=true;s=setTimeout(function(){e._trigger("speedslow");o=false},900)}a=false}}else if(n.type!=="playStateChange"){e._trigger(e.getStandardEventType(n.type))}}},getStandardEventType:function(i){i=i.toLowerCase();return this.eventsMap[i]||i},statsRecorder:function(){var i=0,e=0,t=0,a=0,o=false,s=this;this._on({mvloadstart:function(){i=(new Date).getTime();s.resetRecorder();this.recorder.timestamp=(new Date).getTime();o=true},mvload:function(){if(o){e=(new Date).getTime()}},mvloaded:function(){if(o){a=(new Date).getTime();s.recorder.buftotal=a-i}},mvplay100ms:function(){if(o){t=(new Date).getTime();s.recorder.fromstart=t-i;s.recorder.fromload=t-e}},mvplayend:function(){o=false},mvspeedslow:function(){this.recorder.buffct++}})},resetRecorder:function(){this.recorder={fromload:-1,fromstart:-1,buftotal:-1,buffct:0,timestamp:-1}},addVideoList:function(){var e=[];i.each(this.options.data,function(i,t){e.push({tvid:t.tvid,vid:t.vid})});this._on({mvplayerloadsuccess:function(){this._callPlayer("addVideoList",{index:0,list:e})}})},_callPlayer:function(i,e){if(e===undefined){this.player[i]()}else{e=JSON.stringify(e);this.player[i](e)}},setLogInfo:function(i){i=i||this.options.data[0];this.log={ref:"mv",vid:i.vid,tvid:i.tvid,mvid:i.mvid,song_id:i.songId,song_title:i.title,singer_id:i.authorId,singer_name:i.author,album_id:i.albumId,album_name:i.albumTitle,time:i.time,source:i.source}},bindEvent:function(){var e=this.options,t=e.chainDataElem,a=this;t.find(".mv-cover a").on("click",function(){var e=i(this).parents("li"),o=t.index(e);a.playIndex(o)})},bindLogEvent:function(){if(!(ting&&ting.logger&&ting.logger.log)){return}var e=this.log,t=this;this._on({mvchangemv:function(){e=t.log},mvplaystart:function(){var a={timestamp:t.recorder.timestamp};i.extend(a,e);ting.logger.log("playstart",a)},mvplay100ms:function(){var a={fromload:t.recorder.fromload,fromstart:t.recorder.fromstart,timestamp:t.recorder.timestamp};i.extend(a,e);ting.logger.log("playsong100ms",a)},mvloaded:function(){var a={buftotal:t.recorder.buftotal,timestamp:t.recorder.timestamp};i.extend(a,e);ting.logger.log("loaded",a)},mvplayend:function(){var a={};i.extend(a,t.recorder,e);ting.logger.log("playend",a)},mverror:function(){var a={};i.extend(a,t.recorder,e);ting.logger.log("playerror",e)},mvspeedslow:function(){if(t.recorder.buffct===1){var a={timestamp:t.recorder.timestamp};i.extend(a,e);ting.logger.log("firsthalt",a)}}})},autoPlayNextMv:function(){this._on({mvloadstart:function(){this.playNext()}})},playMv:function(i){this.setLogInfo(i);this._trigger("changemv");this.refreshHtml(i)},setIndex:function(i){var e=this.options,t=e.data;if(i<0||i>=t.length){return}this.animateIndex(i);this.index=i;this.playMv(e.data[i])},animateIndex:function(i){var e=this.options,t=e.chainDataElem.eq(this.index),a=e.chainDataElem.eq(i);t.removeClass("actived");t.find(".play-tip").remove();a.addClass("actived");a.find(".mv-cover").append('<div class="play-tip"><div class="bg"></div><div class="tip-text">正在播放...</div></div>')},playIndex:function(i){var e=this.options,t=e.data[i];this._callPlayer("loadQiyiVideo",{tvid:t.tvid,vid:t.vid});this.animateIndex(i);this.index=i-1},getPlayer:function(){return this.player},playNext:function(){this.setIndex(this.index+1)},refreshHtml:function(e){window._bd_share_config.common.bdText="推荐"+e.author+"的MV《"+e.title+"》 （分享自@千千音乐）";window._bd_share_main.init();i("#mv_title").html("[MV]"+e.author+"-"+e.title);var s="<li>歌曲："+a(e)+"</li>                         <li>歌手："+o(e)+"</li>                         <li>时长："+t(e.time)+"</li>                         <li>发行时间："+n(e)+"</li>";i("#info").html(s)}});var t=function(i){var e=Math.floor(i/60),t=i%60;if(e<10){e="0"+e}if(t<10){t="0"+t}return e+":"+t};var a=function(i){var e='<a href="';if(i.songId){if(i.idhash){e+="/song/s/"+i.idhash}else{e+="/song/"+i.songId}}else{e+="/search?key="+encodeURIComponent(i.title)}e+='" title="'+i.title+'" target="_blank">'+i.title+"</a>";return e};var o=function(e){var t=' <span class="author_list" title="'+e.author+'">',a=e.authorId.toString().split(","),o=e.author.toString().split(","),s=a.length;i.each(a,function(i,a){if((e.relateStatus==0||e.relateStatus==1)&&a>0){t+='<a target="_blank" href="/artist/'+a+'" title="'+o[i]+'">'+o[i]+"</a>"}else{t+='<a target="_blank" href="/search?key='+encodeURIComponent(o[i])+'" title="'+o[i]+'">'+o[i]+"</a>"}if(i<s-1){t+='<span class="artist-line">&nbsp;/&nbsp;</span>'}});t+="</span>";return t};var s=function(i){if(!i.albumTitle){return"未知"}var e='<a target="_blank" ';if(i.relateStatus==0||i.relateStatus==2){e+='href="/album/'+i.albumId+'" title="'+i.albumTitle+'">'}else{e+='href="/search?key='+encodeURIComponent(i.albumTitle)+'" title="'+i.albumTitle+'">'}e+="《"+i.albumTitle+"》</a>";return e};var n=function(i){if(!i.publishTime||i.publishTime==""){return"未知"}return i.publishTime}})(jQuery);(function(i){var e=["ML","HT","US","KR","JP"];i.widget("ui.mvYinyuetai",i.ui.mv,{_create:function(){this.widgetEventPrefix="mv";this.index=0;this._super();this.animateIndex(0)},createFlash:function(e){e=e||this.options.data[0];this.element.empty();if(i.swf.version){i.swf.create({id:"mvFlash",width:this.options.width,height:this.options.height,url:"http://player.yinyuetai.com/video/swf/"+e.tvid+"/a.swf",allowscriptaccess:"always",wmode:"opaque",allowfullscreen:true,bgcolor:"#000000"},this.element.get(0));i(".feed-mv-top").show()}else{var t='<h5 style="color:#fff"> 为了更好的试听体验，请开启Adobe flash。<br/><a href="http://get.adobe.com/cn/flashplayer/" style="display:block;padding: 10px 0 20px;font-size:16px;color:#e13228;text-decoration: underline;">点击即可启用</a></h5>';var a='<div class="common-pop" style="margin-left: -289px; box-shadow:none; background:none; margin-top: -49px; position: absolute;"><div class="common-pop-text">'+t+"</div> </div>";i(".feed-mv-top").append(a);i(".common-pop .cancel, .common-pop .commit, .common-pop .close").click(function(){i(".common-pop").remove()})}this.player=i.swf.getMovie("mvFlash");this._trigger("createflashsuccess")},playerEvent:function(){var i=this,e=false,t=false,a=null;window.playerState=function(o,s){o=o.toLowerCase();s=s.toLowerCase();if(o==="seek"){t=true}else{if(e&&o==="idle"&&s==="buffering"){i._trigger("load")}else if(o==="buffering"&&s==="playing"){clearTimeout(a);if(e){i._trigger("play100ms");e=false}}else if(o==="playing"&&s==="buffering"&&!t&&!e){a=setTimeout(function(){i._trigger("speedslow")},500)}else if(s==="playerError"){i._trigger("error")}t=false}};window.flashPlayerEventFunc=function(t){i._trigger("loadstart");i._trigger("playstart");e=true;if(t.type=="mvplayerReady"){i.player.addStateListener("mvplayerPlayerState","playerState")}};window.yytVideoComplete=function(){i._trigger("playend")}},autoPlayNextMv:function(){this._on({mvplayend:function(){this.playNext()}})},playIndex:function(i){this.setIndex(i)},playMv:function(i){this.createFlash(i);this._super(i)},_custom:function(){var t=this;function a(e){var t=i("#yinyuetai_list_template").html(),a=i("#yinyuetai_list");t=_.template(t,{data:e});a.html(t);a.find("li").hover(function(){i(this).addClass("actived")},function(){i(this).removeClass("actived")});i("#yinyuetai_scroll").tinyscrollbar()}function o(){i.ajax({url:"http://api.yinyuetai.com/api/baidu/vchart-data",data:{area:e[t.options.data[0].area]||"ML",json:true},dataType:"jsonp",success:function(i){a(i.videos)}})}o()}})})(jQuery);(function(i){var e=null;i.widget("ui.mvOwn",i.ui.mv,{_create:function(){this.widgetEventPrefix="mv";this.index=0;this._super();this.animateIndex(0)},createFlash:function(i){var t=this,a=i||t.options.data[0];require(["require/plugin/cyberplayer"],function(i){if(t.player){t.player.remove()}e=t.player=i("cyberPlayer").setup({flashplayer:"../../../static/flash/cyberplayer.flash.swf"/*tpa=http://static2.qianqian.com/static/flash/cyberplayer.flash.swf*/,width:t.options.width,height:t.options.height,stretching:"uniform",file:a.file_link,autostart:true,repeat:false,volume:100,image:_videoImg||"",controls:true,ak:"9eadea16f3424e94b7086e33ce283040"});t._trigger("createflashsuccess");t.player.on("complete",function(){t.playNext()})})},scrollAutoPlay:function(){var t=i(window).height();var a=i(".feed-video-container");var o=parseInt(a.height());s();i(window).scroll(function(){s()});function s(){var s=a.offset();if(s.top+o>=i(window).scrollTop()&&i(window).scrollTop()+t>=s.top+o){var n=e.getState();if(n=="paused"){e.play()}}else{e.pause()}}},playMv:function(e){this.createFlash(e);this._super(e);i(".feed-mv-top").show()}})})(jQuery);require(["core/utils","tmpl/songpage/samealbumlistTmpl","tmpl/songpage/samesonglastTmpl","tmpl/songpage/maybelovelastTmpl","widget/toast/toast","plugin/drag","widget/pop_window/pop_window"],function(i,e,t,a,o){var s="",n={},l=$(".music-body"),r=$(".song-control"),c=$(".collect-num"),d=$(".discuss-num"),g=$(".song-progress-bar-box"),u=$(".shares-num"),p=$(".songn-info"),m=$(".adds"),f=$(".add-to"),h=$(".song-opera"),v=$(".fixed-songinfo"),b=$(".vip-status"),y=$(".song-info-box"),w=$(".song-img"),x=$(".songpage-fixed"),_=$(".song-vip-text"),k=800,C="",T=false,I={},S="playing",P=194,z={collect:"&#xe637;",collected:"&#xe62b;"},D=window.localStorage||{},A=function(){L();playData=r.data("playdata")||{};n={moduleName:playData.moduleName,id:playData.id,mediaType:1,albumId:playData.albumId,resourceTypeExt:playData.pay_type||playData.resourceTypeExt||"",siPresaleFlag:playData.siPresaleFlag||"",songPic:playData.songPic||"",songTitle:playData.songTitle||"",songPublishTime:playData.songPublishTime||""};C=$(".songn-info-box").data("songid");Q();var i=setTimeout(function(){clearTimeout(i);H({type:"init"})},1e3);q();I=r.data("playdata")||{};window.onscroll=function(){var i=parseFloat($(window).scrollTop());if(i>k){w.append(h);x.addClass("songpage-fixeds").prepend(w);v.show();c.hide();u.hide();if($(window).height()<700){$(".ad-banner").eq(0).hide()}}else{x.removeClass("songpage-fixeds");p.prepend(w);y.append(h);v.hide();c.show();u.show();if($(window).height()<700){$(".ad-banner").eq(0).show()}}};E()},E=function(){var i=setTimeout(function(){if(ting&&typeof ting.downPcClient==="function"){ting.downPcClient({$el:".down-pcClient",clientUrlPos:"web_danqu"})}else{E()}clearTimeout(i)},500)},q=function(){K()},L=function(){l.off().on("mouseenter",".time-control .add, .time-control .sub",function(){var i=$(this);i.addClass("hover");var e=i.data("timetype")||"";if(e=="add"){i.html('<i class="iconfont">&#xe632;</i> 0.5')}else{i.html('<i class="iconfont">&#xe631;</i> 0.5')}}).on("click",".discuss",function(){$(window).scrollTop($(".ucomment-new").offset().top);ting.logger.log("click",{page:"song",pos:"comment",sub:"top",songid:ii,methodid:""})}).on("mouseleave",".time-control .add, .time-control .sub",function(){var i=$(this);i.removeClass("hover");var e=i.data("timetype")||"";if(e=="add"){i.html('<i class="iconfont">&#xe632;</i>')}else{i.html('<i class="iconfont">&#xe631;</i>')}}).on("click",".time-control .add, .time-control .sub",function(){G($(this))}).on("click",".downsong",function(){if(!$(this).hasClass("gray")){var i=$(this).data("songid");var e=$(this).hasClass("gray-resource");var t=$(this).data("albumid");F(i,e,t);L()}}).on("click",".buy-vip",function(){var i=new ting.tPay({type:"vip"});i.load()}).on("click",".vip-status",function(){H()}).on("click",".collect",function(){V($(this));ting.logger.log("click_singleFavor",{})}).on("click",".collected",function(){J($(this));ting.logger.log("click_cancelFavor",{})}).on("click",".collect-artist-btn",function(){N($(this))}).on("click",".collected-artist-btn",function(){U($(this))}).on("click",".adds, .add-to-playlist",function(){if($(this).hasClass("gray")){return}B()}).on("click",".report",function(){}).on("mouseover",".adds",function(){var i=$(this);if(i.hasClass("gray")){return}if(i.hasClass("add-song-btn-vip")&&BDUS&&BDUS.vipState!="gold"){return}f.show();if(/mac/i.test(navigator.userAgent)){$(".add-to-pc").attr("href","//download.qianqian.com/channel/2/"+type)}var e=setInterval(function(){if(f.css("display")=="none"){$(".songlist-collect-to").remove();clearInterval(e)}},200)}).on("mouseout",".adds",function(){var i=$(this);if(i.hasClass("add-song-btn-vip")&&BDUS&&BDUS.vipState!="gold"){return}f.hide()}).on("click",".add-to-pc",function(i){var i=i||window.envet;i.preventDefault();if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}F(C);L()}).on("mouseover",".add-to-songlist",function(){M()}).on("click",".add-to-songlist",function(i){var i=i||window.envet;i.preventDefault();if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}if(ting&&ting.passport){ting.passport.checkLogin(function(){})}}).on("mouseover",".add-to-pc, .add-to-playlist",function(){$(".songlist-collect-to").remove()})},F=function(i,e,t){n.id=i||n.id;n.clientUrlPos="web_danqu";n.isGray=e;if(n.isGray){n.albumid=t}ting.media.downloadSong(n.id,"","","",n);var a=setTimeout(function(){clearTimeout(a);L()},1e3)},j=function(i){},M=function(){if(ting&&ting.userInfo){var i=$("<li></li>");function e(){$(".mylist-mysinglesong-box").remove()}require(["widget/ucollect_to/ucollect_to_songdetail"],function(i){createSonglist=i;createSonglist.createSonglists("","",e)})}},N=function(e){var e=e||"";var t=e.data("btntype")||"";var a=e.data("artistid")||"";i.tingApi("baidu.ting.ugcdiy.addFavoriteDiy",{list_id:a,source:2,qa:1}).done(function(){e.html("已收藏");o.show({data:{cls:"succ",text:"收藏成功"}});if(t==="text"){e.html("已收藏")}else{e.html(z.collected)}e.addClass("collected-artist-btn").removeClass("collect-artist-btn")}).fail(function(i){switch(i.error_code){case 22713:i.tipText="已收藏过该艺人";if(t==="text"){e.html("已收藏")}else{e.html(z.collected)}e.addClass("collected-artist-btn").removeClass("collect-artist-btn");break;case 22001:case 22005:i.tipText="收藏失败";break;case 22706:i.tipText="收藏数量过限";break;default:i.tipText="收藏失败"}o.show({data:{cls:"fail",text:i.tipText}})})},U=function(e){var e=e||"";var t=e.data("artistid")||"";var a=e.data("btntype")||"";i.tingApi("baidu.ting.ugcdiy.deleteFavoriteDiy",{list_id:t,source:2,qa:1}).done(function(){o.show({data:{cls:"succ",text:"取消成功"}});if(a==="text"){e.html("收藏Ta")}else{e.html(z.collect)}e.addClass("collect-artist-btn").removeClass("collected-artist-btn")}).fail(function(i){o.show({data:{cls:"fail",text:"取消失败"}})})},R=function(i,e){if(/mac/i.test(navigator.userAgent)){return}var t=i||{};var a="web_danqu";var s="//download.qianqian.com/channel/1/";s=s+a;$loading=$('<i class="openapp-loading t loading"></i>');t.append($loading);$loading.removeClass("loading-show");$loading.addClass("loading-show");ting.openApp.init({appUrl:s});var n={songIds:I.id};openApp.addSong(n,{success:function(){o.show({data:{cls:"succ",text:"添加任务成功！"}});$loading.remove()},error:function(){o.show({data:{cls:"fail",text:"添加任务失败！"}});$loading.remove()},complete:function(){$loading.remove()}})},B=function(){if(I.resourceTypeExt&&(I.resourceTypeExt==3||I.resourceTypeExt==4)){ting.checkSellResourse(I.id,I.albumId,function(i){n.isPay=i;ting.media.addSong(I.id,I);if(i!=1||n.siPresaleFlag==1){}else{o.show({data:{cls:"succ",text:"添加成功"}})}});if(ting&&ting.logger&&ting.logger.plogClick){ting.logger.plogClick("add_song");ting.logger.log("singleAdd",{sid:id,song_title:I.songTitle,isPay:2,source:"song"})}}else{ting.media.addSong(I.id,I);o.show({data:{cls:"succ",text:"添加成功"}});if(ting&&ting.logger&&ting.logger.plogClick){ting.logger.plogClick("add_song");ting.logger.log("singleAdd",{sid:I.id,source:"song"})}}},V=function(e){var t=e.data("songid")||n.id||"";if(e.hasClass("gray")){return}i.tingApi("baidu.ting.favorite.addSongFavorites",{songId:t}).done(function(){o.show({data:{cls:"succ",text:"收藏成功"}});var i=Number($(".collect-num").data("total"))+1;$(".collect-num").html(O(i)).data("total",i);if(e.hasClass("iconfont")){e.html(z.collected).addClass("collected").removeClass("collect")}else{e.addClass("collected").removeClass("collect").find(".iconfont").html(z.collected)}var t={page:ting.logger.getPage(),pos:"collect_song",songcount:1};if(ting&&ting.logger){t.state=1;ting.logger.log("collect",t)}}).fail(function(i){var t="tip-error";if(i&&i.error_code){switch(i.error_code){case 22322:t="tip-warning";i.errTip="歌曲已被保存";if(e.hasClass("iconfont")){e.html(z.collected).addClass("collected").removeClass("collect")}else{e.addClass("collected").removeClass("collect").find(".iconfont").html(z.collected)}break;case 22331:i.errTip="云空间已满，去<a href ='http://yinyueyun.baidu.com/' target = '_blank'>整理云空间</a>吧！";break;case 22232:i.errTip="对不起，千千音乐只能在中国内地提供服务";break;case 22452:ting.passport.checkLogin(function(){var i=setTimeout(function(){clearTimeout(i);V(e)},2e3)});return;break;default:i.errTip="操作失败，请稍候再试";break}o.show({data:{cls:"fail",text:i.errTip}});var a={page:ting.logger.getPage(),pos:"collect_song",songcount:1};if(ting&&ting.logger){a.state=i.errorCode;ting.logger.log("collect",a)}}})},J=function(e){var t=e.data("songid")||"";if(e.hasClass("gray")){return}i.tingApi("baidu.ting.favorite.delSongFavorites",{songId:t}).done(function(){o.show({data:{cls:"succ",text:"取消成功"}});var i=Number($(".collect-num").data("total"))-1;$(".collect-num").html(O(i)).data("total",i);if(e.hasClass("iconfont")){e.html(z.collect).removeClass("collected").addClass("collect")}else{e.removeClass("collected").addClass("collect").find(".iconfont").html(z.collect)}}).fail(function(){o.show({data:{cls:"fail",text:"取消失败"}})})},H=function(i){var i=i||{};var e='<i class="vip-icon"></i>';if(ting&&ting.userInfo){if(ting.userInfo&&ting.userInfo.vip&&ting.userInfo.vip.cloud.service_level==="gold"){if(ting.userInfo.vip_expiry<1&&ting.userInfo.vip_expiry<-7){b.html(e+"立即抢票").attr("href","/hd/ticket/list");_.html("免费看电影，抢热门演唱会票")}else{b.html(e+"立即续费").attr("href","javascript:void(0)").addClass("buy-vip");_.html("您的会员服务有效期不满7天")}}else{b.html(e+"立即开通").attr("href","javascript:void(0)").addClass("buy-vip");_.html("尊贵音乐会员，海量无损音乐")}}else{if(i.type=="init"){b.html(e+"立即开通").attr("href","javascript:void(0)");_.html("尊贵音乐会员，海量无损音乐")}else{ting.passport.checkLogin(function(){var i=setTimeout(function(){clearTimeout(i);if(ting.userInfo&&ting.userInfo.vip&&ting.userInfo.vip.cloud.service_level==="gold"){if(ting.userInfo.vip_expiry<1&&ting.userInfo.vip_expiry<-7){b.html(e+"立即抢票").attr("href","/hd/ticket/list");_.html("免费看电影，抢热门演唱会票")}else{b.html(e+"立即续费").attr("href","javascript:void(0)").addClass("buy-vip");_.html("您的会员服务有效期不满7天")}}else{b.html(e+"立即开通").attr("href","javascript:void(0)").addClass("buy-vip");_.html("尊贵音乐会员，海量无损音乐")}},1e3)})}}if($(".buy-vip").length){$(".vip-status").on("click",function(){ting.logger.log("click",{page:"song",pos:"left",sub:"baidu_vip"})})}else{$(".vip-status").on("click",function(){ting.logger.log("click",{page:"song",pos:"left",sub:"baidu_active"})})}},O=function(i){var i=Number(i)||0;if(i>9999){i=(i/1e4).toFixed(2)+" 万"}return i},Q=function(){i.tingApi("baidu.ting.song.baseInfo",{songid:n.id}).done(function(i){var e=i.content||{};if(e){$(".song-hot").show().append(O(e.total_listen_nums));c.html(O(e.collect_num)).data("total",e.collect_num);d.html(O(e.comment_num));u.html(O(e.share_num)).attr("data-total",e.share_num)}}).fail(function(){});i.tingApi("baidu.ting.favorite.isCollect",{songId:n.id}).done(function(i){var e=i.content||{};if(i.result[n.id]==1){$(".collect-btn").addClass("collected").removeClass("collect");$(".collect-btn .iconfont").html("&#xe62b;")}}).fail(function(){})},G=function(i){var e=i;var t=e.data("timetype")||""},K=function(){var i=$("#lyricCont"),e=i.data("lrclink");var t,i=$("#lyricCont"),a=/\n|\r/,o=/\[[\s\S]*?\]/,s=/\[\d{2,}:\d{2}(?:[\.|:]\d{2,5})?\]/g,n=/\[\d{2,}:\d{2}(?:[\.|:]\d{2,5})?\]/,i=$("#lyricCont"),e=i.data("lrclink"),l=function(i){return n.test(i)},c=function(i){var e=[],t,s=i.replace(o,"").split(a),n,l;for(n=0,l=s.length;n<l;n++){t=$.trim(s[n]);if(t){e.push(t+"<br/>")}}return e},d=function(i){var e=[],o,n,l,r,c,d,g;o=i.split(a);for(r=0,d=o.length;r<d;r++){n=o[r];if(t=n.match(s)){for(c=0,g=t.length;c<g;c++){l=$.trim(n.split(t.join("")).join(""));e.push(l+"<br/>")}}}return e};$.ajax({url:"/data/song/lrc?lrc_link="+e,dataType:"html",success:function(t){var t=JSON.parse(t);if(t.error_code!=22e3){W("");$(".lrc-list, .lrc-top").hide();if(e){$(".lrc-box").append('<img src="//static3.qianqian.com/web/static/images/page/songpage/nolrc.png" class="no-lrc" title="千千音乐"/>')}return false}if(r.hasClass("gray")){var a;if(l(t.content)){a=d(t.content)}else{a=c(t.content)}if(a.length<3&&e){$(".lrc-box").html('<img src="//static3.qianqian.com/web/static/images/page/songpage/nolrc.png" class="no-lrc" title="千千音乐"/>')}$(".mod-song-info .song-lyric").show();if(a.length>12){$("#lyricSwitch").show();i.addClass("lyric-hidden")}i.html(a.join(""));$.ajax({url:"//music.qianqian.com/data/user/location",dataType:"jsonp",success:function(e){if(e.country!="JP"){i.show()}else{$(".mod-song-info .song-lyric").hide()}}});$(".lrc-loading").remove();$(".lrc-list").show()}else{W(t.content)}}})},W=function(i){var e={};var t=false;var a=$(".song-img");var o=$(".song-progress-bar-inner");var s=$(".song-progress-bar");if(r.hasClass("gray")){$(".song-progress-bar").hide();r.hide();$(".play-btn-bg").hide();return false}require(["muplayer/bmPlayer","muplayer/plugin/lrc"],function(l,c){e=new l({baseDir:"/static/js/plugin/muplayer",loggerArgs:{data:{pid:"304",ref:"pc_musicwebsong",from:"web"},api:"web"},engines:[{type:"AudioCore"},{type:"FlashMP4Core"},{type:"FlashMP3Core"}]});if(i){lrcs=window.lrcs=new c({el:"#lyricCont",lrc:i})}var d=setTimeout(function(){clearTimeout(d);if($(".lrc-list li").length<3){$(".lrc-box").html('<img src="//static3.qianqian.com/web/static/images/page/songpage/nolrc.png" class="no-lrc" title="千千音乐"/>')}},50);var u=0;$(".lrc-loading").remove();$(".lrc-list").show();var p=false;$(".playCurrent").hover(function(){p=true},function(){});$(".song-progress-bar .playCurrent").myDrag({parent:".song-progress-bar",direction:"x",cursor:"pointer",dragStart:function(){T=true},dragEnd:function(i,t,a){if(!p){return}p=false;e.pause();var o=setTimeout(function(){clearTimeout(o);var t=Number(i/P)*u;e.play(t*1e3);T=false},200)},dragMove:function(i){o.css("width",i+5+"px")}});if(window.addEventListener){window.addEventListener("storage",m,false)}else if(window.attachEvent){window.attachEvent("onstorage",m)}function m(i){if(!i){i=window.event}if((D&&D.getItem("pauseAll"))==="true"){if(n.id!=(D&&D.getItem("currentSongId"))){e.pause();r.addClass("song-play").removeClass("song-pause")}}}e.on("playing",function(){r.html("&#xe63f;");if(g.is(":hidden")){g.show()}}).on("pause",function(){r.html("&#xe628;")}).on("timeupdate",function(t){u=e.duration();var a=t/u*100/1e3;s.fadeIn(300);var n=Math.round(a)/100*P+"px";if(T!==true){o.css("width",n);$(".playCurrent").css("left",n)}if(i){lrcs.scrollTo(t,true)}});a.off().on("click",".song-play",function(i){D&&D.setItem("currentSongId",n.id);if(t===false){D&&D.setItem("pauseAll","true")}var i=i||window.event;var a=$(this);if(a.hasClass("play-btn-vip")&&BDUS&&BDUS.vipState!="gold"&&song_ispay!=1){ting.showTip({$tar:self,type:"needgoldvip",cancelEvent:"blur",reason:"pay_listen"});return}if(!playData.id){return false}if(n.resourceTypeExt&&(n.resourceTypeExt==3||n.resourceTypeExt==4)){ting.checkSellResourse(playData.id,playData.albumId,function(a){n.isPay=a;if(a==1&&n.siPresaleFlag!=1){e.setCur(playData.id).play();D&&D.setItem("playStatus","playing");$(this).addClass("song-pause").removeClass("song-play");if(ting&&ting.logger&&!i.isTrigger){ting.logger.log("click",{page:"song",pos:"headtag",sub:"play"})}}else{if(t!==true){ting.media.playSong(playData.id,n)}}})}else{e.setCur(playData.id).play();D&&D.setItem("playStatus","playing");$(this).addClass("song-pause").removeClass("song-play");if(ting&&ting.logger&&!i.isTrigger){ting.logger.log("click",{page:"song",pos:"headtag",sub:"play"})}}t=false}).on("click",".song-pause",function(i){t=false;e.pause();$(this).addClass("song-play").removeClass("song-pause");if(ting&&ting.logger){ting.logger.log("click",{page:"song",pos:"headtag",sub:"stop"})}});function f(){var i=setInterval(function(){if(e.getState()==="playing"){D&&D.setItem("playStatus","playing")}else{D&&D.setItem("playStatus","")}},1e3)}var h=setTimeout(function(){if((D&&D.getItem("playStatus"))==="playing"&&"currentSongId"in D&&n.id!=(D&&D.getItem("currentSongId"))){clearTimeout(h);return}f();t=true;$(".song-play").trigger("click");clearTimeout(h)},2e3)})};A();var Y=$(".mui-slider");if(Y){Y.slider({autoPlay:false,hoverShowController:false,speed:250,delay:5e3})}getdifferentmaybelove2=function(){if(!$(".caihover1 .same-album").data("albumid")){var t=$(".maybelove-wrap-2").data("tingid");i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:t,offset:0,limits:10,order:2}).always(function(i){var a=e({item:i.albumlist,loveuid:t});if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover2").html(a);$(".caihover2").css("z-index","10");$(".caihover2").css("opacity","0.7");$(".caihover2").animate({opacity:"1"},800);$(".caihover2").append('<i class="same-album-ico same-album-ico2"></i>')}else{$(".same-album-wrapper").hide()}})}};getdifferentmaybelove7=function(){if(!$(".caihover6 .same-album").data("albumid")){var t=$(".maybelove-wrap-7").data("tingid");i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:t,offset:0,limits:10,order:2}).always(function(i){var a=e({item:i.albumlist,loveuid:t});if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover7").html(a);$(".caihover7").css("z-index","10");$(".caihover7").css("opacity","0.7");$(".caihover7").animate({opacity:"1"},800);$(".caihover7").append('<i class="same-album-ico same-album-ico7"></i>')}else{$(".same-album-wrapper").hide()}})}};getdifferentmaybelove2();$(".maybelove-wrap").hover(function(){var t=$(this).data("num");var a=$(this).data("tingid");i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:a,offset:0,limits:10,order:2}).always(function(i){var o=e({item:i.albumlist,loveuid:a});if(t==1){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover1").html(o);$(".caihover1").css("z-index","10");$(".caihover1").css("opacity","0.7");$(".caihover1").animate({opacity:"1"},800);$(".caihover1").append('<i class="same-album-ico same-album-ico1"></i>')}}if(t==2){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover2").html(o);$(".caihover2").css("z-index","10");$(".caihover2").css("opacity","0.7");$(".caihover2").animate({opacity:"1"},800);$(".caihover2").append('<i class="same-album-ico same-album-ico2"></i>')}}if(t==3){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover3").html(o);$(".caihover3").css("z-index","10");$(".caihover3").css("opacity","0.7");$(".caihover3").animate({opacity:"1"},800);$(".caihover3").append('<i class="same-album-ico same-album-ico3"></i>')}}if(t==4){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover4").html(o);$(".caihover4").css("z-index","10");$(".caihover4").css("opacity","0.7");$(".caihover4").animate({opacity:"1"},800);$(".caihover4").append('<i class="same-album-ico same-album-ico4"></i>')}}if(t==5){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover5").html(o);$(".caihover5").css("z-index","10");$(".caihover5").css("opacity","0.7");$(".caihover5").animate({opacity:"1"},800);$(".caihover5").append('<i class="same-album-ico same-album-ico5"></i>')}}if(t==6){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover6").html(o);$(".caihover6").css("z-index","10");$(".caihover6").css("opacity","0.7");$(".caihover6").animate({opacity:"1"},800);$(".caihover6").append('<i class="same-album-ico same-album-ico6"></i>')}}if(t==7){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover7").html(o);$(".caihover7").css("z-index","10");$(".caihover7").css("opacity","0.7");$(".caihover7").animate({opacity:"1"},800);$(".caihover7").append('<i class="same-album-ico same-album-ico7"></i>')}}if(t==8){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover8").html(o);$(".caihover8").css("z-index","10");$(".caihover8").css("opacity","0.7");$(".caihover8").animate({opacity:"1"},800);$(".caihover8").append('<i class="same-album-ico same-album-ico8"></i>')}}if(t==9){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover9").html(o);$(".caihover9").css("z-index","10");$(".caihover9").css("opacity","0.7");$(".caihover9").animate({opacity:"1"},800);$(".caihover9").append('<i class="same-album-ico same-album-ico9"></i>')}}if(t==10){if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover10").html(o);$(".caihover10").css("z-index","10");$(".caihover10").css("opacity","0.7");$(".caihover10").animate({opacity:"1"},800);$(".caihover10").append('<i class="same-album-ico same-album-ico10"></i>')}}})});$(".maybelove-change").find(".control-left-now").click(function(){var t=$(".mui-slider-scroll-container").find("li").first().find(".maybelove-wrap-1").length;var a=$(".mui-slider-scroll-container").find("li").first().find(".maybelove-wrap-6").length;var o=$(".maybelove-wrap-1").data("tingid");var s=$(".maybelove-wrap-6").data("tingid");if(!a){i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:s,offset:0,limits:10,order:2}).always(function(i){var t=e({item:i.albumlist,loveuid:s});if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover6").html(t);$(".caihover6").css("z-index","10");$(".caihover6").append('<i class="same-album-ico same-album-ico6"></i>')}else{$(".same-album-wrapper li").css("z-index","-1");$(".caihover1").css("z-index","10");$(".caihover1").append('<i class="same-album-ico same-album-ico1"></i>')}getdifferentmaybelove7()})}if(!t){i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:o,offset:0,limits:10,order:2}).always(function(i){var t=e({item:i.albumlist,loveuid:o});if(i.albumlist){
$(".same-album-wrapper li").css("z-index","-1");$(".caihover1").html(t);$(".caihover1").css("z-index","10");$(".caihover1").append('<i class="same-album-ico same-album-ico1"></i>')}else{$(".same-album-wrapper li").css("z-index","-1");$(".caihover6").css("z-index","10");$(".caihover6").append('<i class="same-album-ico same-album-ico6"></i>')}getdifferentmaybelove2()})}});$(".maybelove-change").find(".control-right-now").click(function(){var t=$(".mui-slider-scroll-container").find("li").first().find(".maybelove-wrap-1").length;var a=$(".mui-slider-scroll-container").find("li").first().find(".maybelove-wrap-6").length;var o=$(".maybelove-wrap-1").data("tingid");var s=$(".maybelove-wrap-6").data("tingid");if(!a){i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:s,offset:0,limits:10,order:2}).always(function(i){var t=e({item:i.albumlist,loveuid:s});if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover6").html(t);$(".caihover6").css("z-index","10");$(".caihover6").append('<i class="same-album-ico same-album-ico6"></i>')}else{$(".same-album-wrapper li").css("z-index","-1");$(".caihover1").css("z-index","10");$(".caihover1").append('<i class="same-album-ico same-album-ico1"></i>')}getdifferentmaybelove7()})}if(!t){i.tingApi("baidu.ting.artist.getAlbumList",{tinguid:o,offset:0,limits:10,order:2}).always(function(i){var t=e({item:i.albumlist,loveuid:o});if(i.albumlist){$(".same-album-wrapper li").css("z-index","-1");$(".caihover1").html(t);$(".caihover1").css("z-index","10");$(".caihover1").append('<i class="same-album-ico same-album-ico1"></i>')}else{$(".same-album-wrapper li").css("z-index","-1");$(".caihover6").css("z-index","10");$(".caihover6").append('<i class="same-album-ico same-album-ico6"></i>')}getdifferentmaybelove2()})}});sameSongSixAd=function(){$.ajax({url:"/data/live/list?offset=0&size=10",type:"GET",dataType:"json"}).always(function(i){var e=i||{};if(e.length>0){var o=$(".samesonglist-unic");o.html(t({item:e[0]}));if(e.length>1){var s=$(".maybelove-wrap-5");s.html(a({item:e[1]}))}if(e.length>2){var n=$(".maybelove-wrap-10");n.html(a({item:e[2]}))}}else{}})};if($(".feed-item").length==0&&!taihe0514){sameSongSixAd()}var X=0;if($(".maybelove-wrap-10").length>0){var Z=setInterval(function(){if(ting.userInfo){i.tingApi("baidu.ting.ugcdiy.userList",{source:2,type:0,size:100,offset:0}).always(function(i){if(i&&i.result&&i.result.listinfo){var e=$(".maybelove-wrap-10").data("sameartistlist").sameids.split(",");var t=i.result.listinfo;for(var a=0;a<e.length;a++){for(var o=0;o<t.length;o++){if(e[a]==t[o].artist_id){$("#maybelove-"+e[a]).find(".foot-collect-wrap").html('<a href="javascript:void(0)" class="foot-collected iconfont">&#xe62b;</a>');break}if(e[a]!==t[o].artist_id){$("#maybelove-"+e[a]).find(".foot-collect-wrap").html('<a href="javascript:void(0)" class="foot-collect iconfont">&#xe637;</a>')}}}}})}X++;if(X==3){clearInterval(Z)}},300)}$(".love-foot").on("click",".foot-collect",function(){if(ting.userInfo){var e=$(this).parent().data("artistid");var t=$(this).parent().data("method");var a=$(this);ting.logger.log("click",{starid_click:e,methodid:t,page:"song",pos:"similary_star",sub:"favor"});i.tingApi("baidu.ting.ugcdiy.addFavoriteDiy",{list_id:e,source:2}).done(function(){a.parent().html('<a href="javascript:void(0)" class="foot-collected iconfont">&#xe62b;</a>');o.show({data:{cls:"succ",text:"收藏成功"}})}).fail(function(i){switch(i.error_code){case 22713:i.tipText="已收藏过该艺人";break;case 22001:case 22005:i.tipText="收藏失败";break;case 22706:i.tipText="收藏数量过限";break;default:i.tipText="收藏失败"}o.show({data:{cls:"fail",text:i.tipText}})})}else{ting.passport.checkLogin(function(){})}}).on("click",".foot-collected",function(){if(ting.userInfo){var e=$(this).parent().data("artistid");var t=$(this).parent().data("method");var a=$(this);ting.logger.log("click",{starid_click:e,methodid:t,page:"song",pos:"similary_star",sub:"cancelFavor"});i.tingApi("baidu.ting.ugcdiy.deleteFavoriteDiy",{list_id:e,source:2}).done(function(){a.parent().html('<a href="javascript:void(0)" class="foot-collect iconfont">&#xe637;</a>');o.show({data:{cls:"succ",text:"取消成功"}})}).fail(function(i){o.show({data:{cls:"fail",text:"取消失败"}})})}else{ting.passport.checkLogin(function(){})}});$(".similarsong").find(".ico-play").live("click",function(){var i=$(this).data("songid");ting.media.playSong([i])});$(".aboutsonglist").find(".ico-play").live("click",function(){var i=$(this).data("songlist");ting.media.playSongMenu([i])});$(".similarsong").find(".similarsong-addall").live("click",function(){var i=$(".samesonglist-unic").data("samesonglist").ids.split(",");ting.media.addSong(i)});$(".similarsong-content-btn").find(".mycollect").live("click",function(){var i=$(this).data("songid");ting.media.addSong([i])});var ii=window.location.href.split("/")[4];if(window.location.href.split("/")[3]=="song"){ting.logger.log("exposure",{songid:ii,page:"song",pos:"page",sub:""})}$(".love-img").on("click",function(){var i=$(this).data("loveuid");var e=$(this).data("method");ting.logger.log("click",{songid:ii,starid_click:i,methodid:e,page:"song",pos:"similary_star",sub:"commend"})});$(".foot-name").on("click",function(){var i=$(this).data("loveuid");var e=$(this).data("method");ting.logger.log("click",{songid:ii,starid_click:i,methodid:e,page:"song",pos:"similary_star",sub:"commend"})});$(".same-album").live("click",".ico-play",function(){var i=$(this).data("albumid");var e=$(this).data("loveuid");ting.logger.log("click",{albumid:i,starid_click:e,methodid:"",page:"song",pos:"star_album",sub:"click"})});$(".same-album-name").live("click",function(){var i=$(this).data("albumid");var e=$(this).data("loveuid");ting.logger.log("click",{albumid:i,starid_click:e,methodid:"",page:"song",pos:"star_album",sub:"click"})});$(".aboutsonglist-img-wrap").on("click",function(){var i=$(this).data("songlistid");var e=$(this).data("method");ting.logger.log("click",{songid:ii,songlistid:i,methodid:e,page:"song",pos:"similary_songlist",sub:"click"})});$(".aboutsonglist-footer").on("click","a",function(){var i=$(this).data("songlistid");var e=$(this).data("method");ting.logger.log("click",{songid:ii,songlistid:i,methodid:e,page:"song",pos:"similary_songlist",sub:"click"})});$(".similarsong-wrap").on("click",function(){var i=$(this).data("songid");var e=$(this).data("method");ting.logger.log("click",{songid:ii,click_songid:i,methodid:e,page:"song",pos:"similary_song",sub:"song_name"})});$(".down-pcClient").on("click",function(){ting.logger.log("click",{page:"song",pos:"left",sub:"baidu_client"})});$(".songn-info").on("click",".downsong",function(){ting.logger.log("click",{page:"song",pos:"download",sub:"top",songid:ii,methodid:""})}).on("click",".adds, .add-to-playlist",function(){ting.logger.log("click",{page:"song",pos:"add_song",sub:"top",songid:ii,methodid:""})}).on("click",".add-to-pc",function(i){ting.logger.log("click",{page:"song",pos:"add_client",sub:"top",songid:ii,methodid:""})}).on("click",".add-to-songlist",function(i){ting.logger.log("click",{page:"song",pos:"add_songlist",sub:"top",songid:ii,methodid:""})}).on("click",".shares",function(i){ting.logger.log("click",{page:"song",pos:"share",sub:"top",songid:ii,methodid:""})});$(".songpage-fixed").on("click",".downsong",function(){ting.logger.log("click",{page:"song",pos:"download",sub:"left",songid:ii,methodid:""})}).on("click",".adds, .add-to-playlist",function(){ting.logger.log("click",{page:"song",pos:"add_song",sub:"left",songid:ii,methodid:""})}).on("click",".add-to-pc",function(i){ting.logger.log("click",{page:"song",pos:"add_client",sub:"left",songid:ii,methodid:""})}).on("click",".add-to-songlist",function(i){ting.logger.log("click",{page:"song",pos:"add_songlist",sub:"left",songid:ii,methodid:""})}).on("click",".shares",function(i){ting.logger.log("click",{page:"song",pos:"share",sub:"left",songid:ii,methodid:""})});$(".btn-send").on("click",function(){ting.logger.log("click",{songid:ii,methodid:"",page:"song",pos:"comment",sub:"bottom"})});$(".similarsong-content-btn").on("click",".mycollect",function(){var i=$(this).data("songid");ting.logger.log("click",{songid:i,methodid:"",page:"song",pos:"comment",sub:"similary"})}).on("click",".download",function(){var i=$(this).data("songid");ting.logger.log("click",{songid:i,methodid:"",page:"song",pos:"add_song",sub:"similary"})})});

/** If u are interested in our code and would like to make it robust, just contact us^^ <@音乐前端> **/
/** Generated by M3D. **/